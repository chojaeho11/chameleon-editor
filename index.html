<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ì¹´ë©œë ˆì˜¨í”„ë¦°íŒ… - ì¹œí™˜ê²½ ì „ì‹œÂ·íŒì—…ìŠ¤í† ì–´ ì¸ì‡„ & ë¬´ë£Œ ë””ìì¸ ì—ë””í„°</title>
<meta name="description" content="í—ˆë‹ˆì½¤ë³´ë“œ, íŒ¨ë¸Œë¦­ì¸ì‡„, íŒì—…ìŠ¤í† ì–´ ì „ë¬¸. ë¬´ë£Œ ì—ë””í„°ë¡œ ë“±ì‹ ëŒ€/ë°±ì›” ë””ìì¸ë¶€í„° ì¸ì‡„ê¹Œì§€ í•œë²ˆì— í•´ê²°í•˜ì„¸ìš”.">

<meta property="og:type" content="website">
<meta property="og:site_name" content="ì¹´ë©œë ˆì˜¨í”„ë¦°íŒ…">
<meta property="og:title" content="ì¹´ë©œë ˆì˜¨í”„ë¦°íŒ… - ì¹œí™˜ê²½ ì „ì‹œ ì¸ì‡„ & ë¬´ë£Œ ì—ë””í„°">
<meta property="og:description" content="í—ˆë‹ˆì½¤ë³´ë“œ, íŒ¨ë¸Œë¦­ì¸ì‡„, íŒì—…ìŠ¤í† ì–´ ì „ë¬¸. ë¬´ë£Œ ì—ë””í„°ë¡œ ì‰½ê³  ë¹ ë¥´ê²Œ ë””ìì¸í•˜ì„¸ìš”.">
<meta property="og:url" content="https://www.cafe2626.com/">
<meta property="og:image" content="https://www.cafe2626.com/images/og_main.jpg">
<meta name="keywords" content="ì¹´ë©œë ˆì˜¨í”„ë¦°íŒ…, í—ˆë‹ˆì½¤ë³´ë“œ, ì¢…ì´ë§¤ëŒ€, íŒ¨ë¸Œë¦­ì¸ì‡„, íŒì—…ìŠ¤í† ì–´, ë“±ì‹ ëŒ€ì œì‘, ì‹¤ì‚¬ì¶œë ¥, ì—°í¬ì¥, ì¹œí™˜ê²½ì „ì‹œ, ë°±ì›”ë””ìì¸, ì „ì‹œë¶€ìŠ¤, í¼ë³´ë“œì¸ì‡„">
<link rel="canonical" href="https://www.cafe2626.com/" />

<link rel="alternate" hreflang="ko" href="https://www.cafe2626.com/" />
<link rel="alternate" hreflang="en" href="https://www.cafe2626.com/en.html" />
<link rel="alternate" hreflang="ja" href="https://www.cafe2626.com/jp.html" />
<link rel="alternate" hreflang="x-default" href="https://www.cafe2626.com/" />

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/svg2pdf.js@2.2.4/dist/svg2pdf.umd.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/plugins/svg.js" defer></script>
<script src="https://cdn.jsdelivr.net/gh/kilobtye/potrace@master/potrace.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/opentype.js@latest/dist/opentype.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.12.17/paper-full.min.js" defer></script>
<script src="https://js.tosspayments.com/v1" defer></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/GmarketSans/build/GmarketSans.css">
<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&family=Nanum+Myeongjo:wght@400;700;800&family=Do+Hyeon&family=Jua&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="./style.css">

<meta name="naver-site-verification" content="141eed82fa50fd6f98fa7bfe8dc481a202beb8cf" />

<script>
  (function(){var w=window;if(w.ChannelIO){return w.console.error("ChannelIO script included twice.");}var ch=function(){ch.c(arguments);};ch.q=[];ch.c=function(args){ch.q.push(args);};w.ChannelIO=ch;function l(){if(w.ChannelIOInitialized){return;}w.ChannelIOInitialized=true;var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src="https://cdn.channel.io/plugin/ch-plugin-web.js";var x=document.getElementsByTagName("script")[0];if(x.parentNode){x.parentNode.insertBefore(s,x);}}if(document.readyState==="complete"){l();}else{w.addEventListener("DOMContentLoaded",l);w.addEventListener("load",l);}})();
  ChannelIO('boot', { "pluginKey": "752ba9ff-a447-4e10-9813-715e051995cd" });
</script>

</head>
<body>
<div id="loading"><div class="loading-spin"></div><p style="margin-top:15px; font-weight:600;">ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...</p></div>

<div id="contextMenu">
    <div class="ctx-item" id="ctxUndo"><i class="fa-solid fa-rotate-left"></i> <span data-i18n="ctx_undo">ì‹¤í–‰ ì·¨ì†Œ</span></div>
    <div class="ctx-item" id="ctxRedo"><i class="fa-solid fa-rotate-right"></i> <span data-i18n="ctx_redo">ë‹¤ì‹œ ì‹¤í–‰</span></div>
    <div class="ctx-divider"></div>
    <div class="ctx-item" id="ctxCopy"><i class="fa-regular fa-copy"></i> <span data-i18n="ctx_copy">ë³µì‚¬í•˜ê¸°</span></div>
    <div class="ctx-item" id="ctxPaste"><i class="fa-regular fa-paste"></i> <span data-i18n="ctx_paste">ë¶™ì—¬ë„£ê¸°</span></div>
    <div class="ctx-item" id="ctxDelete" style="color:#ef4444;"><i class="fa-solid fa-trash"></i> <span data-i18n="ctx_delete">ì‚­ì œí•˜ê¸°</span></div>
    <div class="ctx-divider"></div>
    <div class="ctx-item" id="ctxFront"><i class="fa-solid fa-arrow-up-from-bracket"></i> <span data-i18n="ctx_front">ë§¨ ì•ìœ¼ë¡œ</span></div>
    <div class="ctx-item" id="ctxBack"><i class="fa-solid fa-arrow-down-from-bracket"></i> <span data-i18n="ctx_back">ë§¨ ë’¤ë¡œ</span></div>
    <div class="ctx-divider"></div>
    <div class="ctx-item" id="ctxLock"><i class="fa-solid fa-lock"></i> <span data-i18n="ctx_lock">ì ê¸ˆ (Lock)</span></div>
</div>
<div class="topbar">
        <div class="brand" onclick="location.reload()"><i class="fa-solid fa-palette"></i> Chameleon</div>
        
        <div class="template-tabs" style="display:none;">
            <button id="btnMobileTemplateOpen" onclick="document.getElementById('templateOverlay').style.display='flex'; window.filterTpl('photo-bg');">ğŸ¨ <span data-i18n="tab_all">í…œí”Œë¦¿</span></button>
            
            <button class="tpl-tab active" data-tpl="all" 
                style="background: linear-gradient(135deg, #410175 0%, #f00064 100%); color: #fff; font-weight: 800; border: none; box-shadow: 0 3px 10px rgba(255, 105, 180, 0.3); margin-right: 5px;">
                ğŸ¨ ì „ì²´ í…œí”Œë¦¿
            </button>

            <button class="tpl-tab" data-tpl="user_vector">
   ëŒ€í˜•ì¶œë ¥ìš© í…œí”Œë¦¿
</button>

<button class="tpl-tab" data-tpl="user_image">
    A2ì´í•˜ì¶œë ¥ í…œí”Œë¦¿ 
</button>

            <button class="tpl-tab" data-tpl="photo-bg">ì‚¬ì§„</button>

            <button class="tpl-tab" data-tpl="vector" data-i18n="tab_vector">ë°±í„°</button>

            <button class="tpl-tab" data-tpl="graphic" data-i18n="tab_graphic">PNG</button>

            <button class="tpl-tab" data-tpl="transparent-graphic" data-i18n="tab_pattern">íŒ¨í„´</button>

            <button class="tpl-tab" data-tpl="logo" data-i18n="tab_logo">ë¡œê³ </button>
        </div>
        
        <div style="flex:1;"></div>
        
        <button class="btn" onclick="if(confirm('ì²« í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ì‹œê² ìŠµë‹ˆê¹Œ?\n(ì €ì¥í•˜ì§€ ì•Šì€ ì‘ì—…ì€ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤)')) location.reload()" style="margin-right:5px; background:rgb(206, 14, 78); border:1px solid #ddd; color:#ffffff; padding:8px 12px;">
    <i class="fa-solid fa-house"></i> <span style="font-weight:bold;">HOME</span>
</button>

<button class="btn primary" id="btnOrderTop" style="margin-right:5px; background:#ffde26; color:#ffffff; font-weight:bold; box-shadow:0 4px 12px rgb(197, 255, 90);">
    <span data-i18n="btn_add_to_cart">ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°</span>
</button>

<!-- <button class="btn" id="btnViewCart" onclick="document.getElementById('cartPage').style.display='block'; document.body.classList.remove('editor-active');" style="display:none !important; margin-right:5px; background:rgb(137, 57, 241); border:1px solid #fdfff2; color:#ffffff; padding:8px 12px;"> -->
    <!-- <span data-i18n="btn_cart">ğŸ›’ ì¥ë°”êµ¬ë‹ˆ</span> -->
<!-- </button> -->
        
        <button class="btn" id="btnLoginBtn" onclick="document.getElementById('loginModal').style.display='flex'" style="margin-right:5px;" data-i18n="btn_login">ë¡œê·¸ì¸</button>

        <button class="btn" id="btnMyLibrary" onclick="document.getElementById('libraryModal').style.display='flex'; if(window.loadMyDesigns) window.loadMyDesigns();" style="background:white; border:1px solid #ddd; color:#333; padding:8px 12px;">
            <span data-i18n="btn_my_library">ğŸ“‚ ë³´ê´€í•¨</span>
        </button>
        <button class="btn" onclick="window.openMyOrderList()" style="background:white; border:1px solid #ddd; color:#333; margin-right:5px;">
    ğŸšš ì£¼ë¬¸ë°°ì†¡ì¡°íšŒ
</button>
    </div>


<div id="startScreen">
    
    <div class="hero-section">
    <h1 class="hero-title" data-i18n="hero_title">ê´‘ê³ ì‚¬ ê¸°íšì‚¬ íŒŒí‹°í”Œë˜ë„ˆë¼ë©´? <br><span>ì¹´ë©œë ˆì˜¨</span>ê³¼ í•¨ê»˜í•´ìš”.</h1>
    <p class="hero-desc" data-i18n="hero_desc">ëŒ€í•œë¯¼êµ­ 1ë“± ê´‘ê³ ì¸ì‡„ ë„ë§¤ì‡¼í•‘ëª°, ë¡œê³ ë¥¼ ê³µìœ í•˜ê³  í•¨ê»˜ ë§Œë“œëŠ” ë¬´ë£Œì—ë””í„°</p>
</div>
<!-- í€µë©”ë‰´ì™€í¼ -->
<div class="quick-menu-wrapper">
    
    <img src="https://cdn-pro-web-159-230.cdn-nhncommerce.com/dnjsdudrjs13_godomall_com/data/editor/goods/251229/b74dea838f41881ce41d11b7c306629f_152347.png" class="bouncing-char" alt="ìºë¦­í„°">
    
    
    <div class="quick-title-box">
        <span class="qt-badge">í”„ë¦°íŒ…ê³„ì˜ ì½”ìŠ¤íŠ¸ì½”</span>
        <h2 class="qt-text">ì¹´ë©œë ˆì˜¨ì˜ ì œí’ˆ ì¹´í…Œê³ ë¦¬</h2>
    </div>
    <div id="topCategoryTabs" class="category-tabs"></div>

    <div class="quick-menu-track" id="quickMenuContainer"></div>
</div>
<div class="consult-section-wrap">
    <div class="consult-box" style="max-width: 800px; margin: 0 auto; background:none; box-shadow:none; border:none;">
        <h2 style="font-size: 16px; color:#3e166d; margin-bottom:15px;">ì „ì‹œí–‰ì‚¬ì²˜ëŸ¼ ì—¬ëŸ¬í’ˆëª©ì„ ì£¼ë¬¸í•´ì•¼í•˜ëŠ” ê²½ìš° ë˜ëŠ” ë³µì¡í•œ ì£¼ë¬¸ì€ ì¹œì ˆí•œ ë§¤ë‹ˆì €ë“¤ì´ ì•ˆë‚´í•´ ë“œë¦½ë‹ˆë‹¤.</h2>
        
        <div class="manager-simple-list" style="display:flex; flex-direction:row; flex-wrap:wrap; gap:10px; justify-content:center;">
            
            <button class="manager-btn" onclick="window.openQuickReview('ì€ë¯¸', 4.9)" style="flex:1; min-width:200px; display:flex; justify-content:space-between; align-items:center; background:white; border:1px solid #ddd; padding:15px 20px; border-radius:12px; cursor:pointer; font-size:15px; box-shadow:0 2px 5px rgba(0,0,0,0.05); transition:0.2s;">
                <span style="font-weight:bold; color:#333;">ì€ë¯¸ ë§¤ë‹ˆì €</span>
                <span style="color:#f5a623; font-weight:bold;">â˜… 4.9</span>
            </button>

            <button class="manager-btn" onclick="window.openQuickReview('ì„±í¬', 4.8)" style="flex:1; min-width:200px; display:flex; justify-content:space-between; align-items:center; background:white; border:1px solid #ddd; padding:15px 20px; border-radius:12px; cursor:pointer; font-size:15px; box-shadow:0 2px 5px rgba(0,0,0,0.05); transition:0.2s;">
                <span style="font-weight:bold; color:#333;">ì„±í¬ ë§¤ë‹ˆì €</span>
                <span style="color:#f5a623; font-weight:bold;">â˜… 4.8</span>
            </button>

            <button class="manager-btn" onclick="window.openQuickReview('ì§€ìˆ™', 5.0)" style="flex:1; min-width:200px; display:flex; justify-content:space-between; align-items:center; background:white; border:1px solid #ddd; padding:15px 20px; border-radius:12px; cursor:pointer; font-size:15px; box-shadow:0 2px 5px rgba(0,0,0,0.05); transition:0.2s;">
                <span style="font-weight:bold; color:#333;">ì§€ìˆ™ ë§¤ë‹ˆì €</span>
                <span style="color:#f5a623; font-weight:bold;">â˜… 5.0</span>
            </button>
            
             <button class="manager-btn" onclick="window.openQuickReview('ê°€í˜„', 4.7)" style="flex:1; min-width:200px; display:flex; justify-content:space-between; align-items:center; background:white; border:1px solid #ddd; padding:15px 20px; border-radius:12px; cursor:pointer; font-size:15px; box-shadow:0 2px 5px rgba(0,0,0,0.05); transition:0.2s;">
                <span style="font-weight:bold; color:#333;">ë³¸ì‚¬ ìƒë‹´íŒ€</span>
                <span style="color:#f5a623; font-weight:bold;">â˜… 4.7</span>
            </button>
        </div>

        <div class="consult-desc" style="margin-top:20px; font-size:13px; color:#888;">
            ë§¤ë‹ˆì €ë‹˜ë“¤ì— ëŒ€í•œ ê³ ê°ë‹˜ë“¤ì˜ í‰ê°€ë¥¼ ë³´ê³  ìì‹ ê³¼ ê¼­ ë§ëŠ” ë§¤ë‹ˆì €ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”. ë‹´ë‹¹ ë§¤ë‹ˆì €ê°€ ë¶€ì¬ì¤‘ì¸ ê²½ìš° 5ë¶„ ì´ë‚´ ë‹¤ë¥¸ë¶„ì´ ë§¤ì¹­ë©ë‹ˆë‹¤.
        </div>
        
        <button onclick="if(window.ChannelIO) ChannelIO('showMessenger');" class="btn-consult-main" style="width:100%; max-width:400px; border-radius:50px; margin-top:10px;">
            <i class="fa-solid fa-headset"></i> ìƒë‹´ì´ í•„ìš”í•˜ì‹ ê°€ìš”?
        </button>
    </div>
</div>

<div id="quickReviewModal" class="modal-bg" style="z-index: 25000; display:none; align-items:center; justify-content:center;">
    <div class="modal-box" style="width: 400px; text-align:left; padding:0; overflow:hidden; display:flex; flex-direction:column; max-height: 85vh; border-radius: 20px;">
        
        <div style="padding:20px 20px 15px 20px; border-bottom:1px solid #f1f5f9; background:#fff; flex-shrink: 0;">
            <h3 id="qrTargetName" style="margin:0; font-size:18px; color:#1e293b;">ë§¤ë‹ˆì € í›„ê¸°</h3>
            <p style="margin:5px 0 0 0; color:#64748b; font-size:13px;">ê³ ê°ë‹˜ë“¤ì˜ ë”°ëœ»í•œ ì¹­ì°¬ ë©”ì‹œì§€ì…ë‹ˆë‹¤.</p>
        </div>

        <div id="qrReviewList" class="custom-scrollbar" style="flex:1; overflow-y:auto; padding:20px; background:#f8fafc; max-height: 350px;">
            <div style="text-align:center; color:#999; font-size:13px; padding:20px;">í›„ê¸°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        </div>

        <div style="padding:20px; background:#fff; border-top:1px solid #f1f5f9; flex-shrink: 0; box-shadow: 0 -4px 10px rgba(0,0,0,0.02);">
            <div style="font-weight:bold; font-size:14px; margin-bottom:10px; color:#333;">ë‚˜ë„ í•œë§ˆë”” ë‚¨ê¸°ê¸° ğŸ‘‡</div>
            
            <div class="qr-stars" style="font-size:24px; color:#ddd; cursor:pointer; margin-bottom:10px; display:flex; gap:5px;">
                <i class="fa-solid fa-star" onclick="window.setQrScore(1)"></i>
                <i class="fa-solid fa-star" onclick="window.setQrScore(2)"></i>
                <i class="fa-solid fa-star" onclick="window.setQrScore(3)"></i>
                <i class="fa-solid fa-star" onclick="window.setQrScore(4)"></i>
                <i class="fa-solid fa-star" onclick="window.setQrScore(5)"></i>
            </div>
            
            <textarea id="qrComment" class="ai-input-pretty" placeholder="ì¹­ì°¬ê³¼ ê²©ë ¤ì˜ í•œë§ˆë””ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”!" style="height:50px; font-size:13px; margin-bottom:10px; resize:none;"></textarea>
            
            <div style="display:flex; gap:8px;">
                <button id="btnQrSubmit" onclick="window.submitQuickReview()" class="btn-round primary" style="flex:1;">ë“±ë¡</button>
                <button onclick="document.getElementById('quickReviewModal').style.display='none'" class="btn-round" style="flex:1; background:#f1f5f9; color:#333; border:none;">ë‹«ê¸°</button>
            </div>
        </div>
    </div>
</div>

<script type="module">
    import { sb } from './config.js';

    let currentQrManager = '';
    let currentQrScore = 0;

    // 1. ëª¨ë‹¬ ì—´ê¸° + í›„ê¸° ë¶ˆëŸ¬ì˜¤ê¸°
    window.openQuickReview = async function(name) {
        currentQrManager = name;
        currentQrScore = 0;
        document.getElementById('qrTargetName').innerText = name + " ë§¤ë‹ˆì €ë‹˜";
        document.getElementById('qrComment').value = '';
        document.getElementById('quickReviewModal').style.display = 'flex';
        window.setQrScore(0); // ë³„ì  ì´ˆê¸°í™”

        // í›„ê¸° ëª©ë¡ ë¡œë”© ì‹¤í–‰
        await loadManagerReviews(name);
    };

    // 2. [ê¸°ëŠ¥ì¶”ê°€] í›„ê¸° ëª©ë¡ DBì—ì„œ ê°€ì ¸ì˜¤ê¸°
    async function loadManagerReviews(name) {
        const listArea = document.getElementById('qrReviewList');
        listArea.innerHTML = '<div style="text-align:center; padding:20px;"><i class="fa-solid fa-spinner fa-spin"></i> ë¡œë”© ì¤‘...</div>';

        try {
            // í•´ë‹¹ ë§¤ë‹ˆì €ì˜ í›„ê¸°ë§Œ ìµœì‹ ìˆœìœ¼ë¡œ 20ê°œ ê°€ì ¸ì˜¤ê¸°
            const { data, error } = await sb
                .from('manager_reviews')
                .select('*')
                .eq('manager_name', name)
                .order('created_at', { ascending: false })
                .limit(20);

            if (error) throw error;

            listArea.innerHTML = ''; // ì´ˆê¸°í™”

            if (!data || data.length === 0) {
                listArea.innerHTML = '<div style="text-align:center; color:#999; font-size:13px; padding:30px;">ì•„ì§ ë“±ë¡ëœ í›„ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.<br>ì²« ë²ˆì§¸ ì¹­ì°¬ ì£¼ì¸ê³µì´ ë˜ì–´ì£¼ì„¸ìš”! ğŸ˜Š</div>';
                return;
            }

            // ë¦¬ìŠ¤íŠ¸ ê·¸ë¦¬ê¸°
            data.forEach(review => {
                const date = new Date(review.created_at).toLocaleDateString();
                const starStr = 'â˜…'.repeat(review.rating); // ë³„ì  ê°œìˆ˜ë§Œí¼ ë°˜ë³µ
                
                const item = document.createElement('div');
                item.style.cssText = "background:white; padding:12px; border-radius:8px; border:1px solid #eee; margin-bottom:8px;";
                item.innerHTML = `
                    <div style="display:flex; justify-content:space-between; font-size:12px; color:#888; margin-bottom:4px;">
                        <span style="color:#f5a623;">${starStr}</span>
                        <span>${date}</span>
                    </div>
                    <div style="font-size:13px; color:#333; line-height:1.4;">
                        ${review.content || 'ë‚´ìš© ì—†ìŒ'}
                    </div>
                `;
                listArea.appendChild(item);
            });

        } catch (e) {
            console.error(e);
            listArea.innerHTML = '<div style="text-align:center; color:red; font-size:12px;">í›„ê¸°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>';
        }
    }

    // 3. ë³„ì  UI
    window.setQrScore = function(score) {
        currentQrScore = score;
        const stars = document.querySelectorAll('.qr-stars i');
        stars.forEach((star, index) => {
            if (index < score) {
                star.style.color = '#f5a623'; // ë…¸ë€ìƒ‰
            } else {
                star.style.color = '#ddd';    // íšŒìƒ‰
            }
        });
    };

    // 4. ìˆ˜íŒŒë² ì´ìŠ¤ ì „ì†¡ (í›„ê¸° ì‘ì„±)
    window.submitQuickReview = async function() {
        if (currentQrScore === 0) {
            alert("ë³„ì ì„ ì„ íƒí•´ì£¼ì„¸ìš”!");
            return;
        }

        const btn = document.getElementById('btnQrSubmit');
        const content = document.getElementById('qrComment').value;
        
        btn.disabled = true;
        btn.innerText = "ì €ì¥ ì¤‘...";

        try {
            const { error } = await sb
                .from('manager_reviews')
                .insert([{
                    manager_name: currentQrManager,
                    rating: currentQrScore,
                    content: content
                }]);

            if (error) throw error;

            alert("ì†Œì¤‘í•œ í›„ê¸° ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ™‡â€â™‚ï¸");
            
            // ì…ë ¥ì°½ ì´ˆê¸°í™”
            document.getElementById('qrComment').value = '';
            window.setQrScore(0);
            btn.innerText = "ë“±ë¡";
            btn.disabled = false;
            
            // ë°©ê¸ˆ ì“´ ê¸€ ë°”ë¡œ ë³´ì´ê²Œ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            await loadManagerReviews(currentQrManager);

        } catch (e) {
            console.error(e);
            alert("ì €ì¥ ì‹¤íŒ¨: " + e.message);
            btn.disabled = false;
            btn.innerText = "ë“±ë¡";
        }
    };
</script>
<!-- ì˜¤ëŠ˜ì˜í•«ë”œ -->
<div id="hotDealSection" class="hotdeal-wrapper" style="display:none;">
    <div class="hotdeal-header">
        <h2>ğŸ”¥ ì˜¤ëŠ˜ì˜ í•«ë”œ <span class="badge-hot">Time Sale</span></h2>
        <p>ì§€ê¸ˆ ë†“ì¹˜ë©´ í›„íšŒí•˜ëŠ” ì´ˆíŠ¹ê°€ ìƒí’ˆì„ ë§Œë‚˜ë³´ì„¸ìš”. ì¹œêµ¬ì—ì„œ ì„ ë¬¼í•˜ì„¸ìš”. ì§‘ë“¤ì´ ì„ ë¬¼ í•«ë”œìƒí’ˆì€ ìµœëŒ€ 10ê°œê¹Œì§€ ì£¼ë¬¸ê°€ëŠ¥</p>
    </div>
    <div id="hotDealGrid" class="hotdeal-grid">
        </div>
</div>

<div id="bizDealSection" class="hotdeal-wrapper" style="display:none; margin-top:0px; background: #f8fafc; padding: 20px; border-radius: 12px;">
    <div class="hotdeal-header">
        <h2 style="color: #4f46e5;">ğŸ’¼ ì—…ììš© ëŒ€ë°•í• ì¸ <span class="badge-hot" style="background:#4f46e5;">B2B Only</span></h2>
        <p>ì‚¬ì—…ì ê³ ê°ë‹˜ì„ ìœ„í•œ ì „ìš© íŠ¹ê°€! ìµœì†Œì£¼ë¬¸ìˆ˜ëŸ‰ 10~100ê°œ ë¦¬ì…€ëŸ¬ íŒë§¤ìì—ê²Œ ë“œë¦¬ëŠ” ì—…ìí• ì¸</p>
    </div>
    <div id="bizDealGrid" class="hotdeal-grid">
        </div>
</div>


    <!-- ê²Œì‹œíŒ -->
<div class="community-nav-wrapper">
    <div class="comm-grid">
        <a href="#" onclick="goBoard('blog'); return false;" class="comm-btn blog">
            <div class="comm-icon"><i class="fa-solid fa-pen-nib"></i></div>
            <span>ì¹´ë©œë ˆì˜¨<br>ë¸”ë¡œê·¸</span>
        </a>
        <a href="#" onclick="goBoard('review'); return false;" class="comm-btn">
            <div class="comm-icon"><i class="fa-solid fa-star"></i></div>
            <span>ê³ ê°<br>ì œì‘í›„ê¸°</span>
        </a>
        <a href="#" onclick="goBoard('promo'); return false;" class="comm-btn">
            <div class="comm-icon"><i class="fa-solid fa-bullhorn"></i></div>
            <span>ì§€ì—­ê´‘ê³ ì‚¬<br>í™ë³´</span>
        </a>
        <a href="#" onclick="goBoard('trade'); return false;" class="comm-btn">
            <div class="comm-icon"><i class="fa-solid fa-handshake"></i></div>
            <span>ì¤‘ê³ ì¥ë¹„<br>ê±°ë˜</span>
        </a>
        <a href="#" onclick="goBoard('job'); return false;" class="comm-btn">
            <div class="comm-icon"><i class="fa-solid fa-briefcase"></i></div>
            <span>êµ¬ì¸êµ¬ì§</span>
        </a>
        <a href="#" onclick="goBoard('free'); return false;" class="comm-btn">
            <div class="comm-icon"><i class="fa-solid fa-comments"></i></div>
            <span>ì œí’ˆì„¤ëª…ì„œ</span>
        </a>
    </div>
</div>

<div class="gallery-section">
    <style>
    .tier-section-wrap {
        text-align: center;
        margin: 40px auto 60px auto;
        max-width: 1000px;
        padding: 0 20px;
    }
    .tier-title-main {
        font-size: 24px;
        font-weight: 800;
        color: #1e293b;
        margin-bottom: 30px;
    }
    .tier-title-main span {
        color: #6366f1;
    }
    
    .tier-container {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap; /* ëª¨ë°”ì¼ì—ì„œ ìë™ ì¤„ë°”ê¿ˆ */
    }

    .tier-card {
        flex: 1;
        min-width: 280px; /* ì¹´ë“œ ìµœì†Œ ë„ˆë¹„ */
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 16px;
        padding: 30px 20px;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s, box-shadow 0.2s;
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        overflow: hidden;
    }

    .tier-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }

    /* ì¹´ë“œ ìƒë‹¨ ìƒ‰ìƒë  */
    .tier-card::before {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0;
        height: 6px;
    }
    .tier-card.gold::before { background: #eab308; }
    .tier-card.platinum::before { background: #64748b; }
    .tier-card.franchise::before { background: #6366f1; }

    .tier-icon {
        width: 60px; height: 60px;
        border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        font-size: 24px;
        margin-bottom: 15px;
    }
    .tier-card.gold .tier-icon { background: #fef9c3; color: #ca8a04; }
    .tier-card.platinum .tier-icon { background: #f1f5f9; color: #475569; }
    .tier-card.franchise .tier-icon { background: #e0e7ff; color: #4f46e5; }

    .tier-name {
        font-size: 18px;
        font-weight: 800;
        margin-bottom: 5px;
        color: #334155;
    }

    .tier-discount {
        font-size: 32px;
        font-weight: 900;
        margin-bottom: 20px;
    }
    .tier-card.gold .tier-discount { color: #ca8a04; }
    .tier-card.platinum .tier-discount { color: #475569; }
    .tier-card.franchise .tier-discount { color: #4f46e5; }

    .tier-desc {
        font-size: 14px;
        color: #64748b;
        line-height: 1.6;
        border-top: 1px solid #f1f5f9;
        padding-top: 15px;
        width: 100%;
    }
    .tier-desc strong { color: #334155; }
    
    .tier-badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 11px;
        font-weight: bold;
        background: #f1f5f9;
        color: #64748b;
        margin-bottom: 5px;
    }
</style>

<div class="tier-section-wrap">
    <h2 class="tier-title-main">ë©¤ë²„ì‹­ ë“±ê¸‰ë³„ <span>í• ì¸ í˜œíƒ</span> ì•ˆë‚´</h2>
    
    <div class="tier-container">
        
        <div class="tier-card gold">
            <div class="tier-icon"><i class="fa-solid fa-medal"></i></div>
            <div class="tier-name">ê³¨ë“œ (GOLD)</div>
            <div class="tier-discount">5% í• ì¸</div>
            <div class="tier-desc">
                <span class="tier-badge">ì¡°ê±´ 1</span> ëˆ„ì  êµ¬ë§¤ <strong>500ë§Œì›</strong> ì´ìƒ<br>
                <div style="margin: 5px 0; font-size:12px; color:#94a3b8;">OR</div>
                <span class="tier-badge">ì¡°ê±´ 2</span> ë¡œê³  <strong>10ê°œ</strong> ê³µìœ 
            </div>
        </div>

        <div class="tier-card platinum">
            <div class="tier-icon"><i class="fa-solid fa-crown"></i></div>
            <div class="tier-name">í”Œë˜í‹°ë„˜ (PLATINUM)</div>
            <div class="tier-discount">10% í• ì¸</div>
            <div class="tier-desc">
                <span class="tier-badge">ì¡°ê±´ 1</span> ëˆ„ì  êµ¬ë§¤ <strong>1,000ë§Œì›</strong> ì´ìƒ<br>
                <div style="margin: 5px 0; font-size:12px; color:#94a3b8;">OR</div>
                <span class="tier-badge">ì¡°ê±´ 2</span> ë¡œê³  <strong>100ê°œ</strong> ê³µìœ 
            </div>
        </div>

        <div class="tier-card franchise">
            <div class="tier-icon"><i class="fa-solid fa-store"></i></div>
            <div class="tier-name">ê°€ë§¹ì  (PARTNER)</div>
            <div class="tier-discount">15% í• ì¸</div>
            <div class="tier-desc">
                <span class="tier-badge" style="background:#e0e7ff; color:#4338ca;">ê°€ì…ì¡°ê±´</span><br>
                ê°€ë§¹ë¹„ <strong>100ë§Œì›</strong><br>
                <span style="font-size:12px; color:#888;">(ë³„ë„ ë¬¸ì˜ ìš”ë§)</span>
            </div>
        </div>

    </div>
</div>

<div class="partner-recruit-banner" style="max-width:1000px; margin: 30px auto; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border-radius: 16px; padding: 40px; color: white; position: relative; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.15);">
    
    <div style="position: absolute; top: -50px; right: -50px; width: 200px; height: 200px; background: rgba(99, 102, 241, 0.2); border-radius: 50%;"></div>
    
    <div style="position: relative; z-index: 2; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
        <div style="flex: 1; min-width: 300px;">
            <span style="background: #6366f1; color: white; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 800; margin-bottom: 10px; display: inline-block;">PARTNER CENTER</span>
            <h2 style="margin: 0 0 10px 0; font-size: 28px; font-weight: 800;">ìš°ë¦¬ ì§€ì—­ ì¸ì‡„/ê´‘ê³  ì£¼ë¬¸, <br><span style="color: #818cf8;">ì§ì ‘ ì ‘ìˆ˜ë°›ê³  ìˆ˜ìµì„ ì°½ì¶œí•˜ì„¸ìš”!</span></h2>
            <p style="margin: 0; color: #94a3b8; font-size: 15px; line-height: 1.6;">
                ì˜ì—…ì€ ë³¸ì‚¬ê°€ ê°€ë§¹ì ì£¼ë‹˜ì€ ì œì‘ ë‚©í’ˆ, í—ˆë‹ˆì½¤ë³´ë“œëŠ” ì„¤ì¹˜ë¹„ ë¬´ë£Œ, ê¸°íƒ€ ì„¤ì¹˜ëŠ” ê³ ê°ë‹˜ê³¼ í˜‘ì˜<br>
                ê´€ë¦¬ í˜ì´ì§€ì—ì„œ ë§˜ì—ë“œëŠ” ì˜¤ë”ë§Œ ì°œí•´ì„œ ì œì‘ ì§„í–‰í•˜ì‹œë©´ ë©ë‹ˆë‹¤. <br>
                ì¹´ë“œ ìˆ˜ìˆ˜ë£Œ 3.5% ê°€ë§¹ì  ìˆ˜ìˆ˜ë£Œ 6.5% ì œì™¸ í›„, ì „ì•¡ ì•ˆì „í•˜ê²Œ ì •ì‚°í•´ ë“œë¦½ë‹ˆë‹¤. (ê³ ê° ìˆ˜ë ¹ 5ì¼ í›„ ì •ì‚°) <br>
                ë°°ì†¡ ê°€ëŠ¥í•œ ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”. ê·¸ ì§€ì—­ì˜¤ë”ê°€ ë“¤ì–´ì˜¤ë©´ ê´€ë¦¬ìí˜ì´ì§€ ì•Œë¦¼ì´ ìš¸ë¦½ë‹ˆë‹¤. ëµë™!!! <br>
                ë¨¼ì € ê°€ì ¸ê°€ëŠ” ì‚¬ëŒì´ ì„ìì…ë‹ˆë‹¤. ë‹¨! ë¶ˆì¹œì ˆ 1ë‹¬ 2íšŒ ì‹ ê³ ë˜ë©´ ë°•íƒˆë©ë‹ˆë‹¤.
            </p>
        </div>
        
        <div style="text-align: right;">
    <button id="btnPartnerConsole" onclick="openPartnerConsole()" class="btn-round" style="display: none; background: #fff; color: #0f172a; font-weight: 800; padding: 15px 30px; border: none; font-size: 16px; box-shadow: 0 4px 15px rgba(255,255,255,0.2);">
        <i class="fa-solid fa-store"></i> íŒŒíŠ¸ë„ˆìŠ¤ ê´€ë¦¬ì ì ‘ì†
    </button>
    
    <button id="btnPartnerApply" class="btn-round" style="background: transparent; border: 2px solid #6366f1; color: #fff; font-weight: 800; padding: 12px 25px;">
        ê°€ë§¹ì  ì‹ ì²­ ë¬¸ì˜í•˜ê¸°
    </button>
</div>
    </div>
</div>
<!-- ê¸°ì—¬ìì‹œìŠ¤í…œ -->
<div class="contributor-section">
    <div class="contributor-header">
        <div class="contributor-title">
            <i class="fa-solid fa-gem" style="color:#6366f1;"></i> ì¹´ë©œë ˆì˜¨ ê¸°ì—¬ì ì‹œìŠ¤í…œ
            <span class="contributor-badge" id="myTierBadge">Loading...</span>
        </div>
        <div class="contributor-balance-box">
            <span style="font-size:12px; color:#64748b;">ë‚´ ëˆ„ì  ìˆ˜ìµê¸ˆ</span>
            <div class="live-money" id="contributorBalance">0ì›</div>
        </div>
    </div>

    <div class="contributor-desc">
        ë‚´ê°€ ë§Œë“  ë””ìì¸ ì†ŒìŠ¤ë¥¼ ê³µìœ í•˜ê³  í˜„ê¸ˆì„ ì ë¦½ë°›ìœ¼ì„¸ìš”. <br>
        ì¢‹ì€ ì†ŒìŠ¤ë¥¼ ë§ì´ ì˜¬ë¦¬ë©´ í”„ë¡œê¸°ì—¬ì, ë”ë§ì´ ì˜¬ë¦¬ë©´ ë§ˆìŠ¤í„°ê°€ ë˜ê³  ëˆì€ 2ë°° 4ë°°ë¡œ ì˜¬ë¼ê°‘ë‹ˆë‹¤. <br>
        ì¤‘ë³µì´ë¯¸ì§€ë¥¼ ë§ì´ ì˜¬ë¦¬ë©´ ì¦‰ì‹œ ìê²©ì´ ì·¨ì†Œë©ë‹ˆë‹¤.í‚¤ì›Œë“œë¥¼ ì˜ì–´ì™€ ì¼ë³¸ì–´ë¡œ ê°™ì´ ì˜¬ë¦¬ë©´ íŒë§¤ ìˆ˜ìµì´ í›¨ì”¬ ì˜¬ë¼ê°‘ë‹ˆë‹¤. <br>
        ì¶œê¸ˆì‹ ì²­ì€ ìƒë‹¨ ìš°ì¸¡ ë§ˆì´í˜ì´ì§€ì—ì„œ ê°€ëŠ¥í•˜ë©° 1000ì›ë¶€í„° ì¦‰ì‹œì¶œê¸ˆì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. <br>
        <span style="color:#ef4444; font-weight:bold;">íˆ¬ëª…í•œ ê³µê°œ!</span> ì˜¬ë¦¬ëŠ” ì¦‰ì‹œ ì ë¦½ + ì „ì„¸ê³„ ë‹¤ë¥¸ ìœ ì €ê°€ ì‚¬ìš©í• ë•Œë§ˆë‹¤ ë¹µë¹µí•œ íŒë§¤ìˆ˜ìµ
    </div>

    <div class="contributor-grid">
        <button class="contrib-btn" onclick="window.handleContributorUpload('png')">
            <div class="c-icon-box bg-blue"><i class="fa-solid fa-image"></i></div>
            <div class="c-info">
                <span class="c-name">PNG ê°ì²´</span>
                <span class="c-reward">100ì› <span class="tier-bonus"></span></span>
            </div>
        </button>

        <button class="contrib-btn" onclick="window.handleContributorUpload('svg')">
            <div class="c-icon-box bg-purple"><i class="fa-solid fa-bezier-curve"></i></div>
            <div class="c-info">
                <span class="c-name">SVG ê°ì²´</span>
                <span class="c-reward">200ì› <span class="tier-bonus"></span></span>
            </div>
        </button>

        <button class="contrib-btn" onclick="window.handleContributorUpload('logo')">
            <div class="c-icon-box bg-orange"><i class="fa-solid fa-icons"></i></div>
            <div class="c-info">
                <span class="c-name">ë¡œê³  ì—…ë¡œë“œ</span>
                <span class="c-reward">150ì› <span class="tier-bonus"></span></span>
            </div>
        </button>

        <button class="contrib-btn" onclick="window.openTemplateCreator()">
            <div class="c-icon-box bg-green"><i class="fa-solid fa-palette"></i></div>
            <div class="c-info">
                <span class="c-name">í…œí”Œë¦¿ ë§Œë“¤ê¸°</span>
                <span class="c-reward">500ì› <span class="tier-bonus"></span></span>
            </div>
        </button>
    </div>

    <input type="file" id="contributorFileInput" style="display:none;" multiple>
</div>
<!-- ë§ˆì´í˜ì´ì§€ -->
<div id="partnerConsoleModal" class="modal-bg" style="z-index: 20000; display: none; align-items: center; justify-content: center;">
    <div class="modal-box" style="width: 1200px; max-width: 98%; height: 90vh; display: flex; flex-direction: column; padding: 0; background: #f8fafc; overflow: hidden;">
        
        <div style="background: #fff; padding: 15px 25px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <h3 style="margin: 0; color: #1e293b;"><i class="fa-solid fa-store" style="color:#6366f1;"></i> íŒŒíŠ¸ë„ˆìŠ¤ ì½˜ì†”</h3>
                <span class="badge" style="background: #e0e7ff; color: #4338ca;" id="partnerRegionBadge">ì§€ì—­ ë¯¸ì„¤ì •</span>
            </div>
            <button onclick="document.getElementById('partnerConsoleModal').style.display='none'" class="btn-round" style="width: auto; padding: 5px 15px;">ë‹«ê¸°</button>
        </div>

        <div style="display: flex; flex: 1; overflow: hidden;">
            <div style="width: 220px; background: #fff; border-right: 1px solid #e2e8f0; padding: 20px;">
                <div class="nav-menu" style="display: flex; flex-direction: column; gap: 5px;">
                    <button class="nav-item active" onclick="switchPartnerTab('pool')" style="text-align: left; padding: 12px; border: none; background: #eff6ff; color: #6366f1; border-radius: 8px; font-weight: bold; cursor: pointer;">
                        <i class="fa-solid fa-list-ul"></i> ì‹¤ì‹œê°„ ì£¼ë¬¸ì ‘ìˆ˜
                    </button>
                    <button class="nav-item" onclick="switchPartnerTab('my')" style="text-align: left; padding: 12px; border: none; background: transparent; color: #64748b; border-radius: 8px; font-weight: bold; cursor: pointer;">
                        <i class="fa-solid fa-clipboard-check"></i> ë‚˜ì˜ ì§„í–‰ ì£¼ë¬¸
                    </button>
                    <button class="nav-item" onclick="switchPartnerTab('settlement')" style="text-align: left; padding: 12px; border: none; background: transparent; color: #64748b; border-radius: 8px; font-weight: bold; cursor: pointer;">
                        <i class="fa-solid fa-sack-dollar"></i> ì •ì‚° ë° ì¶œê¸ˆ
                    </button>
                </div>
            </div>

            <div style="flex: 1; padding: 25px; overflow-y: auto;">
                <div id="tab-pool" class="partner-tab-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="margin: 0;">ğŸ“ ì‹¤ì‹œê°„ ì˜¤ë” (ì„ ì°©ìˆœ)</h2>
                        <button class="btn-round primary" onclick="loadPartnerOrders('pool')" style="width: auto;"><i class="fa-solid fa-rotate"></i> ìƒˆë¡œê³ ì¹¨</button>
                    </div>
                    <div id="orderPoolList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">ë¡œë”© ì¤‘...</div>
                </div>

                <div id="tab-my" class="partner-tab-content" style="display: none;">
                    <h2 style="margin-bottom: 20px;">ğŸ“‹ ë‚˜ì˜ ì§„í–‰ ì£¼ë¬¸</h2>
                    <div id="myOrderList" style="display: flex; flex-direction: column; gap: 15px;">ë‚´ì—­ ì—†ìŒ</div>
                </div>

                <div id="tab-settlement" class="partner-tab-content" style="display: none;">
    
    <div style="background: #fff; padding: 30px; border-radius: 12px; border: 1px solid #e2e8f0; margin-bottom: 20px; display: flex; align-items: center;">
        
        <div style="margin-right: 50px;">
            <div style="font-size: 14px; color: #64748b; margin-bottom: 5px;">ì¶œê¸ˆ ê°€ëŠ¥ ê¸ˆì•¡ (ìˆ˜ìˆ˜ë£Œ ì œì™¸)</div>
            <div style="font-size: 32px; font-weight: 900; color: #1e293b;" id="partnerAvailableBalance">0ì›</div>
        </div>

        <div>
            <div style="font-size: 14px; color: #64748b; margin-bottom: 5px;">ì¶œê¸ˆ ëŒ€ê¸°ì¤‘ (ì‹ ì²­ì™„ë£Œ)</div>
            <div style="font-size: 32px; font-weight: 900; color: #d97706;" id="partnerPendingBalance">0ì›</div>
        </div>

        <button class="btn-round primary" onclick="requestPartnerWithdrawal()" style="width: auto; padding: 15px 30px; margin-left: auto;">
            ğŸ’¸ ì¶œê¸ˆ ìš”ì²­í•˜ê¸°
        </button>
    </div>
    
    <h4 style="margin-bottom: 15px; color: #334155;">ì •ì‚° ìƒì„¸ ë‚´ì—­</h4>
    <table style="width: 100%; border-collapse: collapse; background: #fff; border-radius: 8px; overflow: hidden; border: 1px solid #e2e8f0;">
        <thead style="background: #f8fafc;">
            <tr>
                <th style="padding: 12px; text-align: left; color: #64748b; font-size: 13px;">ë‚ ì§œ</th>
                <th style="padding: 12px; text-align: right; color: #64748b; font-size: 13px;">ì£¼ë¬¸ê¸ˆì•¡</th>
                <th style="padding: 12px; text-align: right; color: #64748b; font-size: 13px;">ì •ì‚°ê¸ˆì•¡</th>
                <th style="padding: 12px; text-align: center; color: #64748b; font-size: 13px;">ìƒíƒœ</th>
            </tr>
        </thead>
        <tbody id="settlementListBody"></tbody>
    </table>
</div>
            </div>
        </div>
    </div>
</div>

<div id="myOrderModal" class="modal-bg" style="z-index: 16000; display: none; align-items: center; justify-content: center;">
    <div class="modal-box" style="width: 800px; max-width: 95%; max-height: 85vh; display: flex; flex-direction: column; padding: 0; background: #f8fafc; overflow: hidden;">
        
        <div style="background: #fff; padding: 20px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
            <h3 style="margin: 0; color: #1e293b;">ğŸ“¦ ë‚˜ì˜ ì£¼ë¬¸ ë°°ì†¡ ì¡°íšŒ</h3>
            <button onclick="document.getElementById('myOrderModal').style.display='none'" class="btn-round" style="width: auto; padding: 5px 15px;">ë‹«ê¸°</button>
        </div>

        <div style="flex: 1; padding: 20px; overflow-y: auto;">
            <div id="myOrderListUser" style="display: flex; flex-direction: column; gap: 15px;">
                </div>
        </div>
    </div>
</div>
    
    <div class="hero-search-wrap">
    <div style="display:none; opacity:0;">
        <input type="text" name="fake_username_prevention" autocomplete="username">
        <input type="password" name="fake_password_prevention" autocomplete="current-password">
    </div>

    <input type="search" 
           id="startSearchInput" 
           name="q_search_query_final_v2" 
           class="hero-search-input" 
           placeholder="ì–´ë–¤ ë””ìì¸ì„ ì°¾ìœ¼ì„¸ìš”? (ì˜ˆ: ê³ ì–‘ì´, ë°”ë‹¤, í•˜ëŠ˜)" 
           autocomplete="off" 
           readonly 
           onfocus="this.removeAttribute('readonly');"
    >
    <button id="btnStartSearch" class="hero-search-btn">
        <i class="fa-solid fa-magnifying-glass"></i> <span data-i18n="btn_search">ê²€ìƒ‰</span>
    </button>
</div> 
<div class="pagination-wrapper" style="display:flex; justify-content:center; align-items:center; gap:20px; margin:20px 0 40px 0;">
    <button id="btnTplPrev" class="btn-round" onclick="changeTemplatePage(-1)" style="width:100px; justify-content:center;" disabled>
        <i class="fa-solid fa-chevron-left"></i> ì´ì „
    </button>
    
    <span id="tplPageLabel" style="font-weight:bold; color:#334155; font-size:16px;">1 í˜ì´ì§€</span>
    
    <button id="btnTplNext" class="btn-round" onclick="changeTemplatePage(1)" style="width:100px; justify-content:center;">
        ë‹¤ìŒ <i class="fa-solid fa-chevron-right"></i>
    </button>
</div>
<div class="community-nav-wrapper">


<script>
    // ê²Œì‹œíŒ ì´ë™ í•¨ìˆ˜ (êµ­ê°€ ì½”ë“œ ìë™ ê°ì§€)
    // ê²Œì‹œíŒ ì´ë™ í•¨ìˆ˜ (ìƒˆ ì°½ ì—´ê¸° ì ìš©)
function goBoard(category) {
    const urlParams = new URLSearchParams(window.location.search);
    const currentLang = urlParams.get('lang') || 'kr'; 
    
    let country = 'KR';
    if (currentLang.toLowerCase() === 'us' || currentLang.toLowerCase() === 'en') country = 'US';
    if (currentLang.toLowerCase() === 'jp') country = 'JP';

    // window.openì„ ì‚¬ìš©í•˜ì—¬ ìƒˆ íƒ­ì—ì„œ ì—´ê¸° ('_blank')
    window.open(`/board.html?cat=${category}&country=${country}`, '_blank');
}
</script>

    

    <div id="startTemplateGrid" class="template-grid-start"></div>
    
    <div class="review-section">
    <div class="review-header">
    <h2 data-i18n="review_section_title">âœ¨ ê³ ê°ë‹˜ë“¤ì˜ ìƒìƒí•œ í›„ê¸°</h2>
    <p data-i18n="review_section_desc">ì¹´ë©œë ˆì˜¨ìœ¼ë¡œ ì™„ì„±ëœ ë©‹ì§„ ê²°ê³¼ë¬¼ë“¤ì„ í™•ì¸í•´ë³´ì„¸ìš”.</p>
</div>

    <div class="marquee-wrapper">
        <div class="marquee-track">
    <div class="review-card">
        <div class="review-img" style="background-image: url('https://godomall.speedycdn.net/783b37df7f47037a1e127a356662e4f6/goods/1000000048/image/detail/1000000048_detail_065.jpg');"></div>
        <div class="review-content">
            <div class="review-stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
            <p class="review-text" data-i18n="rev_1_text">"í–‰ì‚¬ë•Œë§ˆë‹¤ ì´ìš©í•©ë‹ˆë‹¤. ê¸°íšì‚¬í•œí…ŒëŠ” ì—¬ê¸°ë§Œí•œ ê³³ì´ ì—†ì–´ìš”. í—ˆë‹ˆì½¤ë³´ë“œ ì§„ì§œ ì €ë ´í•˜ê³  ë¹ ë¥´ê³  ì‚¬ì¥ë‹˜ ìµœê³ ì…ë‹ˆë‹¤."</p>
            <div class="review-user">
                <span class="u-name" data-i18n="rev_1_user">ì œì¼ê¸°íš ìš°*ì§„ ë¶€ì¥</span>
                <span class="u-date" data-i18n="rev_1_date">2024.03.15</span>
            </div>
        </div>
    </div>

    <div class="review-card">
        <div class="review-img" style="background-image: url('https://godomall.speedycdn.net/783b37df7f47037a1e127a356662e4f6/goods/1000000049/image/detail/1000000049_detail_023.jpg');"></div>
        <div class="review-content">
            <div class="review-stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
            <p class="review-text" data-i18n="rev_2_text">"í–‰ì‚¬ë•Œ ë­”ê°€ í¬ì¸íŠ¸ë¥¼ ì£¼ê³ ì‹¶ì—ˆëŠ”ë° ë„ˆë¬´ ì¢‹ì•˜ì–´ìš”. ê²½ê¸°ë„ì—ì„œ 1ê°œ ì‹œì¼°ëŠ”ë°ë„ ë¬´ë£Œë°°ì†¡ ë„ˆë¬´ ì¹œì ˆí•œ ê¸°ì‚¬ë‹˜ê¹Œì§€ ìµœê³ ì˜ˆìš”!"</p>
            <div class="review-user">
                <span class="u-name" data-i18n="rev_2_user">ì´ë²¤íŠ¸ê¸°íš ê¹€*ìˆ˜</span>
                <span class="u-date" data-i18n="rev_2_date">2024.03.12</span>
            </div>
        </div>
    </div>

    <div class="review-card">
        <div class="review-img" style="background-image: url('https://godomall.speedycdn.net/783b37df7f47037a1e127a356662e4f6/goods/1000004101/image/main/1000004101_main_028.png');"></div>
        <div class="review-content">
            <div class="review-stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
            <p class="review-text" data-i18n="rev_3_text">"í‚¤ë§ ì œì‘ ì§„ì§œ ë„ˆë¬´ í€„ë¦¬í‹° ë†’ì€ê±° ì•„ë‹Œê°€ìš”? ì†ŒëŸ‰êµ¬ë§¤ëŠ” ì•ˆë˜ì„œ ì•„ì‰½ì§€ë§Œ ì €í¬ê°™ì€ íŒë§¤ìì—ê²ŒëŠ” ìµœê³ ì…ë‹ˆë‹¤."</p>
            <div class="review-user">
                <span class="u-name" data-i18n="rev_3_user">ë„ì¹˜ë§˜**</span>
                <span class="u-date" data-i18n="rev_3_date">2024.03.10</span>
            </div>
        </div>
    </div>

    <div class="review-card">
        <div class="review-img" style="background-image: url('https://godomall.speedycdn.net/783b37df7f47037a1e127a356662e4f6/goods/1000000428/image/detail/1000000428_detail_094.jpg');"></div>
        <div class="review-content">
            <div class="review-stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star-half-stroke"></i></div>
            <p class="review-text" data-i18n="rev_4_text">"ì‰¬í°ì¸ì‡„ í€„ë¦¬í‹° ë¯¸ì³¤ìŠµë‹ˆë‹¤. ì—¬ê¸´ ë‹¬ë¼ìš”. UVë¡œ ë§Œë“œëŠ” ìƒ‰ë¹ ì§€ëŠ” ê·¸ëŸ°ê±° ì•„ë‹ˆê³  ì° ì˜ë¥˜ì¸ì‡„ì— ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ë¼ëŠ”ë° ìƒ‰ê° í€„ë¦¬í‹° ë¹¨ì•„ë„ ë¬¼ ì•ˆë¹ ì§€ê³  ìµœê³ ì…ë‹ˆë‹¤. ê°•ì¶”!!!"</p>
            <div class="review-user">
                <span class="u-name" data-i18n="rev_4_user">í•¸ë“œë©”ì´ë“œìƒµ</span>
                <span class="u-date" data-i18n="rev_4_date">2024.03.08</span>
            </div>
        </div>
    </div>

    <div class="review-card">
        <div class="review-img" style="background-image: url('https://godomall.speedycdn.net/783b37df7f47037a1e127a356662e4f6/goods/1000000113/image/main/1000000113_main_082.jpg');"></div>
        <div class="review-content">
            <div class="review-stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
            <p class="review-text" data-i18n="rev_5_text">"í–‰ì‚¬ë•Œë§ˆë‹¤ ì˜ ì´ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. í—ˆë‹ˆì½¤ë³´ë“œëŠ” ì§„ì§œ êµ­ë‚´ 1ìœ„ë¼ëŠ”ê²Œ í—›ë§ì´ ì•„ë‹Œê³³. ì´ì œ ì—ë””í„°ê¹Œì§€ ìˆì–´ì„œ ë„ˆë¬´ í¸í•˜ê³  ì¢‹ìŠµë‹ˆë‹¤."</p>
            <div class="review-user">
                <span class="u-name" data-i18n="rev_5_user">ì‹ í™”ê¸°íš ìµœë³´ëŒ</span>
                <span class="u-date" data-i18n="rev_5_date">2025.12.15</span>
            </div>
        </div>
    </div>

    <div class="review-card">
        <div class="review-img" style="background-image: url('https://godomall.speedycdn.net/783b37df7f47037a1e127a356662e4f6/goods/1000004088/image/detail/1000004088_detail_057.jpg');"></div>
        <div class="review-content">
            <div class="review-stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
            <p class="review-text" data-i18n="rev_6_text">"ì¢…ì´ë¡œ ë§Œë“  ì›í„°ì¹˜ ë§¤ëŒ€, ì¨ë³´ë‹ˆ ì§„ì§œ íŠ¼íŠ¼í•´ìš” ì¢…ì´ê°™ì§€ ì•Šì•„ìš”. í™©ì„œì—° ë§¤ë‹ˆì €ë¼ëŠ”ë¶„ì´ ì˜¤ì…”ì„œ ì„¤ì¹˜ ì•Œë ¤ì£¼ì…¨ëŠ”ë° ë„ˆë¬´ ì¹œì ˆí•˜ì‹­ë‹ˆë‹¤."</p>
            <div class="review-user">
                <span class="u-name" data-i18n="rev_6_user">ëª°íƒ€ê¸°íš</span>
                <span class="u-date" data-i18n="rev_6_date">2024.03.12</span>
            </div>
        </div>
    </div>

    <div class="review-card">
        <div class="review-img" style="background-image: url('https://godomall.speedycdn.net/783b37df7f47037a1e127a356662e4f6/goods/1000003080/image/detail/1000003080_detail_042.jpg');"></div>
        <div class="review-content">
            <div class="review-stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
            <p class="review-text" data-i18n="rev_7_text">"ë‹¨ìƒì´ ë„ˆë¬´ ì˜›ë‚ ê±°ë¼ ì´ŒìŠ¤ëŸ¬ì›Œì„œ í—ˆë‹ˆì½¤ë³´ë“œë¡œ ê°ì‹¸ì„œ ì‚¬ìš©í–ˆëŠ”ë° í–‰ì‚¬ì˜ í’ˆê²©ì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤."</p>
            <div class="review-user">
                <span class="u-name" data-i18n="rev_7_user">ì—¡ì† ê¹€ì§€ìˆ˜</span>
                <span class="u-date" data-i18n="rev_7_date">2024.03.10</span>
            </div>
        </div>
    </div>

    <div class="review-card">
        <div class="review-img" style="background-image: url('https://godomall.speedycdn.net/783b37df7f47037a1e127a356662e4f6/goods/1000000051/image/detail/1000000051_detail_040.jpg');"></div>
        <div class="review-content">
            <div class="review-stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star-half-stroke"></i></div>
            <p class="review-text" data-i18n="rev_8_text">"í—ˆë‹ˆì½¤ë³´ë“œ ì¢…ì´ê°€ ì´ë ‡ê²Œê¹Œì§€ íŠ¼íŠ¼í•˜ê³  ì˜ˆì˜ë‹¤ë‹ˆ ì¢‹ìŠµë‹ˆë‹¤. ì§„ì§œ ë§˜ì— ë“¤ì–´ìš”. ê¸°íší• ë•Œ ê¼­ ë„£ì–´ì•¼í•˜ëŠ” í¬ì¸íŠ¸"</p>
            <div class="review-user">
                <span class="u-name" data-i18n="rev_8_user">ì—ë“œíŒì‚¬ì¸ê¸°íš</span>
                <span class="u-date" data-i18n="rev_8_date">2024.03.08</span>
            </div>
        </div>
    </div>

    <div class="review-card">
        <div class="review-img" style="background-image: url('https://godomall.speedycdn.net/783b37df7f47037a1e127a356662e4f6/goods/1000003340/image/detail/1000000050_detail_061.jpg');"></div>
        <div class="review-content">
            <div class="review-stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
            <p class="review-text" data-i18n="rev_9_text">"ì¼ë°˜ë°°ë„ˆì™€ëŠ” ëŠë‚Œì´ ë‹¬ë¼ìš”. ê³ ê¸‰ìŠ¤ëŸ½ê³  ë…íŠ¹í•˜ê³  ë²„ë¦¬ê¸°ë„ í¸í•´ì„œ ì¢‹ì•„ìš”."</p>
            <div class="review-user">
                <span class="u-name" data-i18n="rev_9_user">ìµœí¬ìˆ˜</span>
                <span class="u-date" data-i18n="rev_9_date">2025.12.15</span>
            </div>
        </div>
    </div>
</div>
            
            

    </div>
</div>
</div>

    <div class="footer-wrap">
    <div class="footer-inner">
        <div class="foot-left">
            <div class="foot-menu">
                <ul>
                    <li><a href="#" data-i18n="footer_menu_company">íšŒì‚¬ì†Œê°œ</a></li>
                    <li><a href="#" data-i18n="footer_menu_notice">ê³µì§€ì‚¬í•­</a></li>
                    <li><a href="#" data-i18n="footer_menu_terms">ì´ìš©ì•½ê´€</a></li>
                    <li><a href="#"><strong data-i18n="footer_menu_privacy">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</strong></a></li>
                </ul>
            </div>
            <div class="foot-info">
                <dl>
                    <dt data-i18n="footer_company_label">ìƒí˜¸ëª… :</dt>
                    <dd data-i18n="footer_company_value">(ì£¼)ì¹´ë©œë ˆì˜¨í”„ë¦°íŒ…</dd>
                    
                    <dt data-i18n="footer_ceo_label">ëŒ€í‘œ :</dt>
                    <dd data-i18n="footer_ceo_value">ì¡°ì¬í˜¸</dd>
                </dl>
                <dl>
                    <dt data-i18n="footer_addr_label">ì£¼ì†Œ :</dt>
                    <dd data-i18n="footer_addr_value">ê²½ê¸°ë„ í™”ì„±ì‹œ ìš°ì •ì í•œë§ê¸¸ 72-2</dd>
                </dl>
                <dl>
                    <dt data-i18n="footer_biz_num_label">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ :</dt>
                    <dd>470-81-02808</dd>
                    
                    <dt data-i18n="footer_mail_order_label">í†µì‹ íŒë§¤ì—…ì‹ ê³ ë²ˆí˜¸ :</dt>
                    <dd>2025-í™”ì„±ìš°ì •-0033</dd>
                </dl>
                <dl>
                    <dt data-i18n="footer_privacy_manager_label">ê°œì¸ì •ë³´ê´€ë¦¬ì :</dt>
                    <dd>ë³€ì§€ì›…</dd>
                </dl>
                <p class="copyright">Copyright Â© <strong>Chameleon Canvas</strong>. all rights reserved.</p>
            </div>
        </div>

        <div class="cs-center">
            <h3 data-i18n="footer_cs_title">ê³ ê°ì„¼í„° (CS CENTER)</h3>
            <strong>031-366-1984</strong>
            <p>
                <span data-i18n="footer_cs_time">í‰ì¼ 09:00 ~ 18:00</span> <br>
                <span data-i18n="footer_cs_lunch">ì ì‹¬ 12:00 ~ 13:00</span> <br>
                <span data-i18n="footer_cs_closed">* ì£¼ë§ ë° ê³µíœ´ì¼ íœ´ë¬´</span>
            </p>
        </div>
    </div>
</div>
    </div>
</div>



<div id="mainEditor" style="display:none;">
    

    <div id="wallHeightControls">
        <div class="wall-label"><i class="fa-solid fa-ruler-vertical"></i> <span data-i18n="wall_option_title">ê°€ë²½ ë†’ì´</span></div>
        <button class="height-btn active" onclick="window.setWallHeight(2200, this)">220cm</button>
        <button class="height-btn" onclick="window.setWallHeight(2400, this)">240cm</button>
        <button class="height-btn" onclick="window.setWallHeight(3000, this)">300cm</button>
    </div>

    <div class="editor-wrap">
        
        <div class="side" id="toolsPanel" style="text-align: center; padding: 10px 12px;">
            
            <div style="background:#f8fafc; border:1px solid #e2e8f0; border-radius:10px; padding:10px; margin-bottom:10px;">
                <div style="font-size:11px; font-weight:700; color:#64748b; margin-bottom:5px; display:flex; justify-content:space-between;">
                    <span data-i18n="tool_size_change">ğŸ“ ì‚¬ì´ì¦ˆ ë³€ê²½(mm)</span>
                    <span id="limitLabel" style="color:#6366f1;">Max: -</span>
                </div>
                <div style="display:flex; gap:5px; align-items:center;">
                    <input type="number" id="inputUserW" class="ai-input-pretty" placeholder="W" style="margin:0; padding:5px; font-size:12px; text-align:center;">
                    <span style="color:#999;">x</span>
                    <input type="number" id="inputUserH" class="ai-input-pretty" placeholder="H" style="margin:0; padding:5px; font-size:12px; text-align:center;">
                </div>
                <button id="btnApplyUserSize" class="btn-round primary" style="width:100%; margin-top:6px; height:32px; font-size:12px;" data-i18n="btn_save_cost">ë³€ê²½ ì ìš©</button>
            </div>
            
            <div style="display:flex; gap:5px; margin-bottom:10px;">
                <button id="btnRotateCanvas" class="btn-round" style="flex:1; justify-content: center;"><i class="fa-solid fa-rotate"></i> <span data-i18n="btn_rotate">íšŒì „</span></button>
                <button id="btnFitScreen" class="btn-round" style="flex:1; justify-content: center;"><i class="fa-solid fa-compress"></i> <span data-i18n="btn_fit_screen">ë§ì¶¤</span></button>
            </div>

            <div class="section-title" data-i18n="label_ai_tools" style="margin-bottom: 5px; font-size: 12px;">AI TOOLS</div>
            <button class="btn-round ai-red" id="btnAIBox" style="justify-content: center; height: 38px; margin-bottom: 5px;"><i class="fa-solid fa-wand-magic-sparkles"></i> <span data-i18n="btn_ai_gen">AI ìƒì„±</span></button>
            <button class="btn-round" id="btnOpenSellModal" onclick="window.openSellModal()" 
                  style="width: 100%; justify-content: center; height: 38px; background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); border: none; color: white; margin-bottom: 5px; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3);">
                 <i class="fa-solid fa-sack-dollar"></i> <span data-i18n="btn_sell_design">ë””ìì¸ íŒë§¤ ë“±ë¡</span>
            </button>
            <div style="display: flex; gap: 5px; margin-bottom: 5px;">
                <button class="btn-round" id="btnOpenSaveModal" style="flex: 1; justify-content: center; height: 38px;">
                    <span data-i18n="btn_save_design">ğŸ’¾ ë””ìì¸ ì €ì¥</span>
                </button>
                <button class="btn-round" id="btnMyPageSide" style="flex: 1; justify-content: center; height: 38px; background: white; border: 1px solid #ddd; color: #333;">
                    <span>ğŸ“‚ MY page</span>
                </button>
            </div>

            <button class="btn-round" onclick="document.getElementById('logoUploadModal').style.display='flex'" style="width: 100%; justify-content: center; height: 38px; background: #f8fafc; border: 1px solid #6366f1; color: #6366f1; margin-bottom: 15px;">
                <i class="fa-solid fa-cloud-arrow-up"></i> <span data-i18n="btn_logo_share">ë¡œê³  ê³µìœ ë°©</span>
            </button>
            
            <div class="section-title" style="margin-bottom: 5px; font-size: 12px; color: #b6b6b6; letter-spacing: 1px;">ë¬´ë£Œ ë‹¤ìš´ë¡œë“œ</div>
            <div style="display:flex; gap:5px; margin-bottom:15px;">
                <button id="btnPNG" class="btn-round" style="flex:1; justify-content: center; height: 36px;"><i class="fa-regular fa-image"></i> PNG</button>
                <button id="btnPDF" class="btn-round" style="flex:1; justify-content: center; height: 36px;"><i class="fa-solid fa-file-pdf"></i> PDF</button>
            </div>

            <!-- ìš”ê¸°ê°€ ì›ë˜ ë§ˆë²•ì‚¬ ìë¦¬ -->

            <button id="btnAddBasicText" class="btn-round" style="width:100%; margin-bottom:10px; border:1px solid #cbd5e1; background:#fff; color:#333; font-weight:bold; padding:10px; display:flex; align-items:center; justify-content:center;">
                <span style="display:inline-flex; width:20px; height:20px; background:#222; color:#fff; border-radius:4px; align-items:center; justify-content:center; margin-right:6px; font-size:12px;">T</span>
                <span style="font-size: 13px;">í…ìŠ¤íŠ¸ ì¶”ê°€</span>
            </button>

            <button class="btn-round" id="btnFontSelect" style="width:100%; margin-bottom:10px; display:flex; align-items:center; justify-content:center; height: 38px;">
                <span data-i18n="btn_font" style="font-size: 13px;">ğŸ…°ï¸ í°íŠ¸ ì „ì²´ë³´ê¸°</span>
            </button>

            <div id="leftTextSettings" style="background:#f8fafc; border:1px solid #e2e8f0; border-radius:8px; padding:8px; margin-bottom:10px; text-align: left;">
                <div style="display:flex; gap:4px; margin-bottom:8px;">
                    <button class="tool-btn" id="btnAlignLeftText" style="flex:1;"><i class="fa-solid fa-align-left"></i></button>
                    <button class="tool-btn" id="btnAlignCenterText" style="flex:1;"><i class="fa-solid fa-align-center"></i></button>
                    <button class="tool-btn" id="btnAlignRightText" style="flex:1;"><i class="fa-solid fa-align-right"></i></button>
                </div>
                <div style="display:grid; grid-template-columns: 30px 1fr; gap:8px; align-items:center; margin-bottom:6px;">
                    <span style="font-size:11px; color:#666;">í¬ê¸°</span>
                    <input type="range" id="textSize" min="10" max="200" value="50" style="width:100%;">
                </div>
                <div style="display:grid; grid-template-columns: 30px 1fr; gap:8px; align-items:center; margin-bottom:6px;">
                    <span style="font-size:11px; color:#666;">ìê°„</span>
                    <input type="range" id="textCharSpacing" min="-50" max="300" value="0" style="width:100%;">
                </div>
                <div style="display:grid; grid-template-columns: 30px 1fr; gap:8px; align-items:center;">
                    <span style="font-size:11px; color:#666;">í–‰ê°„</span>
                    <input type="range" id="textLineHeight" min="0.5" max="2.5" step="0.1" value="1.2" style="width:100%;">
                </div>
            </div>

            <div class="color-group" style="margin-bottom:5px; font-size: 12px; display: flex; align-items: center; justify-content: space-between;">
                <span data-i18n="label_fill">ğŸ¨ ë©´ìƒ‰ìƒ</span>
                <input id="fillColor" type="color" class="color-picker" value="#000000" style="width: 25px; height: 25px;">
            </div>
            <div class="color-group" style="margin-bottom:10px; font-size: 12px; display: flex; align-items: center; justify-content: space-between;">
                <span data-i18n="label_stroke">ğŸ–Œï¸ ì„ ìƒ‰ìƒ</span>
                <input id="strokeColor" type="color" class="color-picker" value="#000000" style="width: 25px; height: 25px;">
            </div>

            <div class="section-title" data-i18n="label_shapes" style="font-size: 12px; margin-bottom: 5px;">SHAPES</div>
            <div class="shape-panel" style="gap: 4px;">
                <button class="shape-btn" data-shape="rect">â– </button>
                <button class="shape-btn" data-shape="circle">â—</button>
                <button class="shape-btn" data-shape="triangle">â–²</button>
                <button class="shape-btn" data-shape="star">â˜…</button>
                <button class="shape-btn" data-shape="heart">â™¥</button>
                <button class="shape-btn" data-shape="arrow">â¡</button>
                <button class="shape-btn" data-shape="round">â–¢</button>
                <button class="shape-btn" data-shape="line">â”</button>
            </div>
            
            <div class="section-title" data-i18n="label_upload" style="font-size: 12px; margin-top: 10px; margin-bottom: 5px;">UPLOAD</div>
            <label class="upload-box" for="imgUpload" style="height: 60px; padding: 10px;"><span style="font-size:18px;"><i class="fa-solid fa-cloud-arrow-up"></i></span> <span style="font-size: 12px;">Image/PDF</span></label>
            <input id="imgUpload" type="file" accept="image/*,.svg,.pdf" style="display:none;">
        </div>
        
        <div class="stage" id="stage">
           <div id="textWizardToolbar" class="wizard-toolbar floating-island">
    <div class="wiz-brand" style="display:flex; flex-direction:column; justify-content:center; align-items:center; line-height:1.2; padding: 0 5px;">
        <span class="wiz-icon" style="font-size:20px; margin-bottom:2px;">ğŸ§™â€â™‚ï¸</span>
        <span style="font-size:10px; font-weight:bold; color:#8b00a7; letter-spacing:-0.5px;">ë””ìì¸ë§ˆë²•ì‚¬</span>
    </div>
    
    <div class="wiz-scroll-track">
        
        <button onclick="window.toggleBackgroundLock()" style="
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    cursor: pointer;
    margin: 0 2px; /* ì¢Œìš° ì—¬ë°±ì„ ì¤„ì—¬ ê³µê°„ í™•ë³´ */
    padding: 0;
    min-width: 40px; /* ì „ì²´ í­ ì¶•ì†Œ */
">
    <div style="
        width: 30px;
        height: 30px;
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 3px;
        border: 1px solid #eee;
    ">
        <span style="font-size: 16px;">ğŸ”’</span>
    </div>

    <span style="
        font-size: 10px;
        color: #555; /* ë„ˆë¬´ ì§„í•˜ì§€ ì•Šê²Œ ìì—°ìŠ¤ëŸ¬ìš´ ìƒ‰ìƒ */
        font-weight: bold;
        white-space: nowrap;
        letter-spacing: -0.5px; /* ìê°„ì„ ì¢í˜€ì„œ ê°€ë¡œ ê³µê°„ ì¶”ê°€ í™•ë³´ */
    ">
        ë°°ê²½ì§€ì •
    </span>
</button>


        <button class="wiz-btn" onclick="window.applyNewWizard('basic')">
            <div class="icon-box c-indigo"><i class="fa-solid fa-store"></i></div>
            <span>ì „ë‹¨ì§€</span>
        </button>
        <button class="wiz-btn" onclick="window.applyNewWizard('flyer')">
            <div class="icon-box c-red"><i class="fa-solid fa-bullhorn"></i></div>
            <span>í¬ìŠ¤í„°</span>
        </button>
        <button class="wiz-btn" onclick="window.applyNewWizard('card')">
            <div class="icon-box c-green"><i class="fa-solid fa-address-card"></i></div>
            <span>ëª…í•¨</span>
        </button>
        <button class="wiz-btn" onclick="window.applyNewWizard('menu')">
            <div class="icon-box c-orange"><i class="fa-solid fa-utensils"></i></div>
            <span>ë©”ë‰´íŒ</span>
        </button>

        <div class="wiz-divider"></div>

        <button class="wiz-btn" onclick="window.applyNewWizard('banner-h')">
            <div class="icon-box c-blue"><i class="fa-solid fa-scroll"></i></div>
            <span>ê°€ë¡œí˜„ìˆ˜ë§‰</span>
        </button>
        <button class="wiz-btn" onclick="window.applyNewWizard('banner-v')">
            <div class="icon-box c-purple"><i class="fa-solid fa-flag"></i></div>
            <span>ì„¸ë¡œë°°ë„ˆ</span>
        </button>
        <button class="wiz-btn" onclick="window.applyNewWizard('fabric')">
            <div class="icon-box c-pink"><i class="fa-solid fa-shirt"></i></div>
            <span>SALE</span>
        </button>
        <button class="wiz-btn" onclick="window.applyNewWizard('vertical-text')">
            <div class="icon-box c-teal"><i class="fa-solid fa-text-height"></i></div>
            <span>ì¸ìŠ¤íƒ€íŒë„¬</span>
        </button>
        
    </div>
</div>
            <div class="bottom-dock">
                <button id="btnZoomOut" class="zoom-btn"><i class="fa-solid fa-minus"></i></button>
                <button id="btnZoomIn" class="zoom-btn"><i class="fa-solid fa-plus"></i></button>
                <div class="divider"></div>
                <button id="guideToggle" class="zoom-btn" style="width:auto; padding:0 15px; border-radius:20px; font-size:12px;">ê°€ì´ë“œ ì¼œê¸°</button>
                <span class="help-text">Space: ì´ë™ / íœ : ì¤Œ</span>
            </div>
            
            <div class="right-stack" id="rightStackPanel">
                <div class="panel-box" id="panelEdit" style="padding: 10px 12px; text-align: center;">
                    <div class="section-title" style="margin-top:0; margin-bottom: 8px; font-size: 12px;" data-i18n="label_edit_layer">í¸ì§‘ & ë ˆì´ì–´</div>
                    
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px; margin-bottom:5px;">
                        <button class="tool-btn" id="btnUndo" style="font-size: 11px;"><i class="fa-solid fa-rotate-left"></i> <span data-i18n="btn_undo">ì·¨ì†Œ</span></button>
                        <button class="tool-btn" id="btnRedo" style="font-size: 11px;"><i class="fa-solid fa-rotate-right"></i> <span data-i18n="btn_redo">ë‹¤ì‹œ</span></button>
                        <button class="tool-btn" id="btnCopy" style="font-size: 11px;"><i class="fa-regular fa-copy"></i> <span data-i18n="btn_copy">ë³µì‚¬</span></button>
                        <button class="tool-btn" id="btnPaste" style="font-size: 11px;"><i class="fa-regular fa-paste"></i> <span data-i18n="btn_paste">ë¶™ì—¬ë„£ê¸°</span></button>
                    </div>
                    
                    <div style="display:flex; gap:5px; margin-bottom:5px;">
                        <button class="tool-btn" id="btnRotateLeft15" style="flex:1; font-size: 11px;">-15Â°</button>
                        <button class="tool-btn" id="btnRotateRight15" style="flex:1; font-size: 11px;">+15Â°</button>
                    </div>

                    <div style="display:flex; gap:5px; margin-bottom:10px;">
                        <button class="tool-btn" id="btnFront" data-i18n="btn_front" style="flex:1; font-size: 11px;">ë§¨ì•</button>
                        <button class="tool-btn" id="btnBack" data-i18n="btn_back" style="flex:1; font-size: 11px;">ë§¨ë’¤</button>
                        <button class="tool-btn" id="btnDel" style="color:red; flex:1; font-size: 11px;" data-i18n="btn_del">ì‚­ì œ</button>
                    </div>
                    
                    <!-- <div class="section-title" style="margin-bottom:8px; font-size: 12px;" data-i18n="label_align">ì •ë ¬</div>
                    <div class="align-grid" style="gap: 4px; margin-bottom: 8px;">
                        <button class="align-btn" id="btnAlignLeft"><i class="fa-solid fa-align-left"></i></button>
                        <button class="align-btn" id="btnAlignRight"><i class="fa-solid fa-align-right"></i></button>
                        <button class="align-btn" id="btnAlignTop"><i class="fa-solid fa-align-left" style="transform:rotate(90deg)"></i></button>
                        <button class="align-btn" id="btnAlignMiddle"><i class="fa-solid fa-arrows-up-down-left-right"></i></button>
                        <button class="align-btn" id="btnAlignBottom"><i class="fa-solid fa-align-right" style="transform:rotate(90deg)"></i></button>
                    </div> -->
                    <button class="btn-round" id="btnCenterObject" onclick="window.alignObject('center')" style="margin-top:5px; height: 32px; font-size: 11px;">
        ğŸ¯ <span data-i18n="btn_center_all">ì •ì¤‘ì•™</span>
    </button>
    
    <button class="btn-round" onclick="window.setAsBackground()" style="margin-top:5px; height: 32px; font-size: 11px;">
        ğŸ–¼ <span data-i18n="btn_full_bg">ë°°ê²½ ì±„ìš°ê¸°</span>
    </button>

    <button id="btnLockWizard" class="btn-round" style="margin-top:5px; height: 32px; font-size: 11px;">
        <i class="fa-solid fa-lock"></i> <span>ì„ íƒ-ì ê·¸ê¸°</span>
    </button>
                </div>

                <div class="panel-box" id="panelText" style="display:none;"></div>
                
                <div class="panel-box" style="padding: 10px 12px; text-align: center;">
                    <div class="section-title" style="margin-top:0; color:#333; font-size: 12px; margin-bottom: 5px;">ì˜¤ë ¤ë‚´ê¸° & AI</div>
                    <div class="tool-box-group" style="padding: 0;">
                        <button id="btn-create-outline" class="btn-round" style="width:100%; margin-bottom:5px; justify-content:center; height: 36px; font-size: 11px;">
                            âœ‚ï¸ <span data-i18n="btn_make_cutline">ì˜¤ë ¤ë‚´ê¸° ì¹¼ì„ </span>
                        </button>
                        <div style="display:flex; gap:5px; margin-bottom: 10px;">
                            <button id="btn-make-keyring" class="btn-round" style="flex:1; justify-content: center; height:32px; font-size:11px;">í‚¤ë§ ê³ ë¦¬</button>
                            <button id="btn-make-standee" class="btn-round" style="flex:1; justify-content: center; height:32px; font-size:11px;">ë“±ì‹ ëŒ€</button>
                        </div>
                    </div>

                    <div style="margin-top: 10px; display: flex; flex-direction: column; gap: 10px;">
    
    <button id="btnUpscale" class="btn-round" style="
        width: 100%; 
        height: 45px; 
        border: none; 
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
        color: white; 
        font-weight: 800; 
        font-size: 13px; 
        box-shadow: 0 4px 10px rgba(118, 75, 162, 0.4);
        display: flex; align-items: center; justify-content: center;">
        âœ¨ A3ì´ìƒ ì‚¬ì§„ í•´ìƒë„UP
    </button>

    <button id="btnCutout" class="btn-round" style="
        width: 100%; 
        height: 45px; 
        border: none; 
        background: linear-gradient(135deg, #ff9a9e 0%, #ff6a88 100%); 
        color: white; 
        font-weight: 800; 
        font-size: 13px; 
        box-shadow: 0 4px 10px rgba(255, 106, 136, 0.4);
        display: flex; align-items: center; justify-content: center;">
        âœ‚ï¸ ë°°ê²½ ì œê±°í•˜ê¸°
    </button>

    <button class="tool-btn" id="btnOutline" style="height: 36px; font-size: 11px; background:white; border:1px solid #ddd; color:#333;">
        ğŸ”² <span data-i18n="btn_text_outline">ì™¸ê³½ì„ </span>
    </button>

</div>
                    
                    <div class="section-title" style="margin-top:10px; font-size: 11px; text-align: left;">ì„  ë‘ê»˜</div>
                    <input type="range" id="globalStroke" min="0" max="30" value="0" style="width:100%;">
                    <div style="display:flex; gap:5px; margin-top:5px;">
                        <button class="tool-btn" id="btnStrokeMiter" style="flex:1; height: 30px; font-size: 11px;"><i class="fa-solid fa-square"></i> ê°ì§€ê²Œ</button>
                        <button class="tool-btn" id="btnStrokeRound" style="flex:1; height: 30px; font-size: 11px;"><i class="fa-solid fa-circle"></i> ë‘¥ê¸€ê²Œ</button>
                    </div>

                    <div class="section-title" style="margin-top: 10px; font-size: 11px; text-align: left;">íˆ¬ëª…ë„</div>
                    <input type="range" id="opacitySlider" min="0" max="100" value="100" style="width:100%;">
                </div>
            </div>
            <canvas id="designCanvas"></canvas>
        </div>
    </div>
</div>
<div id="mobileTextEditor" style="display:none;">
    <div class="m-text-header">
        <span style="color:#6366f1; font-weight:bold;"><i class="fa-solid fa-pen"></i> í…ìŠ¤íŠ¸ ìˆ˜ì •</span>
        
        <div style="display:flex; gap:5px;">
            <button onclick="window.deleteMobileObject()" style="background:#ef4444; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; font-size:13px;">
                <i class="fa-solid fa-trash"></i> ì‚­ì œ
            </button>
            
            <button onclick="window.closeMobileTextEditor()" style="background:#6366f1; color:white; border:none; padding:6px 12px; border-radius:6px; font-weight:bold; font-size:13px;">
                ì™„ë£Œ
            </button>
        </div>
    </div>
    <textarea id="mobileTextInput" placeholder="ì—¬ê¸°ì— ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
</div>
<div id="templateActionModal" class="modal-bg" style="z-index: 20000;">
    <div class="modal-box" style="width: 500px; max-width: 90%;">
        <h3 style="margin-top:0; font-size: 20px;">ğŸ¨ í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸°</h3>
        <p style="color:#666; font-size:15px; margin-bottom:30px; line-height: 1.5;">
            í˜„ì¬ ì‘ì—… ì¤‘ì¸ ë””ìì¸ì´ ìˆìŠµë‹ˆë‹¤.<br>
            ì„ íƒí•œ í…œí”Œë¦¿ì„ ì–´ë–»ê²Œ ì ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
        </p>
        
        <div style="display:flex; gap:15px;">
            <button id="btnActionAdd" class="btn-round" style="flex:1; height:120px; flex-direction:column; justify-content:center; gap:10px; background:#f1f5f9; border:1px solid #cbd5e1; color:#334155;">
                <i class="fa-solid fa-layer-group" style="font-size:32px; color:#6366f1;"></i>
                <span style="font-size:16px; font-weight:bold;">í˜„ì¬ ì‘ì—…ì— ì¶”ê°€</span>
                <span style="font-size:12px; font-weight:normal; opacity:0.8;">ê¸°ì¡´ ë””ìì¸ ìœ„ì— ê²¹ì¹˜ê¸°</span>
            </button>

            <button id="btnActionReplace" class="btn-round ai-red" style="flex:1; height:120px; flex-direction:column; justify-content:center; gap:10px; border:none;">
                <i class="fa-solid fa-file-circle-check" style="font-size:32px;"></i>
                <span style="font-size:16px; font-weight:bold;">ìƒˆ ì‘ì—… ì‹œì‘</span>
                <span style="font-size:12px; font-weight:normal; opacity:0.8;">ê¸°ì¡´ ë‚´ìš© ì§€ìš°ê³  ë®ì–´ì“°ê¸°</span>
            </button>
        </div>

        <button onclick="document.getElementById('templateActionModal').style.display='none'" class="btn-round" style="margin-top:20px; border:none; color:#999;">
            ì·¨ì†Œí•˜ê³  ëŒì•„ê°€ê¸°
        </button>
    </div>
</div>
<div id="sizeSelectModal" class="modal-bg" style="z-index: 15000;">
    <div class="modal-box" style="width: 800px; max-width: 95%;">
        <h3>ğŸ“ ì–´ë–¤ í¬ê¸°ë¡œ ë§Œë“œì‹œê² ìŠµë‹ˆê¹Œ?</h3>
        <p style="margin-bottom:20px; color:#666;">ì„ íƒí•œ ì œí’ˆ í¬ê¸°ì— ë§ì¶° í…œí”Œë¦¿ì´ ìë™ìœ¼ë¡œ ì¡°ì ˆë©ë‹ˆë‹¤.</p>
        
        <div id="productSelectGrid" class="quick-menu-track" style="grid-template-columns: repeat(4, 1fr);"></div>
        
        <button onclick="document.getElementById('sizeSelectModal').style.display='none'" class="btn-round" style="margin-top:20px;">ì·¨ì†Œ</button>
    </div>
</div>
<div id="aiDrawer" class="ai-drawer"><h3>âœ¨ AI ì´ë¯¸ì§€ ìƒì„±</h3><p class="label">ì„¤ëª… (Prompt)</p><textarea id="aiPrompt" class="ai-input-pretty" placeholder="ì˜ˆ: ìˆ²ì†ì— ì•‰ì•„ìˆëŠ” ê·€ì—¬ìš´ ê°ˆìƒ‰ í† ë¼" style="height:100px;"></textarea><button id="aiGenerateBtn" class="btn-round primary" style="margin-top:10px;">ìƒì„±í•˜ê¸°</button><div id="aiResultArea" style="min-height:200px; background:#f9f9f9; margin-top:20px; display:flex; justify-content:center; align-items:center;"><span style="color:#ccc;">ê²°ê³¼ ëŒ€ê¸° ì¤‘</span></div><button id="aiUseBtn" class="btn-round" style="display:none; margin-top:10px;">ìº”ë²„ìŠ¤ì— ë„£ê¸°</button><button onclick="document.getElementById('aiDrawer').classList.remove('open')" class="btn-round" style="margin-top:10px;">ë‹«ê¸°</button></div>
<div id="templateOverlay">
    <div class="tpl-modal-box">
        <div class="tpl-sidebar">
            <button class="tpl-cate-btn" onclick="window.filterTpl('all', this)">
                <span style="font-weight:800; color:#6366f1;">ğŸ¨ ì „ì²´ ë””ìì¸</span>
            </button>
            
            <button class="tpl-cate-btn" onclick="window.filterTpl('user_vector', this)">
    <span>ëŒ€í˜•ì¶œë ¥ìš© í…œí”Œë¦¿</span>
</button>
<button class="tpl-cate-btn" onclick="window.filterTpl('user_image', this)">
    <span>A2ì´í•˜ì¶œë ¥ í…œí”Œë¦¿</span>
</button>

            <button class="tpl-cate-btn active" onclick="window.filterTpl('photo-bg', this)">
                <span>ì´ë¯¸ì§€</span>
            </button>

            <button class="tpl-cate-btn" onclick="window.filterTpl('vector', this)">
                <span>ë°±í„°</span>
            </button>

            <button class="tpl-cate-btn" onclick="window.filterTpl('graphic', this)">
                <span>PNG</span>
            </button>

            <button class="tpl-cate-btn" onclick="window.filterTpl('transparent-graphic', this)">
                <span>íŒ¨í„´</span>
            </button>

            <button class="tpl-cate-btn" onclick="window.filterTpl('logo', this)">
                <span>ë¡œê³ </span>
            </button>
        </div>
        <div class="tpl-content">
            <div style="padding: 20px 30px; border-bottom: 1px solid #f1f5f9; display: flex; align-items: center; justify-content: space-between;">
                <h2 style="margin:0;">ê²€ìƒ‰</h2>
                <input type="text" id="tplSearchInput" class="ai-input-pretty" style="width:300px; margin-bottom:0;" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥...">
                <button onclick="document.getElementById('templateOverlay').style.display='none'" style="border:none; background:none; cursor:pointer;">
                    <i class="fa-solid fa-xmark fa-2x"></i>
                </button>
            </div>
            <div id="tplGrid" class="tpl-grid"></div>
            <div style="padding:15px; text-align:right; border-top:1px solid #eee;">
                <button id="btnUseTpl" class="btn primary" onclick="window.useSelectedTemplate()">ì„ íƒí•œ í…œí”Œë¦¿ ì ìš©</button>
            </div> 
        </div>
    </div>
</div>
<div id="libraryModal" class="modal-bg" style="z-index: 11000;"><div class="modal-box" style="width: 800px; max-width: 90%; height: 80%; display: flex; flex-direction: column;"><div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;"><h3 style="margin:0;">ğŸ“‚ ë‚´ ë””ìì¸ ë³´ê´€í•¨</h3><button onclick="document.getElementById('libraryModal').style.display='none'" style="border:none; background:none; cursor:pointer; font-size:20px;">âœ•</button></div><div id="myDesignGrid" style="flex:1; overflow-y:auto; display:grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap:20px; padding:10px;"></div></div></div>
<div id="saveDesignModal" class="modal-bg" style="z-index: 11001;"><div class="modal-box"><h3>ğŸ’¾ ë””ìì¸ ì €ì¥í•˜ê¸°</h3><p style="font-size:13px; color:#666;">ë³´ê´€í•¨ì— ì €ì¥í•˜ì—¬ ë‚˜ì¤‘ì— ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><input id="saveDesignTitle" class="ai-input-pretty" placeholder="ë””ìì¸ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì—¬ë¦„ ì´ë²¤íŠ¸ ë°°ë„ˆ)"><div style="display:flex; gap:10px; margin-top:20px;"><button id="btnConfirmSave" class="btn-round primary">ì €ì¥í•˜ê¸°</button><button onclick="document.getElementById('saveDesignModal').style.display='none'" class="btn-round">ì·¨ì†Œ</button></div></div></div>
<div id="loadModeModal" class="modal-bg" style="z-index: 10001;"><div class="modal-box" style="width: 450px;"><h3>ğŸ¨ í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸°</h3><p style="color:#666; font-size:14px; margin-bottom:20px;">í˜„ì¬ ìº”ë²„ìŠ¤ ë‚´ìš©ì´ ìˆìŠµë‹ˆë‹¤.</p><div style="display:flex; gap:10px;"><button id="btnLoadReplace" class="btn-round ai-red" style="height:100px;">ìƒˆ ì‘ì—…ìœ¼ë¡œ<br>(ê¸°ì¡´ ì‚­ì œ)</button><button id="btnLoadAdd" class="btn-round primary" style="height:100px;">í˜„ì¬ ì‘ì—…ì—<br>ì¶”ê°€í•˜ê¸°</button></div><button onclick="document.getElementById('loadModeModal').style.display='none'" class="btn-round" style="margin-top:15px;">ì·¨ì†Œ</button></div></div>
<div id="loginModal" class="modal-bg" style="z-index: 10002;">
    <div class="modal-box" style="width: 400px;">
        <h3 id="authTitle" style="margin-top:0;" data-i18n="modal_login_title">ë¡œê·¸ì¸</h3>
        <div style="display:flex; flex-direction:column; gap:10px; margin-bottom:15px;">
            <input id="loginId" class="ai-input-pretty" placeholder="ì´ë©”ì¼ ì£¼ì†Œ" data-i18n-placeholder="placeholder_email" style="margin:0;">
            <input id="loginPw" class="ai-input-pretty" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸" data-i18n-placeholder="placeholder_pw" style="margin:0;">
            <input id="loginPwConfirm" class="ai-input-pretty" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" data-i18n-placeholder="placeholder_pw_confirm" style="margin:0; display:none;">
        </div>
        <button class="btn-round primary" id="btnAuthAction" style="width:100%; justify-content:center; height:45px; font-size:15px;" data-i18n="btn_login_submit">ë¡œê·¸ì¸</button>
        <div style="margin-top:15px; font-size:13px; color:#666;">
            <span id="authSwitchText" data-i18n="msg_no_account">ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?</span>
            <span id="btnSwitchAuthMode" style="color:var(--primary); font-weight:bold; cursor:pointer; margin-left:5px; text-decoration:underline;" data-i18n="btn_signup">íšŒì›ê°€ì…</span>
        </div>
        <hr style="margin:20px 0; border:0; border-top:1px solid #eee;">
        <div style="display:flex; flex-direction:column; gap:8px;">
            <button id="btnGoogleLogin" class="btn-round" style="border-color:#ddd; justify-content:center;">
                <i class="fa-brands fa-google" style="color:#DB4437; margin-right:8px;"></i> <span data-i18n="btn_google_login">Googleë¡œ ì‹œì‘í•˜ê¸°</span>
            </button>
            <button id="btnKakaoLogin" class="btn-round" style="border-color:#FEE500; background:#FEE500; color:#3C1E1E; justify-content:center;">
                <i class="fa-solid fa-comment" style="margin-right:8px;"></i> ì¹´ì¹´ì˜¤ë¡œ ì‹œì‘í•˜ê¸°
            </button>
        </div>
        <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #f1f5f9; text-align: center;">
    <p style="font-size: 13px; color: #6366f1; font-weight: bold; margin-bottom: 15px; line-height: 1.5; word-break: keep-all;">
        <i class="fa-solid fa-circle-info"></i> ê³ ê°ë‹˜ì˜ ì†Œì¤‘í•œ ì‘ì—…ë¬¼ì„ ì„ì‹œì €ì¥í•˜ê¸° ìœ„í•´ì„œëŠ”<br>íšŒì›ê°€ì… ë˜ëŠ” ë¡œê·¸ì¸ì´ ê¼­ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.
    </p>
    
    <button onclick="document.getElementById('loginModal').style.display='none'" class="btn-round" style="width: 100%; justify-content: center; background: #f8fafc; border: 1px solid #e2e8f0; color: #64748b; font-weight: normal;">
        ğŸ‘€ ë¡œê·¸ì¸ ì—†ì´ ë‘˜ëŸ¬ë³´ê¸°
    </button>
</div>
    </div>
</div>
<div id="productDetailModal" class="modal-bg" style="z-index: 11000;"><div class="modal-box" style="width: 900px; max-width: 95%; display: flex; text-align: left; padding:0; overflow:hidden;"><div style="width: 45%; background: #f8fafc; display: flex; align-items: center; justify-content: center; padding: 20px;"><img id="pdpImage" src="" style="max-width: 100%; max-height: 300px; object-fit: contain;"></div><div style="width: 55%; padding: 40px; display: flex; flex-direction: column;"><h2 id="pdpTitle" style="margin: 0 0 10px 0;">ìƒí’ˆëª…</h2><h3 id="pdpPrice" style="color: var(--primary); margin: 0 0 20px 0;">0ì›</h3><button id="btnActionDesign" class="btn-round primary" style="height: 50px;">ğŸ¨ ì§ì ‘ ë””ìì¸í•˜ê¸°</button><div style="margin-top:10px;"><input type="file" id="pdpFileUpload" style="display: none;"><button onclick="document.getElementById('pdpFileUpload').click()" class="btn-round">ğŸ“‚ íŒŒì¼ ì—…ë¡œë“œ ì£¼ë¬¸</button></div><button onclick="document.getElementById('productDetailModal').style.display='none'" style="margin-top: auto; border:none; background:none; cursor:pointer;">ë‹«ê¸°</button></div></div></div>
<div id="cartPage" style="display:none; position:fixed; inset:0; background:#f1f5f9; z-index: 12000; overflow-y:auto; padding-top: 40px;">
    <div style="max-width: 1000px; margin: 0 auto; padding-bottom: 60px;">
        <div style="display:flex; justify-content:space-between; align-items:center; padding:0 20px;">
            <h1>ğŸ›’ <span data-i18n="cart_title">ì¥ë°”êµ¬ë‹ˆ</span> <span id="cartCount">(0)</span></h1>
            <button onclick="document.getElementById('cartPage').style.display='none'" class="btn-round" style="width:auto;" data-i18n="btn_close">ë‹«ê¸°</button>
        </div>

        <div style="display: flex; flex-direction: column; gap: 20px; padding: 0 20px;">
            <div id="cartListArea" style="width: 100%;"></div>
            
            <div style="width: 100%;">
                <div style="background:white; padding:20px; border-radius:12px;">
                    <h3 data-i18n="label_payment_amt">ê²°ì œ ê¸ˆì•¡</h3>
                    
                    <div style="display:flex; justify-content:space-between; margin-bottom: 5px;">
                        <span data-i18n="label_product_price">ìƒí’ˆ</span>
                        <span id="summaryItemPrice">0ì›</span>
                    </div>
                    
                    <div style="display:flex; justify-content:space-between; margin-bottom: 5px;">
                        <span data-i18n="label_option_price">ì˜µì…˜</span>
                        <span id="summaryAddonPrice">0ì›</span>
                    </div>
                    
                    <div style="display:flex; justify-content:space-between; color:#ef4444; font-weight:bold; margin-bottom: 5px;">
                        <span>ë“±ê¸‰ í• ì¸</span>
                        <span id="summaryDiscount">0ì› (0%)</span>
                    </div>
                    
                    <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">
                    
                    <div style="display:flex; justify-content:space-between; font-weight:bold; font-size:20px; margin-bottom: 20px;">
                        <span data-i18n="label_total_price">í•©ê³„</span>
                        <span id="summaryTotal">0ì›</span>
                    </div>
                    
                    <button id="btnGoCheckout" class="btn-round primary" style="margin-top:0; width:100%; height: 50px; font-size: 16px;">
                        ğŸ’³ <span data-i18n="btn_do_checkout">ê²°ì œí•˜ê¸°</span>
                    </button>
                    
                    <button id="btnPrintQuote" class="btn-round btn-secondary" style="margin-top:10px; width:100%;">
                        <i class="fa-solid fa-file-invoice"></i> <span data-i18n="btn_print_quote">ê²¬ì ì„œ ì¶œë ¥</span>
                    </button>
                </div>
            </div>
            </div>
    </div>
</div>
<div id="calendarModal" class="modal-bg" style="z-index: 12500;">
    <div class="modal-box">
        <h3>ğŸ“… <span data-i18n="modal_calendar_title">ë°°ì†¡ìš”ì²­ [ì œì‘ê¸°ê°„ 3ì¼]</span></h3>
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
            <button id="btnPrevMonth" class="btn-round" style="width:30px;">&lt;</button>
            <span id="currentMonthYear" style="font-weight:bold;"></span>
            <button id="btnNextMonth" class="btn-round" style="width:30px;">&gt;</button>
        </div>
        <div id="calendarGrid" class="calendar-grid"></div>
        <button onclick="document.getElementById('calendarModal').style.display='none'" class="btn-round" style="margin-top:15px;" data-i18n="btn_close">ë‹«ê¸°</button>
    </div>
</div>
<div id="deliveryInfoModal" class="modal-bg" style="z-index: 12600;">
    <div class="modal-box" style="text-align:left;">
        <h3 style="text-align:center;" data-i18n="modal_delivery_title">ğŸ“ ë°°ì†¡ ì •ë³´ ì…ë ¥</h3>
        
        <p data-i18n="label_manager_name">ë‹´ë‹¹ìëª…</p>
        <input id="inputManagerName" class="ai-input-pretty">
        
        <p data-i18n="label_contact_phone">ì—°ë½ì²˜</p>
        <input id="inputManagerPhone" class="ai-input-pretty">
        
        <p data-i18n="label_address">ì£¼ì†Œ (Address)</p>
        
        <div id="addrFormKR">
            <input id="inputAddressKR" class="ai-input-pretty" placeholder="ì£¼ì†Œ ê²€ìƒ‰ ë˜ëŠ” ì…ë ¥">
        </div>

        <div id="addrFormGlobal" style="display:none; gap:10px; flex-direction:column;">
            <div style="display:flex; gap:10px;">
                <input id="inputZipCode" class="ai-input-pretty" placeholder="Zip/Postal Code" style="flex:1; margin:0;">
                <input id="inputState" class="ai-input-pretty" placeholder="State/Prefecture" style="flex:1; margin:0;">
            </div>
            <input id="inputCity" class="ai-input-pretty" placeholder="City" style="margin-bottom:0;">
            <input id="inputStreet1" class="ai-input-pretty" placeholder="Street Address 1" style="margin-bottom:0;">
            <input id="inputStreet2" class="ai-input-pretty" placeholder="Apartment, suite, unit, etc. (optional)">
        </div>
        
        <p data-i18n="label_request_memo" style="margin-top:10px;">ìš”ì²­ì‚¬í•­</p>
        <textarea id="inputRequest" class="ai-input-pretty"></textarea>
        
        <button id="btnSubmitOrderInfo" class="btn-round primary" style="margin-top:10px;" data-i18n="btn_payment_submit">ì£¼ë¬¸ì„œ ìƒì„± ë° ê²°ì œ</button>
        <button onclick="document.getElementById('deliveryInfoModal').style.display='none'" class="btn-round" style="margin-top:5px;" data-i18n="btn_cancel">ì·¨ì†Œ</button>
    </div>
</div>

<div id="checkoutModal" class="modal-bg" style="z-index: 13000;">
    <div class="modal-box" style="text-align:left; width: 500px;">
        <h3 style="text-align:center; margin-bottom: 20px;" data-i18n="modal_checkout_title">ì£¼ë¬¸ í™•ì¸ ë° ê²°ì œ</h3>
        
        <label style="font-size:12px; color:#666; font-weight:bold;" data-i18n="label_orderer_name">ì£¼ë¬¸ìëª…</label>
        <input id="orderName" class="ai-input-pretty" readonly>
        
        <label style="font-size:12px; color:#666; font-weight:bold;" data-i18n="label_contact_phone">ì—°ë½ì²˜</label>
        <input id="orderPhone" class="ai-input-pretty" readonly>
        
        <label style="font-size:12px; color:#666; font-weight:bold;" data-i18n="label_shipping_addr">ë°°ì†¡ì§€</label>
        <input id="orderAddr" class="ai-input-pretty" readonly>
        
        <label style="font-size:12px; color:#666; font-weight:bold;" data-i18n="label_request_memo">ìš”ì²­ì‚¬í•­</label>
        <textarea id="orderMemo" class="ai-input-pretty" readonly></textarea>
        
        <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">

        <label style="font-size:14px; font-weight:bold; color:#333; margin-bottom:10px; display:block;">ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ</label>
        
        <div style="display:flex; flex-direction:column; gap:10px; margin-bottom:20px;">
            <label class="pay-method-item" style="display:flex; align-items:center; padding:10px; border:1px solid #ddd; border-radius:8px; cursor:pointer;">
                <input type="radio" name="paymentMethod" value="card" checked style="margin-right:10px; accent-color:#6366f1;">
                <span>ğŸ’³ ì¹´ë“œ / ê°„í¸ê²°ì œ (ì¦‰ì‹œ ì™„ë£Œ)</span>
            </label>

            <label class="pay-method-item" style="display:flex; align-items:center; padding:10px; border:1px solid #ddd; border-radius:8px; cursor:pointer;">
                <input type="radio" name="paymentMethod" value="bank" style="margin-right:10px; accent-color:#6366f1;">
                <span>ğŸ¦ ë¬´í†µì¥ ì…ê¸ˆ (í™•ì¸ í›„ ì œì‘)</span>
            </label>

            <label class="pay-method-item" style="display:flex; align-items:center; padding:10px; border:1px solid #ddd; border-radius:8px; cursor:pointer;">
                <input type="radio" name="paymentMethod" value="deposit" style="margin-right:10px; accent-color:#6366f1;">
                <div style="display:flex; justify-content:space-between; width:100%;">
                    <span>ğŸ’° ë‚˜ì˜ ì˜ˆì¹˜ê¸ˆ ì‚¬ìš©</span>
                    <span id="myCurrentDepositDisplay" style="font-weight:bold; color:#6366f1;">(ì”ì•¡ ì¡°íšŒì¤‘...)</span>
                </div>
            </label>
        </div>

        <button id="btnFinalPay" class="btn-round primary" style="width:100%; height: 50px; font-size: 16px;" onclick="window.handleFinalPayment()">
            ê²°ì œí•˜ê¸°
        </button>

        <div id="bankInfoBox" style="display:none; margin-top:15px; background:#f8fafc; padding:15px; border-radius:8px; font-size:13px;">
            <div class="bank-title" style="font-weight:bold; margin-bottom:5px;">[ê³„ì¢Œì´ì²´ ì•ˆë‚´]</div>
            <div>êµ­ë¯¼ì€í–‰ 647701-04-277763 (ì˜ˆê¸ˆì£¼: ì¹´ë©œë ˆì˜¨í”„ë¦°íŒ…)</div>
            <div style="color:#ef4444; margin-top:5px;">* ì…ê¸ˆìëª…ì´ ì£¼ë¬¸ìëª…ê³¼ ë‹¤ë¥´ë©´ í™•ì¸ì´ ì§€ì—°ë©ë‹ˆë‹¤.</div>
        </div>

        <div style="display:flex; gap:10px; margin-top:15px;">
            <button id="btnDownQuotationCheckout" class="btn-round btn-secondary" style="flex:1; justify-content: center;">
                <i class="fa-solid fa-file-invoice"></i> ê²¬ì ì„œ ë‹¤ìš´
            </button>
            <button id="btnDownOrderSheetCheckout" class="btn-round btn-secondary" style="flex:1; justify-content: center;">
                <i class="fa-solid fa-clipboard-list"></i> ì‘ì—…ì§€ì‹œì„œ ë‹¤ìš´
            </button>
        </div>

        <button onclick="document.getElementById('checkoutModal').style.display='none'; if(window.isOrderCompleted) location.reload();" class="btn-round" style="margin-top:10px; border:none; color:#888;">ë‹«ê¸°</button>
    </div>
</div>
        </div>

        <button onclick="document.getElementById('checkoutModal').style.display='none'" class="btn-round" style="margin-top:10px; border:none; color:#888;">ë‹«ê¸°</button>
    </div>
</div>

        <button onclick="document.getElementById('checkoutModal').style.display='none'" class="btn-round" style="margin-top:10px; border:none; color:#888;">ë‹«ê¸°</button>
    </div>
</div>
</div>
<div id="successModal" class="modal-bg" style="z-index: 14000;"><div class="modal-box"><h2>ğŸ‰ ì£¼ë¬¸ ì™„ë£Œ!</h2><button id="btnDownOrderSheet" class="btn-round">ğŸ“„ ì‘ì—…ì§€ì‹œì„œ ë‹¤ìš´ë¡œë“œ</button><button id="btnDownQuotation" class="btn-round" style="margin-top:5px;">ğŸ“‘ ê²¬ì ì„œ ë‹¤ìš´ë¡œë“œ</button><button onclick="window.closeSuccessModal()" class="btn-round primary" style="margin-top:15px;">í™•ì¸</button></div></div>
<div id="sellModal" class="modal-bg" style="display: none;"> <div class="modal-box">
        <h3 class="modal-title">ğŸ’ ë””ìì¸ ê³µìœ /íŒë§¤ ë“±ë¡</h3>
        
        <div class="benefit-box">
            <div class="benefit-item">
                <span class="benefit-icon">ğŸ’°</span>
                <span>ë“±ë¡ ì¦‰ì‹œ <span class="highlight">100ì›</span>, ì‚¬ìš©ë  ë•Œë§ˆë‹¤ <span class="highlight">200ì›</span> ì ë¦½</span>
            </div>
            <div class="benefit-item">
                <span class="benefit-icon">ğŸ’³</span>
                <span>1,000ì›ë¶€í„° ë°”ë¡œ <span class="highlight">í˜„ê¸ˆ í™˜ì „</span> ê°€ëŠ¥</span>
            </div>
            <div class="benefit-item">
                <span class="benefit-icon">ğŸš€</span>
                <span>í…ìŠ¤íŠ¸/ë¡œê³  ê³µìœ ë¡œ ë§¤ì¼ ìë™ ìˆ˜ì… ë§Œë“¤ê¸°!</span>
            </div>
        </div>

        

        <div class="input-row" style="margin-bottom: 15px;">
    <label style="display:block; font-weight:bold; margin-bottom:5px;">í…œí”Œë¦¿ ìœ í˜•</label>
    <div style="display: flex; gap: 20px;">
        <label style="cursor:pointer; display:flex; align-items:center; gap:5px;">
            <input type="radio" name="sellType" value="vector" checked> 
            ë²¡í„°
        </label>
        <label style="cursor:pointer; display:flex; align-items:center; gap:5px;">
            <input type="radio" name="sellType" value="image"> 
            ì´ë¯¸ì§€
        </label>
    </div>
</div>
        <div class="input-group">
            <label class="input-label">í‚¤ì›Œë“œ & ì œëª©</label>
            <input id="sellTitle" class="ai-input-pretty" 
                   type="text"
                   placeholder="ì˜ˆ: í”¼ë¶€ê³¼ ì´ë²¤íŠ¸, ì—¬ë¦„ í¬ìŠ¤í„°" 
                   oninput="document.getElementById('sellKw').value = this.value;">
        </div>

        <input id="sellKw" type="hidden">
        

        <div class="btn-group">
            <button onclick="document.getElementById('sellModal').style.display='none'" class="btn-round cancel">ì·¨ì†Œ</button>
            <button id="btnSellConfirm" class="btn-round primary">ë“±ë¡í•˜ê¸°</button>
        </div>
    </div>
</div>
<div id="fontModal" class="modal-bg" style="z-index: 10002;"><div class="modal-box"><h3>í°íŠ¸ ì„ íƒ</h3><div id="fontList" style="max-height:300px; overflow-y:auto;"></div><button onclick="document.getElementById('fontModal').style.display='none'" class="btn-round" style="margin-top:10px;">ë‹«ê¸°</button></div></div>
<div id="choiceModal" class="modal-bg" style="z-index: 15000;">
    <div class="modal-box" style="width: 900px; max-width: 95%;">
        
        <div class="choice-layout">
    <div class="choice-left">
        <h3 style="margin-top:0;" data-i18n="choice_modal_title">ğŸ¨ ì‘ì—… ë°©ì‹ì„ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
        <p style="color:#666; font-size:14px; margin-bottom:30px; line-height:1.5;" data-i18n="choice_modal_desc">
            ì„ íƒí•˜ì‹  <span id="choiceProdName" style="color:#6366f1; font-weight:bold;">ìƒí’ˆ</span>ìœ¼ë¡œ ë””ìì¸ì„ ì‹œì‘í•˜ê±°ë‚˜,<br>
            ì´ë¯¸ ì™„ì„±ëœ íŒŒì¼ì´ ìˆë‹¤ë©´ ë°”ë¡œ ì£¼ë¬¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>

        <div style="display:flex; gap:15px; margin-bottom:20px;">
            <button onclick="window.confirmChoice('editor')" class="btn-round primary" style="flex:1; height:120px; flex-direction:column; justify-content:center; gap:10px;">
                <i class="fa-solid fa-palette" style="font-size:32px;"></i>
                <span style="font-size:16px;" data-i18n="btn_design_direct">ì§ì ‘ ë””ìì¸í•˜ê¸°</span>
                <span style="font-size:12px; font-weight:normal; opacity:0.8;" data-i18n="btn_design_direct_sub">ì—ë””í„°ì—ì„œ ê¾¸ë¯¸ê¸°</span>
            </button>

            <button onclick="window.confirmChoice('file')" class="btn-round" style="flex:1; height:120px; flex-direction:column; justify-content:center; gap:10px; background:#f1f5f9; color:#334155; border:1px solid #cbd5e1;">
                <i class="fa-solid fa-cloud-arrow-up" style="font-size:32px;"></i>
                <span style="font-size:16px;" data-i18n="btn_order_file">ë‚´ íŒŒì¼ë¡œ ì£¼ë¬¸</span>
                <span style="font-size:12px; font-weight:normal; opacity:0.8;" data-i18n="btn_order_file_sub">PDFì—…ë¡œë“œ 10ë©”ê°€ ì´ìƒ korea900@daum.net</span>
            </button>
        </div>

        <input type="file" id="directUploadInput" style="display:none;" accept="image/*,.pdf">
        
        <button onclick="document.getElementById('choiceModal').style.display='none'" class="btn-round" style="margin-top:auto;" data-i18n="btn_close">ë‹«ê¸°</button>
    </div>

    <div class="choice-right">
        <img id="choiceProductImg" src="" alt="ìƒí’ˆ ì´ë¯¸ì§€">
    </div>
</div>

    </div>
</div>
<div id="mobileControlDock" style="z-index: 30000;">
    <button onclick="window.toggleMobilePanel('left')" class="mobile-fab left">
        <i class="fa-solid fa-shapes"></i>
        <span>ê¸€ìë„í˜•</span>
    </button>

    <button onclick="window.toggleMobilePanel('right')" class="mobile-fab right">
        <i class="fa-solid fa-layer-group"></i>
        <span>í¸ì§‘/ì •ë ¬</span>
    </button>
</div>
<div id="categoryDetailModal" class="modal-bg" style="z-index: 15000;">
    <div class="modal-box" style="width: 800px; max-width: 95%;">
        <h3 id="catModalTitle">ğŸ“ ì‚¬ì´ì¦ˆ(ì œí’ˆ)ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
        <p style="margin-bottom:20px; color:#666;">ì›í•˜ì‹œëŠ” ê·œê²©ì„ ì„ íƒí•˜ì‹œë©´ ë””ìì¸ì´ ì‹œì‘ë©ë‹ˆë‹¤.</p>
        
        <div id="catProductGrid" class="quick-menu-track" style="grid-template-columns: repeat(4, 1fr);"></div>
        
        <button onclick="document.getElementById('categoryDetailModal').style.display='none'" class="btn-round" style="margin-top:20px;">ë‹«ê¸°</button>
    </div>
</div>
<div id="logoUploadModal" class="modal-bg" style="z-index: 20000;">
    <div class="modal-box" style="width: 400px;">
        <h3 style="margin-top:0;">â˜ï¸ Upload Logo</h3>
        <div class="upload-drop-zone" id="dropZone" onclick="document.getElementById('logoFileInput').click()">
            <i class="fa-solid fa-cloud-arrow-up upload-icon"></i>
            <span class="upload-text">Click or Drag</span>
            <img id="previewImage">
            <div id="removeFileBtn" onclick="window.resetUpload(event)">âœ•</div>
        </div>
        <input type="file" id="logoFileInput" accept="image/png, image/jpeg, image/svg+xml" style="display:none;" onchange="window.handleFileSelect(this)">
        <input type="text" id="logoKeywordInput" class="ai-input-pretty" placeholder="PNGë¡œê³  ë“±ë¡ì‹œ 150ì› ì¦‰ì‹œ ì§€ê¸‰ MY pageì—ì„œ í™•ì¸">
        <div style="display:flex; gap:10px; margin-top:10px;">
            <button onclick="window.uploadUserLogo()" class="btn-round primary" style="flex:2;">Upload</button>
            <button onclick="document.getElementById('logoUploadModal').style.display='none'" class="btn-round" style="flex:1;">Cancel</button>
        </div>
    </div>
</div>


<div id="aiStartModal" class="modal-bg" style="z-index: 15000;">
    <div class="modal-box" style="width: 500px; max-width: 90%;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
            <h3 style="margin:0;">âœ¨ AI ì´ë¯¸ì§€ ìƒì„± (Start)</h3>
            <button onclick="document.getElementById('aiStartModal').style.display='none'" style="border:none; background:none; cursor:pointer; font-size:20px;">âœ•</button>
        </div>
        
        <p style="color:#666; font-size:14px; margin-bottom:10px;">ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ë©´ ë‹¤ë¥¸ ìœ ì €ì—ê²Œ ìë™ìœ¼ë¡œ ê³µìœ ë˜ê³  í˜„ê¸ˆìœ¼ë¡œ ì ë¦½ë©ë‹ˆë‹¤.</p>
        
        <textarea id="aiStartPrompt" class="ai-input-pretty" placeholder="ë©‹ì§„ í”„ë¡¬í”„íŠ¸ë¥¼ ì‘ì„±í•˜ì‹œë©´ ìµœìƒìœ„ AI ëª¨ë¸ë¡œ ë©‹ì§„ ì‘í’ˆì„ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤. ì‹œì‘í™”ë©´ìœ¼ë¡œ ê°€ì„œ ìƒˆë¡œê³ ì¹¨ í•˜ë©´ ê³ ê°ë‹˜ê»˜ì„œ ìƒì„±í•œ ë©‹ì§„ ì‘í’ˆì´ í•˜ë‹¨ì‘í’ˆì— ë“±ë¡ë˜ì–´ ìˆì„ê±°ì˜ˆìš”." style="height:100px;"></textarea>
        
        <button id="btnAiStartGen" class="btn-round primary" style="width:100%; margin-top:5px;">
            ğŸ¨ ìƒì„±í•˜ê¸°
        </button>

        <div id="aiStartResult" style="margin-top:20px; min-height:300px; background:#f8fafc; border-radius:12px; display:flex; align-items:center; justify-content:center; border:1px solid #e2e8f0;">
            <span style="color:#cbd5e1;">ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</span>
        </div>

        <button id="btnAiStartGo" class="btn-round" style="width:100%; margin-top:15px; display:none; background:#111; color:#fff;">
            ğŸš€ ì´ ì´ë¯¸ì§€ë¡œ ë””ìì¸ ì‹œì‘í•˜ê¸°
        </button>
    </div>
</div>
<script type="module" src="./config.js"></script>
<script type="module" src="./canvas-core.js"></script>
<script type="module" src="./canvas-size.js"></script>
<script type="module" src="./canvas-guides.js"></script>
<script type="module" src="./canvas-zoom-pan.js"></script>
<script type="module" src="./canvas-objects.js"></script>
<script type="module" src="./canvas-image.js"></script>
<script type="module" src="./canvas-template.js"></script>
<script type="module" src="./canvas-ai.js"></script>
<script type="module" src="./canvas-utils.js"></script>
<script type="module" src="./shortcuts.js"></script>
<script type="module" src="./context-menu.js"></script>
<script type="module" src="./export.js"></script>
<script type="module" src="./order.js"></script>
<script type="module" src="./login.js"></script>
<script type="module" src="./my-design.js"></script>
<script type="module" src="./main.js"></script>

<script src="./text-wizard.js"></script> 

</body>
</html>

<script type="module">
    import { canvas, setMaxLimits } from './canvas-core.js';
    import { openProductDetail, startDesignFromProduct } from './order.js';
    import { applySize } from './canvas-size.js';
    import { sb, PRODUCT_DB, cartData, currentUser, initConfig } from './config.js'; // initConfig ì¶”ê°€ë¨
    
    // ìœˆë„ìš° ì „ì—­ ë³€ìˆ˜ ì—°ê²°
    window.canvas = canvas;
    // [ê°•ë ¥ ìµœì í™”] ì´ë¯¸ì§€ë¥¼ ì•„ì£¼ ì‘ê²Œ(ì¸ë„¤ì¼ìš©) ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
    window.getTinyThumb = function(url, size = 150) {
        if (!url) return '';
        // Supabase ì´ë¯¸ì§€ë¼ë©´ ì„œë²„ì—ì„œ ë¦¬ì‚¬ì´ì§•í•´ì„œ ê°€ì ¸ì˜´ (ì†ë„ 20ë°° í–¥ìƒ)
        if (url.includes('supabase.co')) {
            const separator = url.includes('?') ? '&' : '?';
            // quality=50: í™”ì§ˆ ì ˆë°˜ (ì‘ê²Œ ë³´ë‹ˆê¹Œ ìƒê´€ì—†ìŒ)
            // format=webp: ìš©ëŸ‰ ì ì€ í¬ë§·
            return `${url}${separator}width=${size}&height=${size}&resize=cover&quality=50&format=webp`;
        }
        return url;
    };
    window.openProductDetail = openProductDetail;
    window.startDesignFromProduct = startDesignFromProduct;
    window.applySize = applySize;
    window.currentProductKey = 'A4';
    let selectedProductForChoice = null;

    window.onTemplateClick = async function(tpl) {
        const startScreen = document.getElementById('startScreen');
        // ì—ë””í„° ì§„ì… ì „(ì‹œì‘ í™”ë©´)ì¸ì§€ í™•ì¸
        const isStartScreenVisible = startScreen && window.getComputedStyle(startScreen).display !== 'none';

        if (isStartScreenVisible) {
            // [CASE 1] ì‹œì‘ í™”ë©´ì¼ ë•Œ: ì‚¬ì´ì¦ˆ ì„ íƒ ëª¨ë‹¬ ë„ìš°ê¸°
            document.getElementById('templateOverlay').style.display = 'none'; // ìƒë‹¨ íŒì—… ë‹«ê¸°
            window.pendingTemplate = tpl; // ì„ íƒí•œ í…œí”Œë¦¿ ì €ì¥

            // ì‚¬ì´ì¦ˆ ì„ íƒ ëª¨ë‹¬ í˜¸ì¶œ (ê¸°ì¡´ í•¨ìˆ˜ í™œìš©)
            if (window.showCategorySelectionModal) {
                window.showCategorySelectionModal();
            } else {
                // ë§Œì•½ showCategorySelectionModal í•¨ìˆ˜ê°€ ì—†ë‹¤ë©´ showCategoryProductsë¥¼ ëŒ€ì‹  ì‚¬ìš©í•˜ê±°ë‚˜ ê²½ê³ 
                alert("ì‚¬ì´ì¦ˆ ì„ íƒ í™”ë©´ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            }
        } else {
            // [CASE 2] ì—ë””í„° ì‘ì—… ì¤‘ì¼ ë•Œ: ìº”ë²„ìŠ¤ì— ì¶”ê°€ í™•ì¸
            if(!confirm("í˜„ì¬ ìº”ë²„ìŠ¤ì— í…œí”Œë¦¿ì„ ì ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ê¸°ì¡´ ë””ìì¸ ìœ„ì— ì¶”ê°€ë©ë‹ˆë‹¤)")) return;
            
            document.getElementById('templateOverlay').style.display = 'none';
            await window.applyTemplateDirectly(tpl);
        }
    };

    // 2. ìƒë‹¨ íŒì—…ì— í…œí”Œë¦¿ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜
    window.filterTpl = async function(category, btnElement) {
        // ë²„íŠ¼ ìŠ¤íƒ€ì¼ í™œì„±í™”
        if (btnElement) {
            const sidebar = document.querySelector('.tpl-sidebar');
            if(sidebar) sidebar.querySelectorAll('.tpl-cate-btn').forEach(b => b.classList.remove('active'));
            btnElement.classList.add('active');
        }

        const grid = document.getElementById('tplGrid');
        if (!grid) return;

        grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:30px; color:#888;">ë¡œë”© ì¤‘...</div>';

        try {
            // DBì—ì„œ í…œí”Œë¦¿ ê°€ì ¸ì˜¤ê¸°
            let query = sb.from('library')
                          .select('id, thumb_url, data_url, category, tags')
                          .order('created_at', { ascending: false })
                          .limit(50);
            
            // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
            if (category && category !== 'all') {
                query = query.ilike('category', `%${category}%`); 
            }

            const { data, error } = await query;
            if (error) throw error;

            grid.innerHTML = '';

            if (!data || data.length === 0) {
                grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:30px; color:#999;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            // ëª©ë¡ ìƒì„±
            data.forEach(tpl => {
                const div = document.createElement('div');
                div.className = 'tpl-item';
                div.style.cssText = 'cursor:pointer; position:relative; overflow:hidden; border-radius:8px; aspect-ratio:1/1.4; background:#f1f5f9;';

                const imgSrc = tpl.thumb_url || 'https://via.placeholder.com/300?text=No+Image';
                div.innerHTML = `<img src="${imgSrc}" style="width:100%; height:100%; object-fit:cover;">`;

                // í´ë¦­ ì‹œ ê³µí†µ í•¨ìˆ˜ í˜¸ì¶œ
                div.onclick = () => window.onTemplateClick(tpl);
                grid.appendChild(div);
            });

        } catch (e) {
            console.error(e);
            grid.innerHTML = '<div style="grid-column:1/-1; text-align:center;">ì˜¤ë¥˜ ë°œìƒ</div>';
        }
    };

    window.translations = {}; 


    // ============================================================
    // [1] ë©”ì¸ ë¡œë“œ ì´ë²¤íŠ¸ (ì¦‰ì‹œ ë°˜ì‘í˜• ë¡œê·¸ì¸ ì²˜ë¦¬)
    // ============================================================
    window.addEventListener('load', async () => {
        
        // 1. ì„¤ì • ë¡œë”© (config.js)
        if (window.initConfig) await window.initConfig(); 
        else if (typeof initConfig === 'function') await initConfig();

        // 2. ë¡œê·¸ì¸ ë²„íŠ¼ ìƒíƒœ "ì¦‰ì‹œ" ì—…ë°ì´íŠ¸
        updateLoginButtonState();

        // 3. ì¹´í…Œê³ ë¦¬ ë©”ë‰´ ë Œë”ë§
        if (typeof renderQuickMenu === 'function') renderQuickMenu();
        
        // 4. í…œí”Œë¦¿ ë° ìƒí’ˆ ë¡œë“œ
        if(window.searchTemplates) window.searchTemplates('');
        if (window.preloadLanguageFont) window.preloadLanguageFont();
        if (typeof loadSpecialProducts === 'function') {
            loadSpecialProducts('hotDealSection', 'hotDealGrid', 'hotdeal', 6);
            loadSpecialProducts('bizDealSection', 'bizDealGrid', '23432424', 6);
        }

        // 5. ê²€ìƒ‰ì°½ ì—°ê²°
        const searchBtn = document.getElementById('btnStartSearch');
        const searchInput = document.getElementById('startSearchInput');
        if (searchBtn && searchInput) {
            const doSearch = () => { if(window.searchTemplates) window.searchTemplates(searchInput.value); };
            searchBtn.onclick = doSearch;
            searchInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') doSearch(); });
        }
    });

    // â˜… [í•µì‹¬] ë¡œê·¸ì¸ ë²„íŠ¼ ìƒíƒœë¥¼ ê°•ì œë¡œ ê³ ì¹˜ëŠ” í•¨ìˆ˜
    function updateLoginButtonState() {
        const btnLogin = document.getElementById('btnLoginBtn');
        const btnConsole = document.getElementById('btnPartnerConsole');
        
        // window.currentUserëŠ” config.jsì—ì„œ ì´ë¯¸ ì„¤ì •ë¨
        if (window.currentUser) {
            console.log("âœ… ë¡œê·¸ì¸ ìƒíƒœ UI ì ìš©:", window.currentUser.email);
            
            if (btnLogin) {
                // 1. í…ìŠ¤íŠ¸ ë³€ê²½
                btnLogin.innerText = "ë¡œê·¸ì•„ì›ƒ";
                btnLogin.style.fontWeight = "bold"; 
                btnLogin.style.color = "#ef4444"; 
                
                // 2. ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±° ë° ë¡œê·¸ì•„ì›ƒ ì´ë²¤íŠ¸ ê°•ì œ ì£¼ì…
                // (cloneNodeë¥¼ ì‚¬ìš©í•´ ê¸°ì¡´ì— ì˜ëª» ì—°ê²°ëœ ë¡œê·¸ì¸ ì°½ ë„ìš°ê¸° ì´ë²¤íŠ¸ë¥¼ ë‚ ë ¤ë²„ë¦¼)
                const newBtn = btnLogin.cloneNode(true);
                btnLogin.parentNode.replaceChild(newBtn, btnLogin);
                
                newBtn.onclick = async function() {
                    if (confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                        // Supabase ë¡œê·¸ì•„ì›ƒ ì‹œë„
                        if(typeof sb !== 'undefined') await sb.auth.signOut();
                        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í´ë¦¬ì–´ (í™•ì‹¤í•˜ê²Œ)
                        localStorage.removeItem('sb-qinvtnhiidtmrzosyvys-auth-token'); 
                        window.location.reload(); 
                    }
                };
            }
            if(btnConsole) btnConsole.style.removeProperty('display');
        } else {
            // ë¹„ë¡œê·¸ì¸ ìƒíƒœ
            if (btnLogin) {
                btnLogin.innerText = "ë¡œê·¸ì¸";
                btnLogin.style.fontWeight = "normal";
                btnLogin.style.color = "";
                
                const newBtn = btnLogin.cloneNode(true);
                btnLogin.parentNode.replaceChild(newBtn, btnLogin);

                newBtn.onclick = () => document.getElementById('loginModal').style.display = 'flex';
            }
            if(btnConsole) btnConsole.style.setProperty('display', 'none', 'important');
        }
    }

// â–¼â–¼â–¼ [ìƒˆë¡œ ì¶”ê°€] ë§ˆì´í˜ì´ì§€ì—ì„œ [í¸ì§‘] ëˆŒë €ì„ ë•Œ ë³µêµ¬í•˜ëŠ” ì½”ë“œ â–¼â–¼â–¼
const loadId = localStorage.getItem('load_design_id');
if (loadId) {
    localStorage.removeItem('load_design_id'); // í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ë„ë¡ ì‚­ì œ
    
    setTimeout(async () => {
        const loading = document.getElementById('loading');
        if(loading) loading.style.display = 'flex';
        
        try {
            // 1. DBì—ì„œ ì €ì¥ëœ ë””ìì¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const { data, error } = await sb.from('user_designs').select('*').eq('id', loadId).single();
            
            if (error || !data) throw new Error("ë””ìì¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");

            if (data.json && !data.json_data) {
                data.json_data = data.json;
            }

            // 2. ì—ë””í„° í™”ë©´ìœ¼ë¡œ ì „í™˜
            document.getElementById("startScreen").style.display = "none";
            document.getElementById("mainEditor").style.display = "flex";
            document.body.classList.add('editor-active');

            // 3. my-design.jsì— ìˆëŠ” ë³µêµ¬ í•¨ìˆ˜ ì‹¤í–‰
            if (window.restoreDesignFromData) {
                window.restoreDesignFromData(data);
            } else {
                console.error("ë³µêµ¬ í•¨ìˆ˜ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
                if(loading) loading.style.display = 'none';
            }

        } catch (e) {
            console.error(e);
            alert("ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: " + e.message);
            if(loading) loading.style.display = 'none';
        }
    }, 800); // 0.8ì´ˆ ë’¤ ì‹¤í–‰ (ì•ˆì „í•˜ê²Œ ë¡œë”©)
}


    // [ì¶”ê°€] í•«ë”œ ë Œë”ë§ í•¨ìˆ˜
    // [ìƒˆë¡œìš´ í†µí•© í•¨ìˆ˜] ì¼ë°˜ í•«ë”œ + ì—…ììš© í•«ë”œ ëª¨ë‘ ì²˜ë¦¬
    async function loadSpecialProducts(sectionId, gridId, categoryCode, limitCount = 6) {
        const section = document.getElementById(sectionId);
        const grid = document.getElementById(gridId);
        if (!grid) return;

        try {
            // DB ì¡°íšŒ (ì¹´í…Œê³ ë¦¬ ì½”ë“œ ê¸°ì¤€, ì •ë ¬, ê°¯ìˆ˜ì œí•œ)
            const { data: products, error } = await sb.from('admin_products')
                .select('*')
                .eq('category', categoryCode) // ì¹´í…Œê³ ë¦¬ í•„í„°
                .order('sort_order', { ascending: true }) 
                .limit(limitCount); 

            if (error) throw error;

            // ìƒí’ˆ ì—†ìœ¼ë©´ ì„¹ì…˜ ìˆ¨ê¹€
            if (!products || products.length === 0) {
                section.style.display = 'none';
                return;
            }

            // ì„¹ì…˜ ë³´ì´ê¸°
            section.style.display = 'block';
            grid.innerHTML = '';

            products.forEach(p => {
                // ì „ì—­ DB ë“±ë¡
                if (!window.PRODUCT_DB) window.PRODUCT_DB = {};
                
                // ë‹¤êµ­ì–´ ì²˜ë¦¬
                let dName = p.name;
                let dPrice = p.price;
                
                // ì „ì—­ ë³€ìˆ˜ ë“±ë¡
                window.PRODUCT_DB[p.code] = {
                    name: dName,
                    w: p.width_mm,
                    h: p.height_mm,
                    price: dPrice,
                    img: p.img_url,
                    addons: p.addons ? p.addons.split(',') : [],
                    category: p.category
                };

                // ì¹´ë“œ HTML ìƒì„±
                const card = document.createElement('div');
                card.className = 'hotdeal-card';
                
                const imgSrc = p.img_url || 'https://via.placeholder.com/300?text=No+Image';
                const sizeText = (p.width_mm && p.height_mm) ? `${p.width_mm} x ${p.height_mm}mm` : 'ì‚¬ì´ì¦ˆ ì˜µì…˜';
                
                // ë±ƒì§€ ìƒ‰ìƒ (ì¼ë°˜ í•«ë”œ: ë¹¨ê°•, ì—…ììš©: íŒŒë‘)
                const badgeColor = categoryCode === 'hotdeal' ? '#ef4444' : '#4f46e5';
                const badgeText = categoryCode === 'hotdeal' ? 'HOT' : 'BIZ';

                card.innerHTML = `
                    <div class="hotdeal-img-box">
                        <img src="${imgSrc}" alt="${dName}" onerror="this.src='https://placehold.co/300?text=No+Img'">
                        <div style="position:absolute; top:10px; left:10px; background:${badgeColor}; color:white; font-size:11px; font-weight:bold; padding:2px 8px; border-radius:4px;">${badgeText}</div>
                    </div>
                    <div class="hotdeal-info">
                        <div class="hotdeal-title">${dName}</div>
                        <div class="hotdeal-meta">${sizeText}</div>
                        <div class="hotdeal-price">${dPrice.toLocaleString()}ì›</div>
                    </div>
                `;

                // í´ë¦­ ì‹œ ì—ë””í„° ì‹¤í–‰
                card.onclick = () => {
                    window.currentProductKey = p.code;
                    window.selectedProductForChoice = window.PRODUCT_DB[p.code];
                    window.startEditorDirect(p.code);
                };

                grid.appendChild(card);
            });

        } catch (e) {
            console.error(`[${categoryCode}] ë¡œë”© ì‹¤íŒ¨:`, e);
            section.style.display = 'none';
        }
    }
// ============================================================
    // [ì‹ ê·œ] ìƒë‹¨ ë©”ë‰´ í´ë¦­ ì‹œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
    // (ì¹´í…Œê³ ë¦¬ê°€ ë¹„ì–´ë³´ì´ì§€ ì•Šê²Œ ì²«ë²ˆì§¸ ìƒí’ˆ ì‚¬ì§„ì„ ê°€ì ¸ì˜µë‹ˆë‹¤)
    // ============================================================
    window.openTopMenu = async function(topCode, titleText) {
        const modal = document.getElementById('categoryDetailModal');
        const grid = document.getElementById('catProductGrid');
        const titleEl = document.getElementById('catModalTitle');
        const descEl = modal.querySelector('p');

        // 1. ëª¨ë‹¬ ì°½ ì—´ê¸° & ë¡œë”© í‘œì‹œ
        modal.style.display = 'flex';
        if(titleEl) titleEl.innerHTML = `<span style="color:#6366f1;">${titleText}</span> <span style="font-size:14px; color:#888; font-weight:normal;">(ì„¸ë¶€ í•­ëª© ì„ íƒ)</span>`;
        if(descEl) descEl.innerText = "ì›í•˜ì‹œëŠ” ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.";
        
        grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:30px;">Loading...</div>';

        try {
            // 2. í•´ë‹¹ ë©”ë‰´ì˜ í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
            const { data: subCats } = await sb.from('admin_categories')
                .select('*')
                .eq('top_category_code', topCode) 
                .order('sort_order', { ascending: true });

            // ì¹´í…Œê³ ë¦¬ê°€ ì•„ì˜ˆ ì—†ìœ¼ë©´ -> ë°”ë¡œ ìƒí’ˆ ëª©ë¡ ë³´ì—¬ì£¼ê¸°ë¡œ ë„˜ì–´ê°
            if (!subCats || subCats.length === 0) {
                 window.showCategoryProducts(topCode, titleText);
                 return;
            }

            // 3. â˜… [í•µì‹¬] ë¹ˆ ì´ë¯¸ì§€ë¥¼ ì±„ìš°ê¸° ìœ„í•´ ìƒí’ˆ ì´ë¯¸ì§€ ë¯¸ë¦¬ ê°€ì ¸ì˜¤ê¸°
            const { data: prodImages } = await sb.from('admin_products')
                .select('category, img_url')
                .not('img_url', 'is', null) // ì´ë¯¸ì§€ê°€ ìˆëŠ” ê²ƒë§Œ
                .neq('img_url', '');

            // "ì¹´í…Œê³ ë¦¬ ì½”ë“œ" : "ìƒí’ˆ ì´ë¯¸ì§€ URL" í˜•íƒœë¡œ ì •ë¦¬ (ë§¤í•‘)
            const catThumbMap = {};
            if (prodImages) {
                prodImages.forEach(p => {
                    // ì•„ì§ ì´ ì¹´í…Œê³ ë¦¬ì— í• ë‹¹ëœ ì´ë¯¸ì§€ê°€ ì—†ìœ¼ë©´, ì²«ë²ˆì§¸ ë°œê²¬ëœ ìƒí’ˆ ì´ë¯¸ì§€ë¥¼ ë“±ë¡
                    if (p.category && !catThumbMap[p.category]) {
                        catThumbMap[p.category] = p.img_url;
                    }
                });
            }

            grid.innerHTML = '';

            // 4. í™”ë©´ì— ë²„íŠ¼ë“¤ ê·¸ë¦¬ê¸°
            subCats.forEach(cat => {
                const div = document.createElement('div');
                div.className = 'quick-item';
                div.style.cursor = 'pointer';

                // [ì´ë¯¸ì§€ ê²°ì • ìˆœì„œ] 
                // 1. ì¹´í…Œê³ ë¦¬ ìì²´ ì´ë¯¸ì§€ -> 2. (ì—†ìœ¼ë©´) ìƒí’ˆ ì´ë¯¸ì§€ -> 3. (ì—†ìœ¼ë©´) íšŒìƒ‰ í´ë” ì•„ì´ì½˜
                let iconUrl = cat.img_url || cat.image || cat.thumbnail || catThumbMap[cat.code] || '';
                
                let imgTag = '';
                if (iconUrl) {
                    imgTag = `<img src="${iconUrl}" style="width:100%; height:100%; object-fit:cover;" onerror="this.parentNode.innerHTML='<i class=\\'fa-solid fa-folder-open\\'></i>'">`;
                } else {
                    imgTag = `<i class="fa-solid fa-folder-open" style="font-size:24px; color:#cbd5e1;"></i>`;
                }

                div.innerHTML = `
                    <div class="quick-icon" style="background:#fff; border:1px solid #f1f5f9; overflow:hidden; display:flex; align-items:center; justify-content:center;">
                        ${imgTag}
                    </div>
                    <div class="quick-text">${cat.name}</div>
                `;

                // í´ë¦­í•˜ë©´ ìƒí’ˆ ëª©ë¡ìœ¼ë¡œ ì´ë™
                div.onclick = () => {
                    window.showCategoryProducts(cat.code, cat.name);
                };

                grid.appendChild(div);
            });

        } catch (e) {
            console.error("ìƒë‹¨ ë©”ë‰´ ë¡œë”© ì—ëŸ¬:", e);
            grid.innerHTML = '<div style="grid-column:1/-1; text-align:center;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>';
        }
    };

// [ìˆ˜ì •] index.html ë‚´ë¶€ì˜ renderQuickMenu í•¨ìˆ˜ êµì²´
// [ìµœì í™” ì ìš©] í€µë©”ë‰´ ë Œë”ë§ (ì´ë¯¸ì§€ 100pxë¡œ ì œí•œ)
    async function renderQuickMenu() {
        const tabContainer = document.getElementById('topCategoryTabs');
        const itemContainer = document.getElementById('quickMenuContainer');
        if (!tabContainer || !itemContainer) return;

        itemContainer.innerHTML = '<div style="grid-column:1/-1; text-align:center;">Loading...</div>';

        try {
            let { data: topCats } = await sb.from('admin_top_categories').select('*').order('sort_order', { ascending: true });
            const { data: subCats } = await sb.from('admin_categories').select('*').order('sort_order', { ascending: true });
            
            // ì´ë¯¸ì§€ ë§¤í•‘ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const { data: prodImages } = await sb.from('admin_products')
                .select('category, img_url')
                .not('img_url', 'is', null).neq('img_url', '');

            const catThumbMap = {};
            if (prodImages) {
                prodImages.forEach(p => {
                    if (p.category && !catThumbMap[p.category]) catThumbMap[p.category] = p.img_url;
                });
            }

            if (!subCats || subCats.length === 0) {
                itemContainer.innerHTML = '<div style="grid-column:1/-1; text-align:center;">No Category.</div>';
                return;
            }

            // ì¤‘ë³µ ì œê±° ë° ìˆ¨ê¹€ ì²˜ë¦¬
            if (topCats) {
                const seen = new Set();
                topCats = topCats.filter(cat => {
                    const name = cat.name.trim();
                    if (seen.has(name)) return false;
                    seen.add(name);
                    return true;
                });
                const hiddenNames = ['ë°°ë„ˆ/í˜„ìˆ˜ë§‰', 'ì „ì‹œ/ë§¤ëŒ€', 'ê¸°ë³¸ ëŒ€ë¶„ë¥˜', 'ê¸°ë³¸ëŒ€ë¶„ë¥˜'];
                topCats = topCats.filter(cat => !hiddenNames.includes(cat.name));
            }

            // íƒ­ ìƒì„± ë¡œì§
            const renderTabs = () => {
                tabContainer.innerHTML = '';
                if (topCats) {
                    topCats.forEach(top => {
                        const btn = document.createElement('button');
                        btn.className = 'cat-tab';
                        btn.innerText = top.name;
                        btn.onclick = (e) => {
                            handleTabClick(e);
                            renderItems(top.code);
                        };
                        tabContainer.appendChild(btn);
                    });
                }
                // ê¸°íƒ€ íƒ­
                const orphanCats = subCats.filter(sub => !sub.top_category_code);
                if (orphanCats.length > 0) {
                    const etcBtn = document.createElement('button');
                    etcBtn.className = 'cat-tab';
                    etcBtn.innerText = 'ê¸°íƒ€';
                    etcBtn.onclick = (e) => { handleTabClick(e); renderItems('etc'); };
                    tabContainer.appendChild(etcBtn);
                }
            };

            const handleTabClick = (e) => {
                const tabs = tabContainer.querySelectorAll('.cat-tab');
                tabs.forEach(t => t.classList.remove('active'));
                e.target.classList.add('active');
            };

            // ì•„ì´í…œ ë Œë”ë§ (ì´ë¯¸ì§€ ìµœì í™” ì ìš©ë¨)
            const renderItems = (filterCode) => {
                itemContainer.innerHTML = '';
                let filtered = (filterCode === 'etc') 
                    ? subCats.filter(sub => !sub.top_category_code)
                    : subCats.filter(sub => sub.top_category_code === filterCode);

                if (filtered.length === 0) {
                    itemContainer.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:20px; color:#999;">í•˜ìœ„ ë¶„ë¥˜ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }

                filtered.forEach(cat => {
                    const n = cat.name;
                    let rawUrl = cat.img_url || cat.image || cat.thumbnail || catThumbMap[cat.code] || '';
                    
                    // â˜… ì—¬ê¸°ì„œ ì´ë¯¸ì§€ ìš©ëŸ‰ì„ í™• ì¤„ì…ë‹ˆë‹¤ (100px)
                    const tinyUrl = window.getTinyThumb(rawUrl, 100);

                    const div = document.createElement('div');
                    div.className = 'quick-item';
                    
                    let imgTag = tinyUrl 
                        ? `<img src="${tinyUrl}" loading="lazy" style="width:100%; height:100%; object-fit:cover;" onerror="this.parentNode.innerHTML='<i class=\\'fa-solid fa-folder-open\\'></i>'">`
                        : `<i class="fa-solid fa-folder-open" style="font-size:24px; color:#cbd5e1;"></i>`;

                    div.innerHTML = `<div class="quick-icon" style="background:#fff; border:1px solid #f1f5f9; overflow:hidden; display:flex; align-items:center; justify-content:center;">${imgTag}</div><div class="quick-text">${n}</div>`;
                    div.onclick = () => window.showCategoryProducts(cat.code, cat.name);
                    itemContainer.appendChild(div);
                });
            };

            renderTabs();
            const allTab = tabContainer.querySelectorAll('.cat-tab')[0];
            if (allTab) allTab.click();

        } catch (err) {
            console.error("ì¹´í…Œê³ ë¦¬ ë¡œë”© ì‹¤íŒ¨:", err);
        }
    }
    // ============================================================
    // [3] ì œí’ˆ ì„ íƒ ëª¨ë‹¬ (ì„œë²„ ë³´í˜¸: í´ë¦­ ì‹œ ë¡œë”© & ìºì‹± ì ìš©)
    // ============================================================
    // â˜… ì „ì—­ ìºì‹œ ì €ì¥ì†Œ (í•œ ë²ˆ ë¶ˆëŸ¬ì˜¨ ì¹´í…Œê³ ë¦¬ëŠ” ì„œë²„ì— ë‹¤ì‹œ ìš”ì²­ ì•ˆ í•¨)
    window.categoryCache = {}; 

    window.showCategoryProducts = async function(catKey, catName) {
        const grid = document.getElementById('catProductGrid');
        const modal = document.getElementById('categoryDetailModal');
        const titleEl = document.getElementById('catModalTitle');
        
        if(titleEl) titleEl.innerHTML = `<span style="color:#6366f1;">${catName}</span>`;
        
        grid.style.gridTemplateColumns = "repeat(4, 1fr)"; 
        grid.style.gap = "12px";
        
        // ë¡œë”© í‘œì‹œ
        grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:40px;"><i class="fa-solid fa-spinner fa-spin"></i> ìƒí’ˆ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
        modal.style.display = 'flex';

        // 1. ìºì‹œ í™•ì¸ (ì´ë¯¸ ë¶ˆëŸ¬ì˜¨ ì  ìˆë‚˜?)
        let products = window.categoryCache[catKey];

        if (!products) {
            // 2. ì—†ìœ¼ë©´ ì„œë²„ í˜¸ì¶œ (í•„ìˆ˜ ë°ì´í„°ë§Œ)
            try {
                const { data, error } = await sb.from('admin_products')
                    .select('*') // í•„ìš”í•œ ê²½ìš° .select('code, name, price, img_url...')ë¡œ ë” ì¤„ì¼ ìˆ˜ ìˆìŒ
                    .eq('category', catKey)
                    .order('sort_order', { ascending: true });

                if (error) throw error;
                
                products = data;
                // 3. ìºì‹œì— ì €ì¥
                window.categoryCache[catKey] = data;

            } catch (e) {
                console.error("ìƒí’ˆ ë¡œë”© ì‹¤íŒ¨:", e);
                grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; color:red;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>';
                return;
            }
        }

        grid.innerHTML = '';
        if (!products || products.length === 0) {
            grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:20px; color:#999;">ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</div>';
            return;
        }

        let currencySymbol = 'ì›';
        if(CURRENT_LANG === 'jp') currencySymbol = 'Â¥';
        else if(CURRENT_LANG === 'us') currencySymbol = '$';

        products.forEach(p => {
            let displayName = p.name;
            let displayPrice = p.price;

            if (CURRENT_LANG === 'jp') {
                displayName = p.name_jp || p.name; 
                displayPrice = p.price_jp || p.price; 
            } else if (CURRENT_LANG === 'us') {
                displayName = p.name_us || p.name;
                displayPrice = p.price_us || p.price;
            }

            // â˜… ì¤‘ìš”: ë‚˜ì¤‘ì— ì—ë””í„°ì—ì„œ ì“¸ ìˆ˜ ìˆê²Œ ì „ì—­ DBì— ë“±ë¡
            if (!window.PRODUCT_DB) window.PRODUCT_DB = {};
            
            // mm -> px ë³€í™˜
            const scaleFactor = 3.7795;
            const pxW = Math.round((p.width_mm || 210) * scaleFactor);
            const pxH = Math.round((p.height_mm || 297) * scaleFactor);

            window.PRODUCT_DB[p.code] = {
                name: displayName, 
                w: pxW, h: pxH,
                w_mm: p.width_mm, h_mm: p.height_mm,
                price: displayPrice,
                img: p.img_url, 
                addons: p.addons ? p.addons.split(',') : [], 
                category: p.category
            };

            const div = document.createElement('div');
            div.className = 'quick-item'; 
            
            let imgHtml = '';
            if (p.img_url) {
                imgHtml = `
                    <div class="quick-icon-img-box">
                        <img src="${p.img_url}" alt="${displayName}" loading="lazy" onerror="this.style.display='none'; this.parentNode.innerHTML='<div class=\\'quick-icon\\'><i class=\\'fa-solid fa-cube\\'></i></div>';">
                    </div>
                `;
            } else {
                imgHtml = `<div class="quick-icon"><i class="fa-solid fa-cube"></i></div>`;
            }

            div.innerHTML = `
                ${imgHtml}
                <div class="quick-text">${displayName}</div>
                <div style="font-size:11px; color:#888; margin-top:3px;">
                    ${p.width_mm || '-'}x${p.height_mm || '-'} / ${currencySymbol}${displayPrice.toLocaleString()}
                </div>
            `;

            div.onclick = () => {
                modal.style.display = 'none'; 
                window.currentProductKey = p.code;
                window.selectedProductForChoice = window.PRODUCT_DB[p.code];

                if(window.showChoiceModal) window.showChoiceModal(p.code);
                else window.startEditorDirect(p.code);
            };
            grid.appendChild(div);
        });
    };
    // ============================================================
    // [4] ì‘ì—… ë°©ì‹ ì„ íƒ ëª¨ë‹¬ & íŒŒì¼ ì—…ë¡œë“œ
    // ============================================================
    window.showChoiceModal = function(key) {
        window.currentProductKey = key;
        window.selectedProductForChoice = window.PRODUCT_DB[key];
        if (!window.selectedProductForChoice) return alert("ìƒí’ˆ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        
        const nameEl = document.getElementById('choiceProdName');
        if(nameEl) nameEl.innerText = window.selectedProductForChoice.name;

        const imgEl = document.getElementById('choiceProductImg');
        if(imgEl) imgEl.src = window.selectedProductForChoice.img || 'https://placehold.co/400?text=No+Image';

        document.getElementById('choiceModal').style.display = 'flex';
    };

    window.confirmChoice = function(mode) {
        if (!window.selectedProductForChoice) return alert("ìƒí’ˆ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");

        if (mode === 'editor') {
            document.getElementById('choiceModal').style.display = 'none';
            window.startEditorDirect(window.selectedProductForChoice.key || window.currentProductKey);
        } else {
            const input = document.getElementById('directUploadInput');
            if(input) input.click();
        }
    };

    const directUploadInput = document.getElementById("directUploadInput");
    if (directUploadInput) {
        directUploadInput.onchange = async function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const product = window.selectedProductForChoice;
            if (!product) return alert("ìƒí’ˆ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");

            const loading = document.getElementById("loading");
            if (loading) loading.style.display = "flex";

            try {
                let thumbUrl = 'https://placehold.co/100?text=FILE';
                let fileDataURI = null;

                if (file.type === 'application/pdf') {
                    if (window.pdfjsLib && !window.pdfjsLib.GlobalWorkerOptions.workerSrc) {
                        window.pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
                    }
                    try {
                        const arrayBuffer = await file.arrayBuffer();
                        const pdf = await window.pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                        const page = await pdf.getPage(1);
                        const viewport = page.getViewport({ scale: 1 });
                        const scale = 150 / viewport.width;
                        const scaledViewport = page.getViewport({ scale });
                        const cvs = document.createElement('canvas');
                        const ctx = cvs.getContext('2d');
                        cvs.height = scaledViewport.height;
                        cvs.width = scaledViewport.width;
                        await page.render({ canvasContext: ctx, viewport: scaledViewport }).promise;
                        thumbUrl = cvs.toDataURL('image/jpeg', 0.8);
                    } catch (err) { console.warn("PDF Thumb Error:", err); }
                } else if (file.type.startsWith('image/')) {
                    fileDataURI = await new Promise(resolve => {
                        const reader = new FileReader();
                        reader.onload = (evt) => resolve(evt.target.result);
                        reader.readAsDataURL(file);
                    });
                    thumbUrl = fileDataURI;
                }

                if (!fileDataURI) {
                     fileDataURI = await new Promise(resolve => {
                        const reader = new FileReader();
                        reader.onload = (evt) => resolve(evt.target.result);
                        reader.readAsDataURL(file);
                    });
                }

                const newItem = {
                    uid: Date.now(),
                    product: product,
                    type: 'file',
                    fileName: file.name,
                    mimeType: file.type,
                    fileData: fileDataURI,
                    thumb: thumbUrl,
                    qty: 1,
                    selectedAddons: {},
                    isOpen: true
                };

                if (typeof cartData !== 'undefined') {
                    cartData.push(newItem);
                    try {
                        const user = typeof currentUser !== 'undefined' ? currentUser : null;
                        const storageKey = user ? `chameleon_cart_${user.id}` : 'chameleon_cart_guest';
                        localStorage.setItem(storageKey, JSON.stringify(cartData));
                    } catch(err) {}
                }

                if (window.renderCart) window.renderCart();
                document.getElementById('choiceModal').style.display = 'none';
                document.getElementById('cartPage').style.display = 'block';
                
            } catch (err) {
                console.error(err);
                alert("íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            } finally {
                if (loading) loading.style.display = "none";
                directUploadInput.value = ''; 
            }
        };
    }

    // ============================================================
    // [5] ì—ë””í„° ì‹œì‘ ë° í…œí”Œë¦¿ ë¡œë“œ
    // ============================================================
    // ============================================================
    // [5] ì—ë””í„° ì‹œì‘ ë° í…œí”Œë¦¿ ë¡œë“œ (ìˆ˜ì •ë¨: ë¡œê·¸ì¸ ì²´í¬ + í…œí”Œë¦¿ íŒì—…)
    // ============================================================
    window.startEditorDirect = async function(key) {
        // [1] ë¡œê·¸ì¸ ì²´í¬ ë¡œì§ ì¶”ê°€
        const { data } = await sb.auth.getSession();
        if (!data || !data.session || !data.session.user) {
            alert("ë””ìì¸ì„ ì‹œì‘í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            document.getElementById('loginModal').style.display = 'flex';
            return; // ë¡œê·¸ì¸ ì•ˆë˜ì–´ ìˆìœ¼ë©´ ì—ë””í„° ì§„ì… ì¤‘ë‹¨
        }

        if (!key) return alert("ìƒí’ˆ ì½”ë“œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");

        window.currentProductKey = key;
        if(canvas) canvas.currentProductKey = key;
        
        if (!window.PRODUCT_DB) window.PRODUCT_DB = {};
        
        const product = window.PRODUCT_DB[key];

        // â–¼â–¼â–¼ [ì¶”ê°€] ëŒ€í˜• ì¶œë ¥ë¬¼ ì„ íƒ ì‹œ í™”ì§ˆ ì•ˆë‚´ ë©”ì‹œì§€ â–¼â–¼â–¼
        if (product) {
            // ê°€ë¡œ/ì„¸ë¡œ ì¤‘ ê¸´ ìª½ í™•ì¸ (ë‹¨ìœ„: mm)
            const maxSide = Math.max(product.w_mm || 0, product.h_mm || 0, product.w || 0, product.h || 0);
            
            // A2 ì‚¬ì´ì¦ˆ(ì•½ 600mm) ì´ìƒì¸ ê²½ìš° ì•ˆë‚´ íŒì—…
            if (maxSide >= 800) {
                alert("ğŸ“¢ í¬ê¸°ê°€ í° ì œí’ˆì„ ì„ íƒí•˜ì…¨ë„¤ìš”\n\ní—ˆë‹ˆì½¤ê°€ë²½ì€ ë°±í„° íƒ¬í”Œë¦¿ìœ¼ë¡œ ì‘ì—…í•´ì•¼ ê¹¨ì§ì—†ì´ ê¹”ë”í•´ìš”\n\níŒ¨ë¸Œë¦­ ì œí’ˆì´ë‚˜ ë°°ë„ˆëŠ” ì´ë¯¸ì§€ë„ ê´œì°®ì•„ìš” ");
            }
        }
        // â–²â–²â–² [ì¶”ê°€ ë] â–²â–²â–²

        const displayW = product ? (product.w_mm || product.w || 210) : 210;
        const displayH = product ? (product.h_mm || product.h || 297) : 297;
        const canvasW = product ? (product.w || 210) : 210;
        const canvasH = product ? (product.h || 297) : 297;
        
        const mode = (typeof key === 'string' && key.includes('Wall')) ? 'wall' : 'standard';

        if (typeof setMaxLimits === 'function') setMaxLimits(displayW, displayH);
        
        const limitLabel = document.getElementById("limitLabel");
        if(limitLabel) limitLabel.innerText = `Max: ${displayW}x${displayH}`;
        
        const inpW = document.getElementById("inputUserW");
        const inpH = document.getElementById("inputUserH");
        if(inpW) inpW.value = displayW;
        if(inpH) inpH.value = displayH;

        if (window.applySize) window.applySize(canvasW, canvasH, key, mode, 'replace');
        
        // í™”ë©´ ì „í™˜
        document.getElementById("startScreen").style.display = "none";
        document.getElementById("mainEditor").style.display = "flex";

        const tplTabs = document.querySelector('.template-tabs');
        if(tplTabs) tplTabs.style.display = 'flex';

        document.body.classList.add('editor-active'); 

        if (window.ChannelIO) {
            ChannelIO('hide');
        }
    
        window.dispatchEvent(new Event('resize'));

        // â–¼â–¼â–¼ [ìˆ˜ì •] ì¹¼ì„ (ì œí’ˆ ê³ ì • ê°€ì´ë“œ) ë¡œë“œ ë° íŒì—… ì œì–´ ë¡œì§ â–¼â–¼â–¼
        let hasFixedGuide = false; // ê°€ì´ë“œ ì¡´ì¬ ì—¬ë¶€ í”Œë˜ê·¸

        try {
            // 1. ì œí’ˆ(key)ì— ì—°ê²°ëœ ê³ ì • í…œí”Œë¦¿(ê°€ì´ë“œ) ì¡°íšŒ
            // awaitë¥¼ ì‚¬ìš©í•˜ì—¬ DB ì‘ë‹µì´ ì˜¬ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
            const { data, error } = await sb.from('library')
                .select('data_url')
                .eq('product_key', key)
                .order('created_at', { ascending: false })
                .limit(1);

            if (data && data.length > 0) {
                // 2. ê°€ì´ë“œê°€ ìˆìœ¼ë©´ í”Œë˜ê·¸ë¥¼ Trueë¡œ ì„¤ì •
                hasFixedGuide = true;
                const templateUrl = data[0].data_url;
                
                console.log("ğŸ“¢ ê³ ì • ê°€ì´ë“œ ë°œê²¬! í…œí”Œë¦¿ íŒì—…ì„ ì°¨ë‹¨í•©ë‹ˆë‹¤.");

                // ê°€ì´ë“œ ë¡œë“œ (í™”ë©´ì— í‘œì‹œ)
                setTimeout(() => {
                    if (window.loadProductFixedTemplate) window.loadProductFixedTemplate(templateUrl);
                }, 500);
            }
        } catch(e) { 
            console.error("ìë™ ë¡œë“œ ì˜¤ë¥˜:", e); 
        }

        // 3. í…œí”Œë¦¿ ì ìš© ë¶„ê¸° ì²˜ë¦¬ (DB í™•ì¸ì´ ëë‚œ í›„ ì‹¤í–‰ë¨)
        if (window.pendingTemplate) {
            // [Case A] ì‹œì‘í™”ë©´ì—ì„œ ì´ë¯¸ í…œí”Œë¦¿ì„ ì„ íƒí•˜ê³  ë“¤ì–´ì˜¨ ê²½ìš°
            setTimeout(async () => {
                if (window.applyStartTemplate) await window.applyStartTemplate(window.pendingTemplate);
                window.pendingTemplate = null;
            }, 100);

        } else {
            // [Case B] ì•„ë¬´ê²ƒë„ ì„ íƒí•˜ì§€ ì•Šê³  ë“¤ì–´ì˜¨ ê²½ìš°
            // â˜… í•µì‹¬: ê°€ì´ë“œ(hasFixedGuide)ê°€ 'ì—†ì„ ë•Œë§Œ' íŒì—…ì„ ë„ì›€
            if (!hasFixedGuide) {
                setTimeout(() => {
                    const tplOverlay = document.getElementById('templateOverlay');
                    if (tplOverlay) {
                        tplOverlay.style.display = 'flex';
                        // ì—¬ê¸°ì„œ ê°•ì œë¡œ 'photo-bg'ë¥¼ ë„ìš°ë˜ ë¡œì§ì´ ê°€ì´ë“œê°€ ì—†ì„ ë•Œë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤.
                        if (window.filterTpl) window.filterTpl('photo-bg'); 
                    }
                }, 300);
            }
        }
        // â–²â–²â–² [ìˆ˜ì • ë] â–²â–²â–²

        if (window.pendingAiImage) {
            const loading = document.getElementById("loading");
            if(loading) loading.style.display = 'flex';

            fabric.Image.fromURL(window.pendingAiImage, (img) => {
                if (!img) return;
                const board = canvas.getObjects().find(o => o.isBoard);
                const cW = board ? board.width * board.scaleX : canvas.width;
                const cH = board ? board.height * board.scaleY : canvas.height;
                const cX = board ? board.left + cW / 2 : canvas.width / 2;
                const cY = board ? board.top + cH / 2 : canvas.height / 2;
                const scale = Math.min((cW * 0.8) / img.width, (cH * 0.8) / img.height);
                
                img.set({
                    scaleX: scale, scaleY: scale, left: cX, top: cY,
                    originX: 'center', originY: 'center'
                });
                canvas.add(img);
                canvas.setActiveObject(img);
                canvas.requestRenderAll();
                window.pendingAiImage = null;
                if(loading) loading.style.display = 'none';
            }, { crossOrigin: 'anonymous' });
        }
    };

    window.onTemplateClick = async function(tpl) {
        const startScreen = document.getElementById('startScreen');
        const isEditorOpen = startScreen && window.getComputedStyle(startScreen).display === 'none';

        if (isEditorOpen) {
            if(!confirm("í˜„ì¬ ìº”ë²„ìŠ¤ì— í…œí”Œë¦¿ì„ ì ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ê¸°ì¡´ ë””ìì¸ ìœ„ì— ì¶”ê°€ë©ë‹ˆë‹¤)")) return;
            await applyTemplateDirectly(tpl);
        } else {
            window.pendingTemplate = tpl; 
            showCategorySelectionModal(); 
        }
    };

    // â–¼â–¼â–¼ [3ë‹¨ê³„ ì ìš©] ìˆ˜ì •ëœ showCategorySelectionModal í•¨ìˆ˜
    // â–¼â–¼â–¼ [ìˆ˜ì •] ì¹´í…Œê³ ë¦¬ ì´ë¯¸ì§€ê°€ ì—†ì„ ë•Œ ìƒí’ˆ ì´ë¯¸ì§€ë¡œ ëŒ€ì²´í•˜ëŠ” ë¡œì§ ì¶”ê°€ â–¼â–¼â–¼
    window.showCategorySelectionModal = async function() {
        const modal = document.getElementById('categoryDetailModal');
        const grid = document.getElementById('catProductGrid');
        const titleEl = document.getElementById('catModalTitle');
        const descEl = modal.querySelector('p');

        // 1. í…ìŠ¤íŠ¸ ì„¤ì • (ë²ˆì—­ ì ìš©)
        const t = window.translations || {};
        const titleText = t['modal_size_select_title'] || "Q. ë¬´ì—‡ì„ ë§Œë“¤ê¹Œìš”?";
        const subText = t['modal_size_select_sub'] || "(ì‚¬ì´ì¦ˆ ì„ íƒ)";
        const descText = t['modal_size_select_desc'] || "ì›í•˜ì‹œëŠ” ê·œê²©ì„ ì„ íƒí•˜ì‹œë©´ ë””ìì¸ì´ ì‹œì‘ë©ë‹ˆë‹¤.";
        const loadingMsg = t['msg_loading'] || "ë¡œë”© ì¤‘...";

        if(titleEl) titleEl.innerHTML = `<span style="color:#6366f1;">${titleText}</span> <span style="font-size:14px; color:#888; font-weight:normal;">${subText}</span>`;
        if(descEl) descEl.innerText = descText;
        
        modal.style.display = 'flex';
        grid.innerHTML = `<div style="grid-column:1/-1; text-align:center;">${loadingMsg}</div>`;
        
        try {
            // 2. ì¹´í…Œê³ ë¦¬ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
            const { data: categories, error } = await sb.from('admin_categories')
                .select('*').order('sort_order', { ascending: true });

            if (!categories || categories.length === 0) {
                grid.innerHTML = '<div style="grid-column:1/-1; text-align:center;">No Categories</div>';
                return;
            }

            // 3. â˜… [ì¶”ê°€ë¨] ìƒí’ˆ ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸° (ì´ë¯¸ì§€ê°€ ìˆëŠ” ìƒí’ˆë§Œ)
            const { data: prodImages } = await sb.from('admin_products')
                .select('category, img_url')
                .not('img_url', 'is', null)
                .neq('img_url', '');

            // ì¹´í…Œê³ ë¦¬ ì½”ë“œë³„ë¡œ ì²« ë²ˆì§¸ ìƒí’ˆ ì´ë¯¸ì§€ë¥¼ ë§¤í•‘ (Dictionary ë§Œë“¤ê¸°)
            const catThumbMap = {};
            if (prodImages) {
                prodImages.forEach(p => {
                    // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì— ì•„ì§ ì´ë¯¸ì§€ê°€ ë“±ë¡ ì•ˆ ë˜ì—ˆìœ¼ë©´, ì´ ìƒí’ˆì˜ ì´ë¯¸ì§€ë¥¼ ëŒ€í‘œë¡œ ì„¤ì •
                    if (p.category && !catThumbMap[p.category]) {
                        catThumbMap[p.category] = p.img_url;
                    }
                });
            }

            grid.innerHTML = ''; // ë¡œë”© ë©”ì‹œì§€ ì§€ìš°ê¸°

            // 4. ê·¸ë¦¬ë“œ ìƒì„±
            categories.forEach(cat => {
                // [ì´ë¯¸ì§€ ê²°ì • ìš°ì„ ìˆœìœ„]
                // 1ìˆœìœ„: ì¹´í…Œê³ ë¦¬ ìì²´ì— ë“±ë¡ëœ ì´ë¯¸ì§€
                // 2ìˆœìœ„: í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì— ì†í•œ ì²« ë²ˆì§¸ ìƒí’ˆì˜ ì´ë¯¸ì§€ (catThumbMap)
                // 3ìˆœìœ„: ì—†ìŒ
                let iconUrl = cat.img_url || cat.image || cat.thumbnail || catThumbMap[cat.code] || '';
                
                const div = document.createElement('div');
                div.className = 'quick-item';

                let imgTag = '';
                if (iconUrl) {
                    imgTag = `<img src="${iconUrl}" style="width:100%; height:100%; object-fit:cover; border-radius:12px;" onerror="this.style.display='none'; this.parentNode.innerText='No Img'; this.parentNode.style.background='#f1f5f9'; this.parentNode.style.display='flex'; this.parentNode.style.alignItems='center'; this.parentNode.style.justifyContent='center'; this.parentNode.style.color='#ccc';">`;
                } else {
                    imgTag = `<div style="width:100%; height:100%; background:#f1f5f9; border-radius:12px; display:flex; align-items:center; justify-content:center; color:#ccc; font-size:12px;">No Img</div>`;
                }

                div.innerHTML = `
                    <div class="quick-icon" style="background:#fff; border:1px solid #f1f5f9; padding:0; overflow:hidden;">
                        ${imgTag}
                    </div>
                    <div class="quick-text">${cat.name}</div>
                `;
                
                div.onclick = () => window.showCategoryProducts(cat.code, cat.name);
                grid.appendChild(div);
            });

        } catch (e) {
            console.error("ì¹´í…Œê³ ë¦¬ ë¡œë”© ì‹¤íŒ¨:", e);
            grid.innerHTML = '<div style="grid-column:1/-1; text-align:center;">Error loading categories</div>';
        }
    };

    // (ì‚­ì œë¨: applyTemplateDirectly í•¨ìˆ˜ëŠ” canvas-template.jsì˜ applyStartTemplateìœ¼ë¡œ ëŒ€ì²´ë˜ì—ˆìŠµë‹ˆë‹¤.)

    

    function finishLoading() {
        document.getElementById("loading").style.display = "none";
        document.getElementById('templateOverlay').style.display = 'none';
    }


    // ============================================================
    // [1] ì´ˆê¸°í™” ë° ë°ì´í„° ë¡œë“œ (ì•ˆì •í™” ìµœì¢… ë²„ì „)
    // ============================================================
    window.addEventListener('load', async () => {
        // 1. ì„¤ì • ë¡œë”© ëŒ€ê¸° (config.jsì˜ ì‘ì—…ì´ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼)
        if (window.initConfig) await window.initConfig(); 
        else if (typeof initConfig === 'function') await initConfig();

        // 2. ì¹´í…Œê³ ë¦¬ ë©”ë‰´ ë Œë”ë§
        if (typeof renderQuickMenu === 'function') renderQuickMenu();
        
        // 3. í…œí”Œë¦¿ ë° ìƒí’ˆ ë¡œë“œ
        if(window.searchTemplates) window.searchTemplates('');
        if (window.preloadLanguageFont) window.preloadLanguageFont();
        if (typeof loadSpecialProducts === 'function') {
            loadSpecialProducts('hotDealSection', 'hotDealGrid', 'hotdeal', 6);
            loadSpecialProducts('bizDealSection', 'bizDealGrid', '23432424', 6);
        }

        // 4. ë¡œê·¸ì¸ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ (config.js ì™„ë£Œ í›„ ì‹¤í–‰ë˜ë¯€ë¡œ ì•ˆì „í•¨)
        const btnLogin = document.getElementById('btnLoginBtn');
        const btnConsole = document.getElementById('btnPartnerConsole');
        
        // config.jsì—ì„œ ì„¤ì •ëœ currentUser ë³€ìˆ˜ ì‚¬ìš©
        if (window.currentUser) {
            console.log("âœ… ë¡œê·¸ì¸ ë¨:", window.currentUser.email);
            if (btnLogin) {
                btnLogin.innerText = "ë¡œê·¸ì•„ì›ƒ";
                btnLogin.style.fontWeight = "bold"; 
                btnLogin.style.color = "#ef4444"; 
                btnLogin.onclick = async function() {
                    if (confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                        await sb.auth.signOut();
                        localStorage.removeItem('sb-qinvtnhiidtmrzosyvys-auth-token'); 
                        window.location.reload(); 
                    }
                };
            }
            if(btnConsole) btnConsole.style.removeProperty('display');
        } else {
            if (btnLogin) {
                btnLogin.innerText = "ë¡œê·¸ì¸";
                btnLogin.onclick = () => document.getElementById('loginModal').style.display = 'flex';
            }
            if(btnConsole) btnConsole.style.setProperty('display', 'none', 'important');
        }

        // 5. ê²€ìƒ‰ì°½ ì—°ê²°
        const searchBtn = document.getElementById('btnStartSearch');
        const searchInput = document.getElementById('startSearchInput');
        if (searchBtn && searchInput) {
            const doSearch = () => { if(window.searchTemplates) window.searchTemplates(searchInput.value); };
            searchBtn.onclick = doSearch;
            searchInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') doSearch(); });
        }
    });


// ==========================================
    // [1] í…œí”Œë¦¿ í˜ì´ì§• ì‹œìŠ¤í…œ (28ê°œì”© ë³´ê¸°) - ìˆ˜ì •ë¨
    // ==========================================

    const ITEMS_PER_PAGE = 20; // í•œ í˜ì´ì§€ë‹¹ 28ê°œ
    let currentTemplatePage = 0;
    let lastSearchKeyword = '';

    // 1. ê²€ìƒ‰ ì‹œì‘ (ì´ˆê¸°í™”)
    window.searchTemplates = function(keyword = '') {
        lastSearchKeyword = keyword;
        currentTemplatePage = 0; // 1í˜ì´ì§€ë¡œ ë¦¬ì…‹
        loadTemplatePage(0);
    };

    // 2. í˜ì´ì§€ ë³€ê²½ ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰ (HTMLì˜ onclickê³¼ ì—°ê²°ë¨)
    window.changeTemplatePage = function(delta) {
        const newPage = currentTemplatePage + delta;
        if (newPage < 0) return; // 0í˜ì´ì§€ ë¯¸ë§Œ ë°©ì§€
        loadTemplatePage(newPage);
    };

    // 3. ë°ì´í„° ë¡œë“œ ë° ê·¸ë¦¬ê¸° (í•µì‹¬ í•¨ìˆ˜)
    async function loadTemplatePage(page) {
        const grid = document.getElementById('startTemplateGrid');
        if (!grid) return;

        // ë¡œë”© í‘œì‹œ
        grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:60px; color:#888;"><i class="fa-solid fa-spinner fa-spin fa-2x"></i><br><br>ë¡œë”© ì¤‘...</div>';
        
        try {
            // DB ì¿¼ë¦¬ ì¤€ë¹„
            let query = sb.from('library')
                .select('id, thumb_url, category, tags', { count: 'exact' }) // ì „ì²´ ê°œìˆ˜ë„ ê°™ì´ ê°€ì ¸ì˜´
                .order('created_at', { ascending: false })
                .range(page * ITEMS_PER_PAGE, (page + 1) * ITEMS_PER_PAGE - 1); // ë²”ìœ„ ì„¤ì •

            // ê²€ìƒ‰ì–´ í•„í„° (íƒœê·¸ ê²€ìƒ‰)
            if (lastSearchKeyword && lastSearchKeyword.trim() !== '') {
                query = query.ilike('tags', `%${lastSearchKeyword}%`);
            }

            const { data, error, count } = await query;

            if (error) throw error;

            grid.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì§€ìš°ê¸°

            // ë°ì´í„°ê°€ ì—†ì„ ë•Œ
            if (!data || data.length === 0) {
                grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:60px; color:#999;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                updatePaginationButtons(page, 0);
                return;
            }

            // [ìˆ˜ì •] ì¹´ë“œ ìƒì„± (ì •ì‚¬ê°í˜• í”„ë ˆì„ + ëª¨ë“  ë±ƒì§€ í‘œì‹œ)
            data.forEach(tpl => {
                const card = document.createElement('div');
                card.className = 'tpl-card-start'; 
                
                // 1. ì¹´í…Œê³ ë¦¬ë³„ ë±ƒì§€ ì„¤ì • (ëª¨ë“  ì¢…ë¥˜ ì¶”ê°€)
                let badgeText = '';
                let badgeColor = '#64748b'; // ê¸°ë³¸ íšŒìƒ‰

                switch (tpl.category) {
                    case 'user_vector': badgeText = 'User Vector'; badgeColor = '#7c3aed'; break; // ë³´ë¼ìƒ‰
                    case 'user_image':  badgeText = 'User Image'; badgeColor = '#059669'; break;  // ì´ˆë¡ìƒ‰
                    case 'vector':      badgeText = 'Vector'; badgeColor = '#7c3aed'; break;
                    case 'photo-bg':    badgeText = 'Image'; badgeColor = '#059669'; break;
                    case 'graphic':     badgeText = 'Graphic'; badgeColor = '#2563eb'; break; // íŒŒë€ìƒ‰
                    case 'pattern':
                    case 'transparent-graphic': badgeText = 'Pattern'; badgeColor = '#db2777'; break; // í•‘í¬ìƒ‰
                    case 'logo':        badgeText = 'Logo'; badgeColor = '#d97706'; break; // ì£¼í™©ìƒ‰
                    case 'text':        badgeText = 'Text'; badgeColor = '#475569'; break;
                }

                // ë±ƒì§€ HTML ìƒì„±
                let badgeHtml = '';
                if (badgeText) {
                    badgeHtml = `<span style="position:absolute; top:10px; left:10px; background:${badgeColor}; color:white; font-size:10px; font-weight:800; padding:4px 8px; border-radius:6px; z-index:5; box-shadow:0 2px 4px rgba(0,0,0,0.2); text-transform:uppercase; letter-spacing:0.5px;">${badgeText}</span>`;
                }

                // 2. ì´ë¯¸ì§€ ìµœì í™” (ì •ì‚¬ê°í˜• 1:1 ë¹„ìœ¨ ìš”ì²­)
                let imgSrc = tpl.thumb_url || 'https://via.placeholder.com/300';
                if (imgSrc.includes('supabase.co')) {
                    const separator = imgSrc.includes('?') ? '&' : '?';
                    // widthì™€ heightë¥¼ ë˜‘ê°™ì´ ì„¤ì •í•˜ê³  resize=cover ì˜µì…˜ì„ ì£¼ì–´ ì •ì‚¬ê°í˜•ìœ¼ë¡œ ìë¦„
                    imgSrc += `${separator}width=400&height=400&resize=cover&format=webp&quality=70`;
                }

                // 3. HTML êµ¬ì„± ë° ìŠ¤íƒ€ì¼ ê°•ì œ ì ìš©
                // aspect-ratio: 1/1 ì„ ì£¼ì–´ ê°•ì œë¡œ ì •ì‚¬ê°í˜•ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤.
                card.style.cssText = "aspect-ratio: 1/1; position: relative; overflow: hidden; border-radius: 16px; border: 1px solid #e5e7eb; background: #f8fafc;";
                
                card.innerHTML = `
                    ${badgeHtml}
                    <img src="${imgSrc}" class="tpl-card-img" loading="lazy" style="width:100%; height:100%; object-fit:cover; display:block;">
                    <div class="tpl-card-overlay"></div>
                `;
                
                card.onclick = () => { 
                    if(window.onTemplateClick) window.onTemplateClick(tpl); 
                };
                
                grid.appendChild(card);
            });

            // í˜„ì¬ í˜ì´ì§€ ë²ˆí˜¸ ì—…ë°ì´íŠ¸ ë° ë²„íŠ¼ ìƒíƒœ ê´€ë¦¬
            currentTemplatePage = page;
            updatePaginationButtons(page, data.length);

        } catch (e) {
            console.error("í…œí”Œë¦¿ ë¡œë“œ ì˜¤ë¥˜:", e);
            grid.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:40px;">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>';
        }
    }

    // 4. ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™” ë° í˜ì´ì§€ ë²ˆí˜¸ í‘œì‹œ
    function updatePaginationButtons(page, currentItemsCount) {
        const btnPrev = document.getElementById('btnTplPrev');
        const btnNext = document.getElementById('btnTplNext');
        const lblPage = document.getElementById('tplPageLabel');

        if(lblPage) lblPage.innerText = `${page + 1} í˜ì´ì§€`;

        // ì²« í˜ì´ì§€ë©´ 'ì´ì „' ë²„íŠ¼ ë¹„í™œì„±í™”
        if(btnPrev) {
            btnPrev.disabled = (page === 0);
            btnPrev.style.opacity = (page === 0) ? '0.5' : '1';
            btnPrev.style.cursor = (page === 0) ? 'default' : 'pointer';
        }

        // ê°€ì ¸ì˜¨ ë°ì´í„°ê°€ ì„¤ì • ê°œìˆ˜(28ê°œ)ë³´ë‹¤ ì ìœ¼ë©´ 'ë‹¤ìŒ' ë²„íŠ¼ ë¹„í™œì„±í™” (ë§ˆì§€ë§‰ í˜ì´ì§€)
        if(btnNext) {
            const isLastPage = currentItemsCount < ITEMS_PER_PAGE;
            btnNext.disabled = isLastPage;
            btnNext.style.opacity = isLastPage ? '0.5' : '1';
            btnNext.style.cursor = isLastPage ? 'default' : 'pointer';
        }
    }

    // PDF í°íŠ¸ ì„¤ì • (í°íŠ¸ ê¹¨ì§ ë°©ì§€)
    window.pdfFontCache = null;
    window.pdfFontName = 'NanumGothic'; // ê¸°ë³¸

    window.preloadLanguageFont = async function() { 
        try { 
            let fontUrl = '';
            if (CURRENT_LANG === 'jp') {
                fontUrl = 'https://cdn.jsdelivr.net/gh/google/fonts@main/ofl/nanumgothic/NanumGothic-Regular.ttf'; 
            } else {
                fontUrl = 'https://cdn.jsdelivr.net/gh/google/fonts@main/ofl/nanumgothic/NanumGothic-Regular.ttf';
            }

            const r = await fetch(fontUrl); 
            if(r.ok) { 
                const b = await r.blob(); 
                const rd = new FileReader(); 
                rd.onloadend = function() { 
                    window.pdfFontCache = rd.result.split(',')[1]; 
                }; 
                rd.readAsDataURL(b); 
            } 
        } catch(e) { console.error("Font Load Error:", e); } 
    };

    window.loadKoreanFontForPDF = async function(doc) { 
        if(window.pdfFontCache) { 
            try { 
                const fileName = window.pdfFontName + '.ttf';
                doc.addFileToVFS(fileName, window.pdfFontCache); 
                doc.addFont(fileName, window.pdfFontName, 'normal'); 
                doc.setFont(window.pdfFontName); 
            } catch(e) { console.warn(e); } 
        } 
    };

    // ê¸°íƒ€ ìœ í‹¸
    window.toggleLockSelection = function() { if(!canvas)return; const a=canvas.getActiveObject(); if(!a)return alert("ì„ íƒí•„ìš”"); const l=!a.lockMovementX; a.set({lockMovementX:l,lockMovementY:l,lockRotation:l,lockScalingX:l,lockScalingY:l,hasControls:!l,selectable:true}); canvas.discardActiveObject(); canvas.requestRenderAll(); };
    window.setAsBackground = function() { 
    if(!canvas) return; 
    
    const a = canvas.getActiveObject(); 
    if(!a) return alert("ë°°ê²½ìœ¼ë¡œ ë§Œë“¤ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."); 
    
    const b = canvas.getObjects().find(o => o.isBoard); 
    if(!b) return; 

    // 1.1ë°°(10%) ë” í¬ê²Œ í‚¤ìš°ê¸° ê³„ì‚°
    const scaleX = (b.width * b.scaleX) / a.width;
    const scaleY = (b.height * b.scaleY) / a.height;
    const s = Math.max(scaleX, scaleY) * 1.15; 

    // ì†ì„± ë³€ê²½
    a.set({
        scaleX: s,
        scaleY: s,
        left: b.left + (b.width * b.scaleX) / 2,
        top: b.top + (b.height * b.scaleY) / 2,
        originX: 'center',
        originY: 'center',
        angle: 0
    }); 
    
    // â˜… [í•µì‹¬ ìˆ˜ì •] ì¢Œí‘œ ê°•ì œ ì—…ë°ì´íŠ¸ (ì´ê²Œ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë‚©ë‹ˆë‹¤!)
    a.setCoords(); 
    
    canvas.sendToBack(a); 
    canvas.sendToBack(b); // ëŒ€ì§€ëŠ” í•­ìƒ ë§¨ ë’¤ë¡œ
    canvas.requestRenderAll(); 
};
    window.alignObject = function(d) { if(!canvas)return; const a=canvas.getActiveObject(); if(!a)return; const b=canvas.getObjects().find(o=>o.isBoard); const r=b?b.getBoundingRect():{left:0,top:0,width:canvas.width,height:canvas.height}; const w=a.getScaledWidth(); const h=a.getScaledHeight(); if(d=='left') a.left=r.left+w/2; if(d=='centerH') a.left=r.left+r.width/2; if(d=='right') a.left=r.left+r.width-w/2; if(d=='top') a.top=r.top+h/2; if(d=='centerV') a.top=r.top+r.height/2; if(d=='bottom') a.top=r.top+r.height-h/2; if(d=='center') { a.left=r.left+r.width/2; a.top=r.top+r.height/2; } a.setCoords(); canvas.requestRenderAll(); };

    if (window.pdfjsLib) window.pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
</script>
</script>
<script>
    document.addEventListener('click', function(e) {
        const card = e.target.closest('.size-card');
        if (card) {
            const onclickCode = card.getAttribute('onclick');
            if (onclickCode) {
                try { eval(onclickCode); } catch(err) { console.error("íŒí˜• í´ë¦­ ì˜¤ë¥˜:", err); }
            }
        }
    });
    
    window.closeSuccessModal = function() {
        const modal = document.getElementById('successModal');
        if (modal) {
            modal.style.display = 'none';
        }
    };

    document.addEventListener('DOMContentLoaded', () => {
        const confirmBtn = document.querySelector('#successModal .btn-round.primary');
        if(confirmBtn) {
            confirmBtn.onclick = window.closeSuccessModal;
        }
    });
    
    // ì…ë ¥ì°½ ì˜¤ë¥˜ í•´ê²°
    window.addEventListener('keydown', function(e) {
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
            if (e.code === 'Space' || e.key === ' ') {
                e.stopPropagation(); 
            }
        }
    }, true);
</script>
<script src="https://js.tosspayments.com/v1"></script>
<script src="https://js.stripe.com/v3/"></script>
<button id="btnPayTest" style="display:none; position:fixed; bottom:20px; right:20px; z-index:999999;">ê²°ì œí…ŒìŠ¤íŠ¸</button>
<script>
  (function(){var w=window;if(w.ChannelIO){return w.console.error("ChannelIO script included twice.");}var ch=function(){ch.c(arguments);};ch.q=[];ch.c=function(args){ch.q.push(args);};w.ChannelIO=ch;function l(){if(w.ChannelIOInitialized){return;}w.ChannelIOInitialized=true;var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src="https://cdn.channel.io/plugin/ch-plugin-web.js";var x=document.getElementsByTagName("script")[0];if(x.parentNode){x.parentNode.insertBefore(s,x);}}if(document.readyState==="complete"){l();}else{w.addEventListener("DOMContentLoaded",l);w.addEventListener("load",l);}})();
  ChannelIO('boot', { "pluginKey": "752ba9ff-a447-4e10-9813-715e051995cd" });
</script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-11349651713"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'AW-11349651713');
</script>
<!-- Event snippet for Google Shopping App Add To Cart conversion page -->
<script>
  gtag('event', 'conversion', {
      'send_to': 'AW-11349651713/P7AtCKeNgfYaEIHi96Mq',
      'value': 1.0,
      'currency': 'KRW'
  });

  // [ì„ íƒëœ ë””ìì¸ ë°°ê²½ ë§Œë“¤ê¸° - 10% í™•ëŒ€ + ì˜¤ë¥˜ ìˆ˜ì • ë²„ì „]

</script>

<div id="reviewWriteModal" class="modal-bg" style="z-index: 17000; display: none; align-items: center; justify-content: center;">
    <div class="modal-box" style="width: 400px; text-align: center;">
        <h3 style="margin-top: 0;">ğŸ ìƒí’ˆì€ ë§ˆìŒì— ë“œì…¨ë‚˜ìš”?</h3>
        <p style="color: #666; font-size: 14px; margin-bottom: 20px;">êµ¬ë§¤ë¥¼ í™•ì •í•˜ê³  ì†Œì¤‘í•œ í›„ê¸°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”.<br>(ê°€ë§¹ì ì—ê²Œ í° í˜ì´ ë©ë‹ˆë‹¤!)</p>

        <div style="margin-bottom: 20px;">
            <div id="starContainer" style="font-size: 32px; color: #ddd; cursor: pointer;">
                <i class="fa-solid fa-star" onclick="setReviewRating(1)" id="star1"></i>
                <i class="fa-solid fa-star" onclick="setReviewRating(2)" id="star2"></i>
                <i class="fa-solid fa-star" onclick="setReviewRating(3)" id="star3"></i>
                <i class="fa-solid fa-star" onclick="setReviewRating(4)" id="star4"></i>
                <i class="fa-solid fa-star" onclick="setReviewRating(5)" id="star5"></i>
            </div>
            <div id="ratingText" style="font-weight: bold; color: #6366f1; margin-top: 5px;">5ì </div>
        </div>

        <textarea id="reviewCommentInput" class="ai-input-pretty" placeholder="í›„ê¸°ë¥¼ ê°„ë‹¨íˆ ë‚¨ê²¨ì£¼ì„¸ìš” (ì„ íƒì‚¬í•­)" style="height: 80px;"></textarea>
        
        <input type="hidden" id="targetReviewOrderId">
        <input type="hidden" id="targetReviewScore" value="5">

        <button onclick="submitOrderReview()" class="btn-round primary" style="width: 100%; margin-top: 10px;">
            í™•ì¸ ë° ì •ì‚°ì§€ê¸‰ ìŠ¹ì¸
        </button>
        <button onclick="document.getElementById('reviewWriteModal').style.display='none'" class="btn-round" style="margin-top: 5px; border: none; color: #888;">
            ë‚˜ì¤‘ì— í•˜ê¸°
        </button>
    </div>
</div>
<div id="withdrawModal" class="modal-bg" style="z-index: 25000; display: none; align-items: center; justify-content: center;">
    <div class="modal-box" style="width: 500px; text-align: left;">
        <h3 style="margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 15px;">ğŸ’¸ ì •ì‚° ì¶œê¸ˆ ì‹ ì²­</h3>
        
        <div style="background: #f0f9ff; border: 1px solid #bae6fd; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 13px; color: #0369a1; line-height: 1.6;">
            <strong>[ì„¸ê¸ˆê³„ì‚°ì„œ ë°œí–‰ ì •ë³´]</strong><br>
            ì•„ë˜ ì •ë³´ë¡œ ì„¸ê¸ˆê³„ì‚°ì„œë¥¼ ë°œí–‰í•˜ì—¬ ì²¨ë¶€í•´ì£¼ì„¸ìš”.<br><br>
            ìƒí˜¸ : <strong>(ì£¼)ì¹´ë©œë ˆì˜¨í”„ë¦°íŒ…</strong> (ëŒ€í‘œ: ì¡°ì¬í˜¸)<br>
            ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ : <strong>470-81-02808</strong><br>
            ì£¼ì†Œ : ê²½ê¸°ë„ í™”ì„±ì‹œ ìš°ì •ì í•œë§ê¸¸ 72-2<br>
            ì´ë©”ì¼ : korea900as@gmail.com
        </div>

        <div style="margin-bottom: 15px;">
            <label style="font-weight: bold; font-size: 12px; display: block; margin-bottom: 5px;">ì¶œê¸ˆ ìš”ì²­ ê¸ˆì•¡ (ìˆ˜ìˆ˜ë£Œ ê³µì œ í›„)</label>
            <input id="wdAmount" class="ai-input-pretty" readonly style="background: #f8fafc; font-weight: 800; color: #6366f1; font-size: 18px;">
            <div style="font-size: 11px; color: #64748b; margin-top: 5px; line-height: 1.4;">
                * ê³µì œ ë‚´ì—­ (ì´ 20%): ë¶€ê°€ì„¸(10%) + ì¹´ë“œìˆ˜ìˆ˜ë£Œ(3.5%) + ê°€ë§¹ìˆ˜ìˆ˜ë£Œ(6.5%)<br>
                * ì‹¤ì œ ì…ê¸ˆì€ ì‹ ì²­ì¼ë¡œë¶€í„° <strong>ì˜ì—…ì¼ ê¸°ì¤€ 5ì¼ ì´ë‚´</strong> ì²˜ë¦¬ë©ë‹ˆë‹¤.
            </div>
        </div>

        <div style="margin-bottom: 15px;">
            <label style="font-weight: bold; font-size: 12px; display: block; margin-bottom: 5px;">ì…ê¸ˆë°›ì„ ê³„ì¢Œ ì •ë³´</label>
            <input id="wdBankInfo" class="ai-input-pretty" placeholder="ì€í–‰ëª… / ê³„ì¢Œë²ˆí˜¸ / ì˜ˆê¸ˆì£¼ ì…ë ¥">
        </div>

        <div style="margin-bottom: 20px;">
            <label style="font-weight: bold; font-size: 12px; display: block; margin-bottom: 5px;">ì„¸ê¸ˆê³„ì‚°ì„œ ì²¨ë¶€ (í•„ìˆ˜)</label>
            <div style="display: flex; gap: 10px;">
                <input type="file" id="wdTaxFile" class="ai-input-pretty" accept=".pdf,.jpg,.png" style="padding: 8px;">
            </div>
        </div>

        <div style="display: flex; gap: 10px;">
            <button onclick="submitWithdrawal()" class="btn-round primary" style="flex: 1;">ì‹ ì²­í•˜ê¸°</button>
            <button onclick="document.getElementById('withdrawModal').style.display='none'" class="btn-round" style="flex: 1;">ì·¨ì†Œ</button>
        </div>
    </div>
</div>

<audio id="orderAlertSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

<div id="contributorUploadModal" class="modal-bg" style="display: none; z-index: 20000; align-items: center; justify-content: center;">
    <div class="modal-box" style="width: 500px; max-width: 95%;">
        <h3 id="cUploadTitle" style="margin-top:0;">ğŸ“¤ ì—…ë¡œë“œ</h3>
        
        <div style="margin-bottom: 15px;">
            <label class="form-label" style="font-weight:bold; display:block; margin-bottom:5px;">ê²€ìƒ‰ í‚¤ì›Œë“œ (íƒœê·¸)</label>
            <input type="text" id="cUploadTags" class="ai-input-pretty" placeholder="íŒŒì¼ì„ ì„ íƒí•˜ë©´ ìë™ ì…ë ¥ë©ë‹ˆë‹¤.">
        </div>

        <div id="cUploadSvgArea" style="display:none; gap:10px; margin-bottom:15px;">
            <div style="flex:1;">
                <label class="form-label" style="font-size:12px; font-weight:bold;">1. ì¸ë„¤ì¼ (JPG/PNG)</label>
                <input type="file" id="cFileThumb" class="ai-input-pretty" accept="image/png, image/jpeg" style="padding:5px;" onchange="window.autoFillTags(this)">
            </div>
            <div style="flex:1;">
                <label class="form-label" style="font-size:12px; font-weight:bold;">2. SVG ì›ë³¸</label>
                <input type="file" id="cFileSvg" class="ai-input-pretty" accept=".svg" style="padding:5px;">
            </div>
        </div>

        <div id="cUploadSimpleArea" style="margin-bottom:15px;">
            <label class="form-label" style="font-weight:bold; display:block; margin-bottom:5px;">íŒŒì¼ ì„ íƒ</label>
            <input type="file" id="cFileSimple" class="ai-input-pretty" accept="image/png, image/jpeg" multiple style="padding:5px;" onchange="window.autoFillTags(this)">
            <p style="font-size:11px; color:#666; margin-top:5px;">* ë°°ê²½ì´ íˆ¬ëª…í•œ PNG íŒŒì¼ì„ ê¶Œì¥í•©ë‹ˆë‹¤.</p>
        </div>

        <div style="display:flex; gap:10px; margin-top:20px;">
            <button onclick="window.submitContributorUpload()" class="btn-round primary" style="flex:1;">ì—…ë¡œë“œ ë° ì ë¦½ë°›ê¸°</button>
            <button onclick="document.getElementById('contributorUploadModal').style.display='none'" class="btn-round" style="flex:1; background:#f1f5f9; color:#333;">ì·¨ì†Œ</button>
        </div>
    </div>
</div>

</body>
</html>