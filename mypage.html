<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë§ˆì´ ìŠ¤íŠœë””ì˜¤ | ì¹´ë©œë ˆì˜¨</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>
    <style>
        /* ë§ˆì´í˜ì´ì§€ ì „ìš© ë ˆì´ì•„ì›ƒ (style.cssì— ì¶”ê°€í•´ë„ ë¨) */
        body.mypage-body { background: #f8fafc; display: flex; height: 100vh; overflow: hidden; }
        .mp-sidebar { width: 250px; background: white; border-right: 1px solid #e2e8f0; display: flex; flex-direction: column; padding: 20px; }
        .mp-logo { font-size: 20px; font-weight: 800; color: #6366f1; margin-bottom: 40px; cursor: pointer; }
        .mp-nav-item { padding: 12px 15px; margin-bottom: 5px; border-radius: 8px; color: #64748b; font-weight: 600; cursor: pointer; transition: 0.2s; }
        .mp-nav-item:hover, .mp-nav-item.active { background: #eff6ff; color: #6366f1; }
        
        .mp-main { flex: 1; padding: 40px; overflow-y: auto; }
        .mp-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .mp-welcome h1 { font-size: 24px; margin: 0; color: #1e293b; }
        .mp-welcome p { color: #64748b; margin: 5px 0 0; }
        
        /* ëŒ€ì‹œë³´ë“œ ì¹´ë“œ */
        .stat-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 40px; }
        .stat-card { background: white; padding: 25px; border-radius: 16px; border: 1px solid #e2e8f0; display: flex; align-items: center; gap: 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .stat-icon { width: 50px; height: 50px; border-radius: 12px; background: #eff6ff; color: #6366f1; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .stat-info strong { font-size: 28px; color: #1e293b; display: block; }
        .stat-info span { font-size: 14px; color: #64748b; }

        /* ì„¹ì…˜ ì»¨í…Œì´ë„ˆ */
        .mp-section { background: white; border-radius: 16px; border: 1px solid #e2e8f0; padding: 25px; margin-bottom: 30px; display: none; }
        .mp-section.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* í…Œì´ë¸” */
        .mp-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .mp-table th { text-align: left; padding: 15px; background: #f8fafc; color: #64748b; font-size: 13px; border-bottom: 1px solid #e2e8f0; }
        .mp-table td { padding: 15px; border-bottom: 1px solid #f1f5f9; color: #334155; font-size: 14px; }
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .status-done { background: #dcfce7; color: #15803d; }
        .status-wait { background: #fef9c3; color: #a16207; }
        .status-cancel { background: #fee2e2; color: #b91c1c; }

        .btn-cancel-order { padding: 5px 10px; background: white; border: 1px solid #ef4444; color: #ef4444; border-radius: 6px; cursor: pointer; font-size: 12px; }
        .btn-cancel-order:hover { background: #ef4444; color: white; }
    </style>
</head>
<body class="mypage-body">

    <nav class="mp-sidebar">
        <div class="mp-logo" onclick="location.href='index.html'"><i class="fa-solid fa-palette"></i> Chameleon</div>
        
        <div class="mp-nav-item active" onclick="switchTab('dashboard')">
            <i class="fa-solid fa-chart-pie" style="width:20px;"></i> ëŒ€ì‹œë³´ë“œ
        </div>
        <div class="mp-nav-item" onclick="switchTab('designs')">
            <i class="fa-solid fa-layer-group" style="width:20px;"></i> ë‚´ ë””ìì¸
        </div>
        <div class="mp-nav-item" onclick="switchTab('orders')">
            <i class="fa-solid fa-receipt" style="width:20px;"></i> ì£¼ë¬¸ ë‚´ì—­
        </div>
        <div class="mp-nav-item" onclick="switchTab('profit')">
            <i class="fa-solid fa-sack-dollar" style="width:20px;"></i> ìˆ˜ìµ & ë§ˆì¼ë¦¬ì§€
        </div>
        
        <div style="margin-top: auto;">
            <div class="mp-nav-item" style="color:#ef4444;" onclick="logout()">
                <i class="fa-solid fa-right-from-bracket" style="width:20px;"></i> ë¡œê·¸ì•„ì›ƒ
            </div>
        </div>
    </nav>

    <main class="mp-main">
        <div class="mp-header">
            <div class="mp-welcome">
                <h1 id="userNameDisplay">í™˜ì˜í•©ë‹ˆë‹¤!</h1>
                <p>ì˜¤ëŠ˜ë„ ë©‹ì§„ ë””ìì¸ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”.</p>
            </div>
            <button onclick="location.href='index.html'" class="btn-round primary" style="width:auto; padding:10px 20px;">
                <i class="fa-solid fa-pen-nib"></i> ì—ë””í„°ë¡œ ëŒì•„ê°€ê¸°
            </button>
        </div>

        <div id="tab-dashboard" class="mp-section active">
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fa-solid fa-won-sign"></i></div>
                    <div class="stat-info">
                        <span id="mileageDisplay">0 P</span>
                        <span>ë³´ìœ  ë§ˆì¼ë¦¬ì§€</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background:#f0fdf4; color:#16a34a;"><i class="fa-solid fa-box-open"></i></div>
                    <div class="stat-info">
                        <span id="activeOrderCount">0 ê±´</span>
                        <span>ì§„í–‰ì¤‘ì¸ ì£¼ë¬¸</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background:#fff7ed; color:#ea580c;"><i class="fa-solid fa-image"></i></div>
                    <div class="stat-info">
                        <span id="designCount">0 ê°œ</span>
                        <span>ë‚´ ë””ìì¸</span>
                    </div>
                </div>
            </div>
            
            <h3>ğŸ“¢ ìµœê·¼ ìˆ˜ìµ ì•Œë¦¼</h3>
            <ul id="recentLogs" style="list-style:none; padding:0; margin-top:15px; color:#475569;">
                <li>ë¡œë”© ì¤‘...</li>
            </ul>
        </div>

        <div id="tab-designs" class="mp-section">
            <h3>ğŸ“‚ ì €ì¥ëœ ë””ìì¸</h3>
            <div id="designGrid" class="mp-grid"></div>
        </div>

        <div id="tab-orders" class="mp-section">
            <h3>ğŸ“¦ ì£¼ë¬¸ / ë°°ì†¡ ì¡°íšŒ</h3>
            <table class="mp-table">
                <thead>
                    <tr>
                        <th>ì£¼ë¬¸ì¼</th>
                        <th>ìƒí’ˆëª…</th>
                        <th>ê²°ì œê¸ˆì•¡</th>
                        <th>ìƒíƒœ</th>
                        <th>ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody id="orderListBody"></tbody>
            </table>
        </div>

        <div id="tab-profit" class="mp-section">
            <div style="background:#1e293b; color:white; padding:30px; border-radius:12px; margin-bottom:30px;">
                <h2 style="margin:0 0 10px 0;">ğŸ’° ë‚˜ì˜ ìˆ˜ìµ ë¦¬í¬íŠ¸</h2>
                <p style="opacity:0.8; font-size:14px;">
                    ë‚´ê°€ ê³µìœ í•œ ë¡œê³ /ì´ë¯¸ì§€ë¥¼ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ì‚¬ìš©í•˜ë©´ ìˆ˜ìµì´ ë°œìƒí•©ë‹ˆë‹¤.<br>
                    (ì¼ë°˜ ì´ë¯¸ì§€ 0.1%, ë¡œê³ /SVG 0.2%)
                </p>
                <div style="margin-top:20px; font-size:32px; font-weight:800; color:#fbbf24;">
                    <span id="profitTotal">0</span> P
                </div>
            </div>
            
            <h4>ë§ˆì¼ë¦¬ì§€ ì ë¦½/ì‚¬ìš© ë‚´ì—­</h4>
            <table class="mp-table">
                <thead><tr><th>ì¼ì‹œ</th><th>ë‚´ìš©</th><th>êµ¬ë¶„</th><th style="text-align:right;">í¬ì¸íŠ¸</th></tr></thead>
                <tbody id="mileageListBody"></tbody>
            </table>
        </div>

    </main>

    <script type="module" src="./mypage.js"></script>
</body>
</html>